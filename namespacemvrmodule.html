<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MODFLOW 6: mvrmodule Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="mf6-triangular-grid.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MODFLOW 6
   &#160;<span id="projectnumber">version 6.5.0</span>
   </div>
   <div id="projectbrief">MODFLOW 6 Code Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="namespaces.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="namespaces.html"><span>Modules&#160;List</span></a></li>
      <li><a href="namespacemembers.html"><span>Module&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('namespacemvrmodule.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Types</a> &#124;
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">mvrmodule Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This module contains the MvrModule Module.  
<a href="namespacemvrmodule.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Types</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">type &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmvrmodule_1_1mvrtype.html">mvrtype</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Derived type for MvrType.  <a href="structmvrmodule_1_1mvrtype.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:aa790d6c6de47b6f33291c324b9e82687"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemvrmodule.html#aa790d6c6de47b6f33291c324b9e82687">set_values</a> (this, mname1, pname1, id1, mname2, pname2, id2, imvrtype, value)</td></tr>
<tr class="memdesc:aa790d6c6de47b6f33291c324b9e82687"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Set values from input data  <a href="namespacemvrmodule.html#aa790d6c6de47b6f33291c324b9e82687">More...</a><br /></td></tr>
<tr class="separator:aa790d6c6de47b6f33291c324b9e82687"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20814611a67e3770bad38acfba59a752"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemvrmodule.html#a20814611a67e3770bad38acfba59a752">prepare</a> (this, inunit, pckMemPaths, pakmovers)</td></tr>
<tr class="memdesc:a20814611a67e3770bad38acfba59a752"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Prepare object  <a href="namespacemvrmodule.html#a20814611a67e3770bad38acfba59a752">More...</a><br /></td></tr>
<tr class="separator:a20814611a67e3770bad38acfba59a752"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a426ef2aa07ccbe5827e203206038533d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemvrmodule.html#a426ef2aa07ccbe5827e203206038533d">echo</a> (this, iout)</td></tr>
<tr class="memdesc:a426ef2aa07ccbe5827e203206038533d"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Echo data to list file  <a href="namespacemvrmodule.html#a426ef2aa07ccbe5827e203206038533d">More...</a><br /></td></tr>
<tr class="separator:a426ef2aa07ccbe5827e203206038533d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af49bd4432292e3759feefa1f8513651c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemvrmodule.html#af49bd4432292e3759feefa1f8513651c">advance</a> (this)</td></tr>
<tr class="memdesc:af49bd4432292e3759feefa1f8513651c"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Advance  <a href="namespacemvrmodule.html#af49bd4432292e3759feefa1f8513651c">More...</a><br /></td></tr>
<tr class="separator:af49bd4432292e3759feefa1f8513651c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2bc1940f8217a9538fbb2a4fdb9e1a06"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemvrmodule.html#a2bc1940f8217a9538fbb2a4fdb9e1a06">fc</a> (this)</td></tr>
<tr class="memdesc:a2bc1940f8217a9538fbb2a4fdb9e1a06"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Formulate coefficients  <a href="namespacemvrmodule.html#a2bc1940f8217a9538fbb2a4fdb9e1a06">More...</a><br /></td></tr>
<tr class="separator:a2bc1940f8217a9538fbb2a4fdb9e1a06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fbe21fd17a5effc2ce8bbe956d17181"><td class="memItemLeft" align="right" valign="top">real(dp) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemvrmodule.html#a9fbe21fd17a5effc2ce8bbe956d17181">qrcalc</a> (this, qa, qta)</td></tr>
<tr class="memdesc:a9fbe21fd17a5effc2ce8bbe956d17181"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Flow to receiver  <a href="namespacemvrmodule.html#a9fbe21fd17a5effc2ce8bbe956d17181">More...</a><br /></td></tr>
<tr class="separator:a9fbe21fd17a5effc2ce8bbe956d17181"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac59e995be1c24bddec329b89a4a01d1d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemvrmodule.html#ac59e995be1c24bddec329b89a4a01d1d">writeflow</a> (this, iout)</td></tr>
<tr class="memdesc:ac59e995be1c24bddec329b89a4a01d1d"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Write flow  <a href="namespacemvrmodule.html#ac59e995be1c24bddec329b89a4a01d1d">More...</a><br /></td></tr>
<tr class="separator:ac59e995be1c24bddec329b89a4a01d1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a6f269e0d93c5e59d2593fd554b8fa7aa"><td class="memItemLeft" align="right" valign="top">character(len=12), dimension(4)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemvrmodule.html#a6f269e0d93c5e59d2593fd554b8fa7aa">mvrtypes</a> = [character(len=12) :: 'FACTOR', 'EXCESS', 'THRESHOLD', 'UPTO']</td></tr>
<tr class="separator:a6f269e0d93c5e59d2593fd554b8fa7aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This module contains the code for the low-level MvrType object. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="af49bd4432292e3759feefa1f8513651c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af49bd4432292e3759feefa1f8513651c">&#9670;&nbsp;</a></span>advance()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mvrmodule::advance </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structmvrmodule_1_1mvrtype.html">mvrtype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Advance mover object. Does nothing now. </p>

<p class="definition">Definition at line <a class="el" href="_mover_8f90_source.html#l00206">206</a> of file <a class="el" href="_mover_8f90_source.html">Mover.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="keywordtype">class</span>(MvrType) :: this</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a426ef2aa07ccbe5827e203206038533d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a426ef2aa07ccbe5827e203206038533d">&#9670;&nbsp;</a></span>echo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mvrmodule::echo </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structmvrmodule_1_1mvrtype.html">mvrtype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>iout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Write mover values to output file. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>MvrType </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iout</td><td>unit number for output file </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_mover_8f90_source.html#l00183">183</a> of file <a class="el" href="_mover_8f90_source.html">Mover.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="keywordtype">class</span>(MvrType) :: this<span class="comment"> !&lt; MvrType</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: iout<span class="comment"> !&lt; unit number for output file</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keyword">write</span> (iout, <span class="stringliteral">&#39;(4x, a, a, a, i0)&#39;</span>) <span class="stringliteral">&#39;FROM PACKAGE: &#39;</span>, trim(this%pckNameSrc), &amp;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      <span class="stringliteral">&#39; FROM ID: &#39;</span>, this%iRchNrSrc</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keyword">write</span> (iout, <span class="stringliteral">&#39;(4x, a, a, a, i0)&#39;</span>) <span class="stringliteral">&#39;TO PACKAGE: &#39;</span>, trim(this%pckNameTgt), &amp;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      <span class="stringliteral">&#39; TO ID: &#39;</span>, this%iRchNrTgt</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keyword">write</span> (iout, <span class="stringliteral">&#39;(4x, a, a, a, 1pg15.6,/)&#39;</span>) <span class="stringliteral">&#39;MOVER TYPE: &#39;</span>, &amp;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      trim(mvrtypes(this%imvrtype)), <span class="stringliteral">&#39; &#39;</span>, this%value</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2bc1940f8217a9538fbb2a4fdb9e1a06"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2bc1940f8217a9538fbb2a4fdb9e1a06">&#9670;&nbsp;</a></span>fc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mvrmodule::fc </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structmvrmodule_1_1mvrtype.html">mvrtype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Make mover calculations. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>MvrType </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_mover_8f90_source.html#l00221">221</a> of file <a class="el" href="_mover_8f90_source.html">Mover.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keywordtype">class</span>(MvrType) :: this<span class="comment"> !&lt; MvrType</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="keywordtype">    real</span>(DP) :: qavailable, qtanew, qpactual</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="comment">! -- Set qa and this%qavailable equal to available water in package (qtomvr)</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    qavailable = this%qformvr_ptr</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    qtanew = this%qtformvr_ptr</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    this%qavailable = qavailable</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="comment">! -- Using the mover rules, calculate how much of the available water will</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="comment">!    be provided from the mover to the receiver.</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    qpactual = this%qrcalc(qavailable, qtanew)</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="comment">! -- Store qpactual</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    this%qpactual = qpactual</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="comment">! -- Add the calculated qpactual term directly into the receiver package</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="comment">!    qfrommvr array.</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    this%qfrommvr_ptr = this%qfrommvr_ptr + qpactual</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="comment">! -- Add the calculated qpactual term directly into the provider package</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="comment">!    qtomvr array.</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    this%qtomvr_ptr = this%qtomvr_ptr + qpactual</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="comment">! -- Reduce the amount of water that is available in the provider package</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="comment">!    qformvr array.</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    this%qformvr_ptr = this%qformvr_ptr - qpactual</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a20814611a67e3770bad38acfba59a752"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20814611a67e3770bad38acfba59a752">&#9670;&nbsp;</a></span>prepare()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mvrmodule::prepare </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structmvrmodule_1_1mvrtype.html">mvrtype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>inunit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=lenmempath), dimension(:), pointer, contiguous&#160;</td>
          <td class="paramname"><em>pckMemPaths</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structpackagemovermodule_1_1packagemovertype.html">packagemovertype</a>), dimension(:), pointer, contiguous&#160;</td>
          <td class="paramname"><em>pakmovers</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set values and pointers for mover object. pckMemPaths is an array of strings which are the memory paths for those packages. They are composed of model names and package names. The mover entries must be in pckMemPaths, or this routine will terminate with an error. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>MvrType objec </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">inunit</td><td>input file unit number </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">pckmempaths</td><td>array of strings </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">pakmovers</td><td>Array of package mover objects </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_mover_8f90_source.html#l00089">89</a> of file <a class="el" href="_mover_8f90_source.html">Mover.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacesimmodule.html">simmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>, <a class="code" href="namespacesimmodule.html#a83910ed20af1fec9bdf46cad8c276538">store_error_unit</a>, <a class="code" href="namespacesimmodule.html#a4c46e49de78d4498dd4ec106357775e6">count_errors</a></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordtype">class</span>(MvrType) :: this<span class="comment"> !&lt; MvrType objec</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: inunit<span class="comment"> !&lt; input file unit number</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keywordtype">character(len=LENMEMPATH)</span>, &amp;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">pointer</span>, <span class="keywordtype">contiguous</span> :: pckMemPaths<span class="comment"> !&lt; array of strings</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keywordtype">type</span>(PackageMoverType), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">pointer</span>, <span class="keywordtype">contiguous</span> :: pakmovers<span class="comment"> !&lt; Array of package mover objects</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">pointer</span>, <span class="keywordtype">contiguous</span> :: temp_ptr =&gt; null()</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="keywordtype">logical</span> :: found</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: i</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ipakloc1, ipakloc2</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="comment">! -- Check to make sure provider and receiver are not the same</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keywordflow">if</span> (this%pckNameSrc == this%pckNameTgt .and. &amp;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        this%iRchNrSrc == this%iRchNrTgt) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(<span class="stringliteral">&#39;PROVIDER AND RECEIVER ARE THE SAME: &#39;</span>// &amp;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                       trim(this%pckNameSrc)//<span class="stringliteral">&#39; : &#39;</span>//trim(this%pckNameTgt))</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a83910ed20af1fec9bdf46cad8c276538">store_error_unit</a>(inunit)</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="comment">! -- Check to make sure pname1 and pname2 are both listed in pckMemPaths</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="comment">!    pname1 is the provider package; pname2 is the receiver package</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    found = .false.</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    ipakloc1 = 0</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordflow">do</span> i = 1, <span class="keyword">size</span>(pckmempaths)</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      <span class="keywordflow">if</span> (this%pckNameSrc == pckmempaths(i)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        found = .true.</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        ipakloc1 = i</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <span class="keywordflow">exit</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="keywordflow">if</span> (.not. found) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(<span class="stringliteral">&#39;MOVER CAPABILITY NOT ACTIVATED IN &#39;</span>//this%pckNameSrc)</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(<span class="stringliteral">&#39;ADD &quot;MOVER&quot; KEYWORD TO PACKAGE OPTIONS BLOCK.&#39;</span>)</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    found = .false.</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    ipakloc2 = 0</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keywordflow">do</span> i = 1, <span class="keyword">size</span>(pckmempaths)</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      <span class="keywordflow">if</span> (this%pckNameTgt == pckmempaths(i)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        found = .true.</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        ipakloc2 = i</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <span class="keywordflow">exit</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keywordflow">if</span> (.not. found) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(<span class="stringliteral">&#39;MOVER CAPABILITY NOT ACTIVATED IN &#39;</span>//this%pckNameTgt)</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(<span class="stringliteral">&#39;ADD &quot;MOVER&quot; KEYWORD TO PACKAGE OPTIONS BLOCK.&#39;</span>)</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacesimmodule.html#a4c46e49de78d4498dd4ec106357775e6">count_errors</a>() &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a83910ed20af1fec9bdf46cad8c276538">store_error_unit</a>(inunit)</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="comment">! -- Set pointer to QTOMVR array in the provider boundary package</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    temp_ptr =&gt; pakmovers(ipakloc1)%qtomvr</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordflow">if</span> (this%iRchNrSrc &lt; 1 .or. this%iRchNrSrc &gt; <span class="keyword">size</span>(temp_ptr)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(<span class="stringliteral">&#39;PROVIDER ID &lt; 1 OR GREATER THAN PACKAGE SIZE &#39;</span>)</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      <span class="keyword">write</span> (errmsg, <span class="stringliteral">&#39;(4x,a,i0,a,i0)&#39;</span>) <span class="stringliteral">&#39;PROVIDER ID = &#39;</span>, this%iRchNrSrc, &amp;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <span class="stringliteral">&#39;; PACKAGE SIZE = &#39;</span>, <span class="keyword">size</span>(temp_ptr)</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(trim(errmsg))</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a83910ed20af1fec9bdf46cad8c276538">store_error_unit</a>(inunit)</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    this%qtomvr_ptr =&gt; temp_ptr(this%iRchNrSrc)</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="comment">! -- Set pointer to QFORMVR array in the provider boundary package</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    temp_ptr =&gt; pakmovers(ipakloc1)%qformvr</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    this%qformvr_ptr =&gt; temp_ptr(this%iRchNrSrc)</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="comment">! -- Set pointer to QTFORMVR array in the provider boundary package</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    temp_ptr =&gt; pakmovers(ipakloc1)%qtformvr</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    this%qtformvr_ptr =&gt; temp_ptr(this%iRchNrSrc)</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="comment">! -- Set pointer to QFROMMVR array in the receiver boundary package</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    temp_ptr =&gt; pakmovers(ipakloc2)%qfrommvr</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="keywordflow">if</span> (this%iRchNrTgt &lt; 1 .or. this%iRchNrTgt &gt; <span class="keyword">size</span>(temp_ptr)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(<span class="stringliteral">&#39;RECEIVER ID &lt; 1 OR GREATER THAN PACKAGE SIZE &#39;</span>)</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      <span class="keyword">write</span> (errmsg, <span class="stringliteral">&#39;(4x,a,i0,a,i0)&#39;</span>) <span class="stringliteral">&#39;RECEIVER ID = &#39;</span>, this%iRchNrTgt, &amp;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <span class="stringliteral">&#39;; PACKAGE SIZE = &#39;</span>, <span class="keyword">size</span>(temp_ptr)</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(trim(errmsg))</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a83910ed20af1fec9bdf46cad8c276538">store_error_unit</a>(inunit)</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    this%qfrommvr_ptr =&gt; temp_ptr(this%iRchNrTgt)</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keywordflow">return</span></div>
<div class="ttc" id="anamespacesimmodule_html"><div class="ttname"><a href="namespacesimmodule.html">simmodule</a></div><div class="ttdoc">This module contains simulation methods.</div><div class="ttdef"><b>Definition:</b> <a href="_sim_8f90_source.html#l00010">Sim.f90:10</a></div></div>
<div class="ttc" id="anamespacesimmodule_html_a21870712a1166225fdcd5b60bffb353e"><div class="ttname"><a href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">simmodule::store_error</a></div><div class="ttdeci">subroutine, public store_error(msg, terminate)</div><div class="ttdoc">Store error message.</div><div class="ttdef"><b>Definition:</b> <a href="_sim_8f90_source.html#l00128">Sim.f90:129</a></div></div>
<div class="ttc" id="anamespacesimmodule_html_a4c46e49de78d4498dd4ec106357775e6"><div class="ttname"><a href="namespacesimmodule.html#a4c46e49de78d4498dd4ec106357775e6">simmodule::count_errors</a></div><div class="ttdeci">integer(i4b) function, public count_errors()</div><div class="ttdoc">Return number of errors.</div><div class="ttdef"><b>Definition:</b> <a href="_sim_8f90_source.html#l00058">Sim.f90:59</a></div></div>
<div class="ttc" id="anamespacesimmodule_html_a83910ed20af1fec9bdf46cad8c276538"><div class="ttname"><a href="namespacesimmodule.html#a83910ed20af1fec9bdf46cad8c276538">simmodule::store_error_unit</a></div><div class="ttdeci">subroutine, public store_error_unit(iunit, terminate)</div><div class="ttdoc">Store the file unit number.</div><div class="ttdef"><b>Definition:</b> <a href="_sim_8f90_source.html#l00208">Sim.f90:209</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemvrmodule_a20814611a67e3770bad38acfba59a752_cgraph.png" border="0" usemap="#anamespacemvrmodule_a20814611a67e3770bad38acfba59a752_cgraph" alt=""/></div>
<map name="anamespacemvrmodule_a20814611a67e3770bad38acfba59a752_cgraph" id="anamespacemvrmodule_a20814611a67e3770bad38acfba59a752_cgraph">
<area shape="rect" title="@ brief Prepare object" alt="" coords="5,56,160,83"/>
<area shape="rect" href="namespacesimmodule.html#a4c46e49de78d4498dd4ec106357775e6" title="Return number of errors." alt="" coords="219,5,403,32"/>
<area shape="rect" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e" title="Store error message." alt="" coords="224,56,399,83"/>
<area shape="rect" href="namespacesimmodule.html#a83910ed20af1fec9bdf46cad8c276538" title="Store the file unit number." alt="" coords="208,107,415,133"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="463,81,601,108"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="649,41,817,82"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title="Subroutine to stop the program." alt="" coords="649,106,817,147"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="865,19,1060,45"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title="Write simulation message." alt="" coords="879,70,1047,111"/>
</map>
</div>

</div>
</div>
<a id="a9fbe21fd17a5effc2ce8bbe956d17181"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9fbe21fd17a5effc2ce8bbe956d17181">&#9670;&nbsp;</a></span>qrcalc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(dp) function mvrmodule::qrcalc </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structmvrmodule_1_1mvrtype.html">mvrtype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>qa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>qta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Calculate the rate of water provided to receiver. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>MvrType </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">qa</td><td>actual flow </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">qta</td><td>total available flow </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_mover_8f90_source.html#l00261">261</a> of file <a class="el" href="_mover_8f90_source.html">Mover.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="keywordtype">    real</span>(DP) :: qr</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="keywordtype">class</span>(MvrType) :: this<span class="comment"> !&lt; MvrType</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: qa<span class="comment"> !&lt; actual flow</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: qta<span class="comment"> !&lt; total available flow</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="comment">! -- Using the mover rules, calculate how much of the available water will</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="comment">!    go to the receiver.</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    qr = dzero</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="comment">! -- Calculate qr</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="keywordflow">select case</span> (this%imvrtype)</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="keywordflow">case</span> (1)</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      <span class="comment">! -- FACTOR uses total available to make calculation, and then</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      <span class="comment">!    limits qr by consumed available</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      <span class="keywordflow">if</span> (qta &gt; dzero) qr = qta * this%value</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      qr = min(qr, qa)</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="keywordflow">case</span> (2)</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      <span class="comment">! -- EXCESS</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      <span class="keywordflow">if</span> (qa &gt; this%value) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        qr = qa - this%value</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        qr = dzero</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keywordflow">case</span> (3)</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;      <span class="comment">! -- THRESHOLD</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      <span class="keywordflow">if</span> (this%value &gt; qa) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        qr = dzero</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        qr = this%value</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="keywordflow">case</span> (4)</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      <span class="comment">! -- UPTO</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      <span class="keywordflow">if</span> (qa &gt; this%value) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        qr = this%value</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        qr = qa</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="keywordflow">    end select</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa790d6c6de47b6f33291c324b9e82687"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa790d6c6de47b6f33291c324b9e82687">&#9670;&nbsp;</a></span>set_values()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mvrmodule::set_values </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structmvrmodule_1_1mvrtype.html">mvrtype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>mname1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>pname1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in), target&#160;</td>
          <td class="paramname"><em>id1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>mname2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>pname2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in), target&#160;</td>
          <td class="paramname"><em>id2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in), target&#160;</td>
          <td class="paramname"><em>imvrtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in), target&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Set values and pointers for mover object. </p>

<p class="definition">Definition at line <a class="el" href="_mover_8f90_source.html#l00059">59</a> of file <a class="el" href="_mover_8f90_source.html">Mover.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacememoryhelpermodule.html">memoryhelpermodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacememoryhelpermodule.html#abe77d18fe02d108d80f414f9fafa592d">create_mem_path</a></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keywordtype">class</span>(MvrType) :: this</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: mname1</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: pname1</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">target</span> :: id1</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: mname2</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: pname2</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">target</span> :: id2</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">target</span> :: imvrtype</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">target</span> :: value</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    this%pckNameSrc = <a class="code" href="namespacememoryhelpermodule.html#abe77d18fe02d108d80f414f9fafa592d">create_mem_path</a>(mname1, pname1)</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    this%iRchNrSrc =&gt; id1</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    this%pckNameTgt = <a class="code" href="namespacememoryhelpermodule.html#abe77d18fe02d108d80f414f9fafa592d">create_mem_path</a>(mname2, pname2)</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    this%iRchNrTgt =&gt; id2</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    this%imvrtype =&gt; imvrtype</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    this%value =&gt; <span class="keywordtype">value</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keywordflow">return</span></div>
<div class="ttc" id="anamespacememoryhelpermodule_html"><div class="ttname"><a href="namespacememoryhelpermodule.html">memoryhelpermodule</a></div><div class="ttdef"><b>Definition:</b> <a href="_memory_helper_8f90_source.html#l00001">MemoryHelper.f90:1</a></div></div>
<div class="ttc" id="anamespacememoryhelpermodule_html_abe77d18fe02d108d80f414f9fafa592d"><div class="ttname"><a href="namespacememoryhelpermodule.html#abe77d18fe02d108d80f414f9fafa592d">memoryhelpermodule::create_mem_path</a></div><div class="ttdeci">character(len=lenmempath) function create_mem_path(component, subcomponent, context)</div><div class="ttdoc">returns the path to the memory object</div><div class="ttdef"><b>Definition:</b> <a href="_memory_helper_8f90_source.html#l00021">MemoryHelper.f90:22</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemvrmodule_aa790d6c6de47b6f33291c324b9e82687_cgraph.png" border="0" usemap="#anamespacemvrmodule_aa790d6c6de47b6f33291c324b9e82687_cgraph" alt=""/></div>
<map name="anamespacemvrmodule_aa790d6c6de47b6f33291c324b9e82687_cgraph" id="anamespacemvrmodule_aa790d6c6de47b6f33291c324b9e82687_cgraph">
<area shape="rect" title="@ brief Set values from input data" alt="" coords="5,68,180,95"/>
<area shape="rect" href="namespacememoryhelpermodule.html#abe77d18fe02d108d80f414f9fafa592d" title="returns the path to the memory object" alt="" coords="228,61,395,102"/>
<area shape="rect" href="namespacememoryhelpermodule.html#a5405f58247a0962e5449ebc1e4dcff0f" title="Generic routine to check the length of (parts of) the memory address." alt="" coords="443,61,609,102"/>
<area shape="rect" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e" title="Store error message." alt="" coords="657,68,832,95"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="880,68,1019,95"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="1067,27,1235,69"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title="Subroutine to stop the program." alt="" coords="1067,93,1235,134"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="1283,5,1477,32"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title="Write simulation message." alt="" coords="1296,57,1464,98"/>
</map>
</div>

</div>
</div>
<a id="ac59e995be1c24bddec329b89a4a01d1d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac59e995be1c24bddec329b89a4a01d1d">&#9670;&nbsp;</a></span>writeflow()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mvrmodule::writeflow </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structmvrmodule_1_1mvrtype.html">mvrtype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>iout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Write a line of output for this mover object. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>MvrType </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iout</td><td>output file unit number </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_mover_8f90_source.html#l00312">312</a> of file <a class="el" href="_mover_8f90_source.html">Mover.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="keywordtype">class</span>(MvrType) :: this<span class="comment"> !&lt; MvrType</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: iout<span class="comment"> !&lt; output file unit number</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">parameter</span> :: fmt = &amp;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      <span class="stringliteral">&quot;(1x, a, &#39; ID &#39;, i0, &#39; AVAILABLE &#39;, 1(1pg15.6), &amp;</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="stringliteral"></span><span class="stringliteral">      &amp;&#39; PROVIDED &#39;, 1(1pg15.6), &#39; TO &#39;, a, &#39; ID &#39;, i0)&quot;</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="keyword">write</span> (iout, fmt) trim(this%pckNameSrc), this%iRchNrSrc, this%qavailable, &amp;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      this%qpactual, trim(this%pckNameTgt), this%iRchNrTgt</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a6f269e0d93c5e59d2593fd554b8fa7aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f269e0d93c5e59d2593fd554b8fa7aa">&#9670;&nbsp;</a></span>mvrtypes</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">character(len=12), dimension(4) mvrmodule::mvrtypes = [character(len=12) :: 'FACTOR', 'EXCESS', 'THRESHOLD', 'UPTO']</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_mover_8f90_source.html#l00020">20</a> of file <a class="el" href="_mover_8f90_source.html">Mover.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;  <span class="keywordtype">character(len=12)</span>, <span class="keywordtype">dimension(4)</span> :: mvrtypes = &amp;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    &amp;[character(len=12) :: <span class="stringliteral">&#39;FACTOR&#39;</span>, <span class="stringliteral">&#39;EXCESS&#39;</span>, <span class="stringliteral">&#39;THRESHOLD&#39;</span>, <span class="stringliteral">&#39;UPTO&#39;</span>]</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacemvrmodule.html">mvrmodule</a></li>
    <li class="footer">Generated on Mon Dec 19 2022 20:08:38 for MODFLOW 6 by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
