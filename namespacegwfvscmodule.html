<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MODFLOW 6: gwfvscmodule Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="mf6-triangular-grid.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MODFLOW 6
   &#160;<span id="projectnumber">version 6.5.0</span>
   </div>
   <div id="projectbrief">MODFLOW 6 Code Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="namespaces.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="namespaces.html"><span>Modules&#160;List</span></a></li>
      <li><a href="namespacemembers.html"><span>Module&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('namespacegwfvscmodule.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Types</a> &#124;
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">gwfvscmodule Module Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Types</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">type &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structgwfvscmodule_1_1concentrationpointer.html">concentrationpointer</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">type &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structgwfvscmodule_1_1gwfvsctype.html">gwfvsctype</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:af8db7009f19b86ca75174726d2358001"><td class="memItemLeft" align="right" valign="top">real(dp) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfvscmodule.html#af8db7009f19b86ca75174726d2358001">calc_visc</a> (ivisc, viscref, dviscdc, cviscref, conc, a2, a3, a4)</td></tr>
<tr class="separator:af8db7009f19b86ca75174726d2358001"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49dbcbea3bf6fa2bf163418f83c24558"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfvscmodule.html#a49dbcbea3bf6fa2bf163418f83c24558">vsc_cr</a> (vscobj, name_model, inunit, iout)</td></tr>
<tr class="memdesc:a49dbcbea3bf6fa2bf163418f83c24558"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Create a new package object  <a href="namespacegwfvscmodule.html#a49dbcbea3bf6fa2bf163418f83c24558">More...</a><br /></td></tr>
<tr class="separator:a49dbcbea3bf6fa2bf163418f83c24558"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ff1e8f540d4e8cc11373a2b9019bc4b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfvscmodule.html#a9ff1e8f540d4e8cc11373a2b9019bc4b">vsc_df</a> (this, dis, vsc_input)</td></tr>
<tr class="memdesc:a9ff1e8f540d4e8cc11373a2b9019bc4b"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Define viscosity package options and dimensions  <a href="namespacegwfvscmodule.html#a9ff1e8f540d4e8cc11373a2b9019bc4b">More...</a><br /></td></tr>
<tr class="separator:a9ff1e8f540d4e8cc11373a2b9019bc4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aacf466247c12fc23a1e504b7242ecf81"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfvscmodule.html#aacf466247c12fc23a1e504b7242ecf81">vsc_ar</a> (this, ibound)</td></tr>
<tr class="memdesc:aacf466247c12fc23a1e504b7242ecf81"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Allocate and read method for viscosity package  <a href="namespacegwfvscmodule.html#aacf466247c12fc23a1e504b7242ecf81">More...</a><br /></td></tr>
<tr class="separator:aacf466247c12fc23a1e504b7242ecf81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a701ebbb47ddf624dfff88d0a85dfa651"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfvscmodule.html#a701ebbb47ddf624dfff88d0a85dfa651">vsc_ar_bnd</a> (this, packobj)</td></tr>
<tr class="memdesc:a701ebbb47ddf624dfff88d0a85dfa651"><td class="mdescLeft">&#160;</td><td class="mdescRight">Activate viscosity in advanced packages.  <a href="namespacegwfvscmodule.html#a701ebbb47ddf624dfff88d0a85dfa651">More...</a><br /></td></tr>
<tr class="separator:a701ebbb47ddf624dfff88d0a85dfa651"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeeb4cb22f5cd30e78cd6255cca088b00"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfvscmodule.html#aeeb4cb22f5cd30e78cd6255cca088b00">set_npf_pointers</a> (this)</td></tr>
<tr class="memdesc:aeeb4cb22f5cd30e78cd6255cca088b00"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set pointers to NPF variables.  <a href="namespacegwfvscmodule.html#aeeb4cb22f5cd30e78cd6255cca088b00">More...</a><br /></td></tr>
<tr class="separator:aeeb4cb22f5cd30e78cd6255cca088b00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb2789ca0ad59b20766ce18635360c6c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfvscmodule.html#abb2789ca0ad59b20766ce18635360c6c">vsc_rp</a> (this)</td></tr>
<tr class="memdesc:abb2789ca0ad59b20766ce18635360c6c"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Read new period data in viscosity package  <a href="namespacegwfvscmodule.html#abb2789ca0ad59b20766ce18635360c6c">More...</a><br /></td></tr>
<tr class="separator:abb2789ca0ad59b20766ce18635360c6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54a002f87a7fb6c4e3d6040d957081a2"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfvscmodule.html#a54a002f87a7fb6c4e3d6040d957081a2">vsc_ad</a> (this)</td></tr>
<tr class="memdesc:a54a002f87a7fb6c4e3d6040d957081a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Advance the viscosity package  <a href="namespacegwfvscmodule.html#a54a002f87a7fb6c4e3d6040d957081a2">More...</a><br /></td></tr>
<tr class="separator:a54a002f87a7fb6c4e3d6040d957081a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac936522aab940bab0a3a777937950905"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfvscmodule.html#ac936522aab940bab0a3a777937950905">vsc_ad_bnd</a> (this, packobj, hnew)</td></tr>
<tr class="memdesc:ac936522aab940bab0a3a777937950905"><td class="mdescLeft">&#160;</td><td class="mdescRight">Advance the boundary packages when viscosity is active.  <a href="namespacegwfvscmodule.html#ac936522aab940bab0a3a777937950905">More...</a><br /></td></tr>
<tr class="separator:ac936522aab940bab0a3a777937950905"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e5f71e404ad7000d2873ea98ccccedc"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfvscmodule.html#a3e5f71e404ad7000d2873ea98ccccedc">vsc_ad_standard_bnd</a> (packobj, hnew, visc, viscref, locelev, locvisc, locconc, dviscdc, cviscref, ivisc, a2, a3, a4, ctemp)</td></tr>
<tr class="memdesc:a3e5f71e404ad7000d2873ea98ccccedc"><td class="mdescLeft">&#160;</td><td class="mdescRight">advance ghb while accounting for viscosity  <a href="namespacegwfvscmodule.html#a3e5f71e404ad7000d2873ea98ccccedc">More...</a><br /></td></tr>
<tr class="separator:a3e5f71e404ad7000d2873ea98ccccedc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7423dfe6d14b2ecc499adf4bd9ff259"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfvscmodule.html#aa7423dfe6d14b2ecc499adf4bd9ff259">vsc_ad_sfr</a> (packobj, visc, viscref, elev, locvisc, locconc, dviscdc, cviscref, ivisc, a2, a3, a4, ctemp)</td></tr>
<tr class="memdesc:aa7423dfe6d14b2ecc499adf4bd9ff259"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update sfr-related viscosity ratios.  <a href="namespacegwfvscmodule.html#aa7423dfe6d14b2ecc499adf4bd9ff259">More...</a><br /></td></tr>
<tr class="separator:aa7423dfe6d14b2ecc499adf4bd9ff259"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a476a324bbc28b0fe0f403acd75a323d8"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfvscmodule.html#a476a324bbc28b0fe0f403acd75a323d8">vsc_ad_lak</a> (packobj, visc, viscref, elev, locvisc, locconc, dviscdc, cviscref, ivisc, a2, a3, a4, ctemp)</td></tr>
<tr class="memdesc:a476a324bbc28b0fe0f403acd75a323d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update lak-related viscosity ratios.  <a href="namespacegwfvscmodule.html#a476a324bbc28b0fe0f403acd75a323d8">More...</a><br /></td></tr>
<tr class="separator:a476a324bbc28b0fe0f403acd75a323d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4070491a5fac8c9ef18a537d9bff7af"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfvscmodule.html#af4070491a5fac8c9ef18a537d9bff7af">vsc_ad_maw</a> (packobj, visc, viscref, elev, locvisc, locconc, dviscdc, cviscref, ivisc, a2, a3, a4, ctemp)</td></tr>
<tr class="memdesc:af4070491a5fac8c9ef18a537d9bff7af"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update maw-related viscosity ratios.  <a href="namespacegwfvscmodule.html#af4070491a5fac8c9ef18a537d9bff7af">More...</a><br /></td></tr>
<tr class="separator:af4070491a5fac8c9ef18a537d9bff7af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60546a198d138f74fb1224edcdbfeb10"><td class="memItemLeft" align="right" valign="top">real(dp) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfvscmodule.html#a60546a198d138f74fb1224edcdbfeb10">update_bnd_cond</a> (bndvisc, viscref, spcfdcond)</td></tr>
<tr class="memdesc:a60546a198d138f74fb1224edcdbfeb10"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply viscosity to the conductance term.  <a href="namespacegwfvscmodule.html#a60546a198d138f74fb1224edcdbfeb10">More...</a><br /></td></tr>
<tr class="separator:a60546a198d138f74fb1224edcdbfeb10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bfcfd4477ee17446430a763d198634b"><td class="memItemLeft" align="right" valign="top">real(dp) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfvscmodule.html#a4bfcfd4477ee17446430a763d198634b">calc_vsc_ratio</a> (viscref, bndvisc)</td></tr>
<tr class="memdesc:a4bfcfd4477ee17446430a763d198634b"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculate and return the viscosity ratio  <a href="namespacegwfvscmodule.html#a4bfcfd4477ee17446430a763d198634b">More...</a><br /></td></tr>
<tr class="separator:a4bfcfd4477ee17446430a763d198634b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e8b4072354d11b735667328a8417e98"><td class="memItemLeft" align="right" valign="top">real(dp) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfvscmodule.html#a5e8b4072354d11b735667328a8417e98">calc_bnd_viscosity</a> (n, locvisc, locconc, viscref, dviscdc, cviscref, ctemp, ivisc, a2, a3, a4, auxvar)</td></tr>
<tr class="memdesc:a5e8b4072354d11b735667328a8417e98"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Calculate the boundary viscosity  <a href="namespacegwfvscmodule.html#a5e8b4072354d11b735667328a8417e98">More...</a><br /></td></tr>
<tr class="separator:a5e8b4072354d11b735667328a8417e98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade94da49d74bd1a3a57c51fe6165a66a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfvscmodule.html#ade94da49d74bd1a3a57c51fe6165a66a">get_visc_ratio</a> (this, n, m, gwhdn, gwhdm, viscratio)</td></tr>
<tr class="memdesc:ade94da49d74bd1a3a57c51fe6165a66a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the viscosity ratio.  <a href="namespacegwfvscmodule.html#ade94da49d74bd1a3a57c51fe6165a66a">More...</a><br /></td></tr>
<tr class="separator:ade94da49d74bd1a3a57c51fe6165a66a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48756737f677d59dbbd74ddd89c85791"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfvscmodule.html#a48756737f677d59dbbd74ddd89c85791">calc_q_visc</a> (this, cellid, viscratio)</td></tr>
<tr class="memdesc:a48756737f677d59dbbd74ddd89c85791"><td class="mdescLeft">&#160;</td><td class="mdescRight">Account for viscosity in the aquiferhorizontal flow barriers.  <a href="namespacegwfvscmodule.html#a48756737f677d59dbbd74ddd89c85791">More...</a><br /></td></tr>
<tr class="separator:a48756737f677d59dbbd74ddd89c85791"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b649113d90d0467d113a631558195f7"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfvscmodule.html#a3b649113d90d0467d113a631558195f7">update_k_with_vsc</a> (this)</td></tr>
<tr class="memdesc:a3b649113d90d0467d113a631558195f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Appled the viscosity ratio (mu_o/mu) to the hydraulic conductivity.  <a href="namespacegwfvscmodule.html#a3b649113d90d0467d113a631558195f7">More...</a><br /></td></tr>
<tr class="separator:a3b649113d90d0467d113a631558195f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33c542887fbcf5b0816c293372dc66ea"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfvscmodule.html#a33c542887fbcf5b0816c293372dc66ea">vsc_set_changed_at</a> (this, kper, kstp)</td></tr>
<tr class="memdesc:a33c542887fbcf5b0816c293372dc66ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mark K changes as having occurred at (kper, kstp)  <a href="namespacegwfvscmodule.html#a33c542887fbcf5b0816c293372dc66ea">More...</a><br /></td></tr>
<tr class="separator:a33c542887fbcf5b0816c293372dc66ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a697cdfdb547b390db3f442ba411068"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfvscmodule.html#a5a697cdfdb547b390db3f442ba411068">vsc_ot_dv</a> (this, idvfl)</td></tr>
<tr class="memdesc:a5a697cdfdb547b390db3f442ba411068"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Output viscosity package dependent-variable terms.  <a href="namespacegwfvscmodule.html#a5a697cdfdb547b390db3f442ba411068">More...</a><br /></td></tr>
<tr class="separator:a5a697cdfdb547b390db3f442ba411068"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10527ea8afdd4162f7c51fed09df34e1"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfvscmodule.html#a10527ea8afdd4162f7c51fed09df34e1">vsc_da</a> (this)</td></tr>
<tr class="memdesc:a10527ea8afdd4162f7c51fed09df34e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Deallocate viscosity package memory  <a href="namespacegwfvscmodule.html#a10527ea8afdd4162f7c51fed09df34e1">More...</a><br /></td></tr>
<tr class="separator:a10527ea8afdd4162f7c51fed09df34e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a299b276ae0f74aa8126099c60769a307"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfvscmodule.html#a299b276ae0f74aa8126099c60769a307">read_dimensions</a> (this)</td></tr>
<tr class="memdesc:a299b276ae0f74aa8126099c60769a307"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Read dimensions  <a href="namespacegwfvscmodule.html#a299b276ae0f74aa8126099c60769a307">More...</a><br /></td></tr>
<tr class="separator:a299b276ae0f74aa8126099c60769a307"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad17b5274d93137f048c77dc4fa182f74"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfvscmodule.html#ad17b5274d93137f048c77dc4fa182f74">read_packagedata</a> (this)</td></tr>
<tr class="memdesc:ad17b5274d93137f048c77dc4fa182f74"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Read data for package  <a href="namespacegwfvscmodule.html#ad17b5274d93137f048c77dc4fa182f74">More...</a><br /></td></tr>
<tr class="separator:ad17b5274d93137f048c77dc4fa182f74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7542b09c9c9601c4586595a3e824a1c1"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfvscmodule.html#a7542b09c9c9601c4586595a3e824a1c1">set_packagedata</a> (this, input_data)</td></tr>
<tr class="memdesc:a7542b09c9c9601c4586595a3e824a1c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets package data instead of reading from file.  <a href="namespacegwfvscmodule.html#a7542b09c9c9601c4586595a3e824a1c1">More...</a><br /></td></tr>
<tr class="separator:a7542b09c9c9601c4586595a3e824a1c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ff0f551bca1a547401b8a152a01f042"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfvscmodule.html#a4ff0f551bca1a547401b8a152a01f042">vsc_calcvisc</a> (this)</td></tr>
<tr class="memdesc:a4ff0f551bca1a547401b8a152a01f042"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate fluid viscosity.  <a href="namespacegwfvscmodule.html#a4ff0f551bca1a547401b8a152a01f042">More...</a><br /></td></tr>
<tr class="separator:a4ff0f551bca1a547401b8a152a01f042"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a401ab4c2af078328050692d500b18d51"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfvscmodule.html#a401ab4c2af078328050692d500b18d51">allocate_scalars</a> (this)</td></tr>
<tr class="memdesc:a401ab4c2af078328050692d500b18d51"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Allocate scalars  <a href="namespacegwfvscmodule.html#a401ab4c2af078328050692d500b18d51">More...</a><br /></td></tr>
<tr class="separator:a401ab4c2af078328050692d500b18d51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c36028fcab76ace312b9659733b51d9"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfvscmodule.html#a2c36028fcab76ace312b9659733b51d9">allocate_arrays</a> (this, nodes)</td></tr>
<tr class="memdesc:a2c36028fcab76ace312b9659733b51d9"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Allocate arrays  <a href="namespacegwfvscmodule.html#a2c36028fcab76ace312b9659733b51d9">More...</a><br /></td></tr>
<tr class="separator:a2c36028fcab76ace312b9659733b51d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71e335e71bec38bb05cf1737afd0deb2"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfvscmodule.html#a71e335e71bec38bb05cf1737afd0deb2">read_options</a> (this)</td></tr>
<tr class="memdesc:a71e335e71bec38bb05cf1737afd0deb2"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Read Options block  <a href="namespacegwfvscmodule.html#a71e335e71bec38bb05cf1737afd0deb2">More...</a><br /></td></tr>
<tr class="separator:a71e335e71bec38bb05cf1737afd0deb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aadf8dec9590927ff339a690749631564"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfvscmodule.html#aadf8dec9590927ff339a690749631564">set_options</a> (this, input_data)</td></tr>
<tr class="memdesc:aadf8dec9590927ff339a690749631564"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets options as opposed to reading them from a file.  <a href="namespacegwfvscmodule.html#aadf8dec9590927ff339a690749631564">More...</a><br /></td></tr>
<tr class="separator:aadf8dec9590927ff339a690749631564"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5e187ed3445d268cfddedcf54ec1ae1"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfvscmodule.html#af5e187ed3445d268cfddedcf54ec1ae1">set_concentration_pointer</a> (this, modelname, conc, icbund, istmpr)</td></tr>
<tr class="memdesc:af5e187ed3445d268cfddedcf54ec1ae1"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Set pointers to concentration(s)  <a href="namespacegwfvscmodule.html#af5e187ed3445d268cfddedcf54ec1ae1">More...</a><br /></td></tr>
<tr class="separator:af5e187ed3445d268cfddedcf54ec1ae1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a2c36028fcab76ace312b9659733b51d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c36028fcab76ace312b9659733b51d9">&#9670;&nbsp;</a></span>allocate_arrays()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfvscmodule::allocate_arrays </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfvscmodule_1_1gwfvsctype.html">gwfvsctype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>nodes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Allocate and initialize arrays for the VSC package. </p>

<p class="definition">Definition at line <a class="el" href="gwf3vsc8_8f90_source.html#l01308">1308</a> of file <a class="el" href="gwf3vsc8_8f90_source.html">gwf3vsc8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;    <span class="keywordtype">class</span>(GwfVscType) :: this</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: nodes</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: i</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;<span class="comment">! ------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;    <span class="comment">! -- Allocate</span></div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;    <span class="keyword">call </span>mem_allocate(this%visc, nodes, <span class="stringliteral">&#39;VISC&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;    <span class="keyword">call </span>mem_allocate(this%ivisc, this%nviscspecies, <span class="stringliteral">&#39;IVISC&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;    <span class="keyword">call </span>mem_allocate(this%dviscdc, this%nviscspecies, <span class="stringliteral">&#39;DRHODC&#39;</span>, &amp;</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;                      this%memoryPath)</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;    <span class="keyword">call </span>mem_allocate(this%cviscref, this%nviscspecies, <span class="stringliteral">&#39;CRHOREF&#39;</span>, &amp;</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;                      this%memoryPath)</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;    <span class="keyword">call </span>mem_allocate(this%ctemp, this%nviscspecies, <span class="stringliteral">&#39;CTEMP&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;    <span class="keyword">allocate</span> (this%cmodelname(this%nviscspecies))</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;    <span class="keyword">allocate</span> (this%cauxspeciesname(this%nviscspecies))</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;    <span class="keyword">allocate</span> (this%modelconc(this%nviscspecies))</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;    <span class="comment">! -- Initialize</span></div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;    <span class="keywordflow">do</span> i = 1, nodes</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;      this%visc(i) = this%viscref</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;    <span class="comment">! -- Initialize nviscspecies arrays</span></div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;    <span class="keywordflow">do</span> i = 1, this%nviscspecies</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;      this%ivisc(i) = 1</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;      this%dviscdc(i) = dzero</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;      this%cviscref(i) = dzero</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;      this%ctemp(i) = dzero</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;      this%cmodelname(i) = <span class="stringliteral">&#39;&#39;</span></div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;      this%cauxspeciesname(i) = <span class="stringliteral">&#39;&#39;</span></div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a401ab4c2af078328050692d500b18d51"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a401ab4c2af078328050692d500b18d51">&#9670;&nbsp;</a></span>allocate_scalars()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfvscmodule::allocate_scalars </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfvscmodule_1_1gwfvsctype.html">gwfvsctype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Allocate and initialize scalars for the VSC package. The base model allocate scalars method is also called. </p>

<p class="definition">Definition at line <a class="el" href="gwf3vsc8_8f90_source.html#l01256">1256</a> of file <a class="el" href="gwf3vsc8_8f90_source.html">gwf3vsc8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;<span class="comment">! ******************************************************************************</span></div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;<span class="comment">! allocate_scalars</span></div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;<span class="comment">! ******************************************************************************</span></div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;<span class="comment">!    SPECIFICATIONS:</span></div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;<span class="comment">! ------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceconstantsmodule.html">constantsmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a>, <a class="code" href="namespaceconstantsmodule.html#ac01448fbf94949dbcc80aa705d7c80de">dten</a>, <a class="code" href="namespaceconstantsmodule.html#a2367e11addd73adb5eb9bd88baf3fe13">dep3</a></div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;    <span class="keywordtype">class</span>(GwfVscType) :: this</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;<span class="comment">! ------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;    <span class="comment">! -- allocate scalars in NumericalPackageType</span></div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;    <span class="keyword">call </span>this%NumericalPackageType%allocate_scalars()</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;    <span class="comment">! -- Allocate</span></div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;    <span class="keyword">call </span>mem_allocate(this%thermivisc, <span class="stringliteral">&#39;THERMIVISC&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;    <span class="keyword">call </span>mem_allocate(this%idxtmpr, <span class="stringliteral">&#39;IDXTMPR&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;    <span class="keyword">call </span>mem_allocate(this%ioutvisc, <span class="stringliteral">&#39;IOUTVISC&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;    <span class="keyword">call </span>mem_allocate(this%ireadelev, <span class="stringliteral">&#39;IREADELEV&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;    <span class="keyword">call </span>mem_allocate(this%iconcset, <span class="stringliteral">&#39;ICONCSET&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;    <span class="keyword">call </span>mem_allocate(this%viscref, <span class="stringliteral">&#39;VISCREF&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;    <span class="keyword">call </span>mem_allocate(this%a2, <span class="stringliteral">&#39;A2&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;    <span class="keyword">call </span>mem_allocate(this%a3, <span class="stringliteral">&#39;A3&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;    <span class="keyword">call </span>mem_allocate(this%a4, <span class="stringliteral">&#39;A4&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;    <span class="keyword">call </span>mem_allocate(this%nviscspecies, <span class="stringliteral">&#39;NVISCSPECIES&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;    <span class="comment">! -- Initialize</span></div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;    this%thermivisc = 0</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;    this%idxtmpr = 0</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    this%ioutvisc = 0</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;    this%ireadelev = 0</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;    this%iconcset = 0</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;    this%viscref = <a class="code" href="namespaceconstantsmodule.html#a2367e11addd73adb5eb9bd88baf3fe13">dep3</a></div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;    this%A2 = <a class="code" href="namespaceconstantsmodule.html#ac01448fbf94949dbcc80aa705d7c80de">dten</a></div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;    this%A3 = 248.37_dp</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;    this%A4 = 133.15_dp</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;    this%nviscspecies = 0</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;    <span class="keywordflow">return</span></div>
<div class="ttc" id="anamespaceconstantsmodule_html"><div class="ttname"><a href="namespaceconstantsmodule.html">constantsmodule</a></div><div class="ttdoc">This module contains simulation constants.</div><div class="ttdef"><b>Definition:</b> <a href="_constants_8f90_source.html#l00009">Constants.f90:9</a></div></div>
<div class="ttc" id="anamespaceconstantsmodule_html_a2367e11addd73adb5eb9bd88baf3fe13"><div class="ttname"><a href="namespaceconstantsmodule.html#a2367e11addd73adb5eb9bd88baf3fe13">constantsmodule::dep3</a></div><div class="ttdeci">real(dp), parameter dep3</div><div class="ttdoc">real constant 1000</div><div class="ttdef"><b>Definition:</b> <a href="_constants_8f90_source.html#l00084">Constants.f90:84</a></div></div>
<div class="ttc" id="anamespaceconstantsmodule_html_abab5757666b9ddd2726c20ce48dd0050"><div class="ttname"><a href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">constantsmodule::dzero</a></div><div class="ttdeci">real(dp), parameter dzero</div><div class="ttdoc">real constant zero</div><div class="ttdef"><b>Definition:</b> <a href="_constants_8f90_source.html#l00062">Constants.f90:62</a></div></div>
<div class="ttc" id="anamespaceconstantsmodule_html_ac01448fbf94949dbcc80aa705d7c80de"><div class="ttname"><a href="namespaceconstantsmodule.html#ac01448fbf94949dbcc80aa705d7c80de">constantsmodule::dten</a></div><div class="ttdeci">real(dp), parameter dten</div><div class="ttdoc">real constant 10</div><div class="ttdef"><b>Definition:</b> <a href="_constants_8f90_source.html#l00081">Constants.f90:81</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5e8b4072354d11b735667328a8417e98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e8b4072354d11b735667328a8417e98">&#9670;&nbsp;</a></span>calc_bnd_viscosity()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(dp) function gwfvscmodule::calc_bnd_viscosity </td>
          <td>(</td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>locvisc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>locconc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>viscref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>dviscdc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>cviscref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>ctemp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>ivisc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>a2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>a3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>a4</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:, :), intent(in)&#160;</td>
          <td class="paramname"><em>auxvar</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Return the viscosity of the boundary package using one of the options in the following order of priority:</p><ol type="1">
<li>Assign as aux variable in column with name 'VISCOSITY'</li>
<li>Calculate using viscosity equation and nviscspecies aux columns</li>
<li>If neither of those, then assign as viscref !! </li>
</ol>

<p class="definition">Definition at line <a class="el" href="gwf3vsc8_8f90_source.html#l00786">786</a> of file <a class="el" href="gwf3vsc8_8f90_source.html">gwf3vsc8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: n</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: locvisc</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: a2, a3, a4</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: ivisc</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: locconc</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: viscref</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: dviscdc</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: cviscref</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(inout)</span> :: ctemp</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(:, :)</span>, <span class="keywordtype">intent(in)</span> :: auxvar</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="keywordtype">    real</span>(DP) :: viscbnd</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: i</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;<span class="comment">! ------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    <span class="comment">! -- assign boundary viscosity based on one of three options</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    <span class="keywordflow">if</span> (locvisc &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;      <span class="comment">! -- assign viscosity to an aux column named &#39;VISCOSITY&#39;</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;      viscbnd = auxvar(locvisc, n)</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (locconc(1) &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;      <span class="comment">! -- calculate viscosity using one or more concentration auxcolumns</span></div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;      <span class="keywordflow">do</span> i = 1, <span class="keyword">size</span>(locconc)</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;        ctemp(i) = dzero</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;        <span class="keywordflow">if</span> (locconc(i) &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;          ctemp(i) = auxvar(locconc(i), n)</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;      viscbnd = calc_visc(ivisc, viscref, dviscdc, cviscref, ctemp, a2, a3, a4)</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;      <span class="comment">! -- neither of the above, so assign as viscref</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;      viscbnd = viscref</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfvscmodule_a5e8b4072354d11b735667328a8417e98_cgraph.png" border="0" usemap="#anamespacegwfvscmodule_a5e8b4072354d11b735667328a8417e98_cgraph" alt=""/></div>
<map name="anamespacegwfvscmodule_a5e8b4072354d11b735667328a8417e98_cgraph" id="anamespacegwfvscmodule_a5e8b4072354d11b735667328a8417e98_cgraph">
<area shape="rect" title="@ brief Calculate the boundary viscosity" alt="" coords="5,5,156,47"/>
<area shape="rect" href="namespacegwfvscmodule.html#af8db7009f19b86ca75174726d2358001" title=" " alt="" coords="204,13,388,39"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfvscmodule_a5e8b4072354d11b735667328a8417e98_icgraph.png" border="0" usemap="#anamespacegwfvscmodule_a5e8b4072354d11b735667328a8417e98_icgraph" alt=""/></div>
<map name="anamespacegwfvscmodule_a5e8b4072354d11b735667328a8417e98_icgraph" id="anamespacegwfvscmodule_a5e8b4072354d11b735667328a8417e98_icgraph">
<area shape="rect" title="@ brief Calculate the boundary viscosity" alt="" coords="512,74,663,115"/>
<area shape="rect" href="namespacegwfvscmodule.html#a476a324bbc28b0fe0f403acd75a323d8" title="Update lak&#45;related viscosity ratios." alt="" coords="261,5,458,32"/>
<area shape="rect" href="namespacegwfvscmodule.html#af4070491a5fac8c9ef18a537d9bff7af" title="Update maw&#45;related viscosity ratios." alt="" coords="255,56,464,83"/>
<area shape="rect" href="namespacegwfvscmodule.html#aa7423dfe6d14b2ecc499adf4bd9ff259" title="Update sfr&#45;related viscosity ratios." alt="" coords="262,107,457,133"/>
<area shape="rect" href="namespacegwfvscmodule.html#a3e5f71e404ad7000d2873ea98ccccedc" title="advance ghb while accounting for viscosity" alt="" coords="274,158,445,199"/>
<area shape="rect" href="namespacegwfvscmodule.html#ac936522aab940bab0a3a777937950905" title="Advance the boundary packages when viscosity is active." alt="" coords="5,81,207,108"/>
</map>
</div>

</div>
</div>
<a id="a48756737f677d59dbbd74ddd89c85791"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48756737f677d59dbbd74ddd89c85791">&#9670;&nbsp;</a></span>calc_q_visc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfvscmodule::calc_q_visc </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfvscmodule_1_1gwfvsctype.html">gwfvsctype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>cellid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>viscratio</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Will return the viscosity associated with the upgradient node (cell) to the HFB package for adjusting the hydraulic characteristic (hydchr) of the barrier </p>

<p class="definition">Definition at line <a class="el" href="gwf3vsc8_8f90_source.html#l00865">865</a> of file <a class="el" href="gwf3vsc8_8f90_source.html">gwf3vsc8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    <span class="keywordtype">class</span>(GwfVscType) :: this</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: cellid</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span> :: viscratio</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;<span class="keywordtype">    real</span>(DP) :: visc</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;<span class="comment">! ------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    <span class="comment">! -- Retrieve viscosity for the passed node number</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    visc = this%visc(cellid)</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    <span class="comment">! -- Calculate the viscosity ratio for the</span></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    viscratio = calc_vsc_ratio(this%viscref, visc)</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfvscmodule_a48756737f677d59dbbd74ddd89c85791_cgraph.png" border="0" usemap="#anamespacegwfvscmodule_a48756737f677d59dbbd74ddd89c85791_cgraph" alt=""/></div>
<map name="anamespacegwfvscmodule_a48756737f677d59dbbd74ddd89c85791_cgraph" id="anamespacegwfvscmodule_a48756737f677d59dbbd74ddd89c85791_cgraph">
<area shape="rect" title="Account for viscosity in the aquiferhorizontal flow barriers." alt="" coords="5,5,156,47"/>
<area shape="rect" href="namespacegwfvscmodule.html#a4bfcfd4477ee17446430a763d198634b" title="calculate and return the viscosity ratio" alt="" coords="204,5,355,47"/>
</map>
</div>

</div>
</div>
<a id="af8db7009f19b86ca75174726d2358001"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8db7009f19b86ca75174726d2358001">&#9670;&nbsp;</a></span>calc_visc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(dp) function gwfvscmodule::calc_visc </td>
          <td>(</td>
          <td class="paramtype">integer(i4b), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>ivisc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>viscref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>dviscdc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>cviscref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>conc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>a2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>a3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>a4</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gwf3vsc8_8f90_source.html#l00093">93</a> of file <a class="el" href="gwf3vsc8_8f90_source.html">gwf3vsc8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">! ******************************************************************************</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">! calc_visc -- generic function to calculate changes in fluid viscosity</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">!                  using a linear formulation</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">! ******************************************************************************</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">!    SPECIFICATIONS:</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">! ------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160; </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: ivisc</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: viscref</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: dviscdc</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: cviscref</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: conc</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: a2, a3, a4</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="keywordtype">    real</span>(DP) :: visc</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: nviscspec</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: i</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="keywordtype">    real</span>(DP) :: mu_t</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="keywordtype">    real</span>(DP) :: expon</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">! ------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    nviscspec = <span class="keyword">size</span>(dviscdc)</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    visc = viscref</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160; </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keywordflow">do</span> i = 1, nviscspec</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      <span class="keywordflow">if</span> (ivisc(i) == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        visc = visc + dviscdc(i) * (conc(i) - cviscref(i))</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        expon = -1 * a3 * ((conc(i) - cviscref(i)) / &amp;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                           ((conc(i) + a4) * (cviscref(i) + a4)))</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        mu_t = viscref * a2**expon</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        <span class="comment">! Order matters!! (This assumes we apply the temperature correction after</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        <span class="comment">! accounting for solute concentrations)</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        <span class="comment">! If a nonlinear correction is applied, then b/c it takes into account</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <span class="comment">! viscref, need to subtract it in this case</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <span class="comment">! At most, there will only ever be 1 nonlinear correction</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        visc = (visc - viscref) + mu_t</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      <span class="comment">! end if</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfvscmodule_af8db7009f19b86ca75174726d2358001_icgraph.png" border="0" usemap="#anamespacegwfvscmodule_af8db7009f19b86ca75174726d2358001_icgraph" alt=""/></div>
<map name="anamespacegwfvscmodule_af8db7009f19b86ca75174726d2358001_icgraph" id="anamespacegwfvscmodule_af8db7009f19b86ca75174726d2358001_icgraph">
<area shape="rect" title=" " alt="" coords="767,111,951,137"/>
<area shape="rect" href="namespacegwfvscmodule.html#a5e8b4072354d11b735667328a8417e98" title="@ brief Calculate the boundary viscosity" alt="" coords="540,74,691,115"/>
<area shape="rect" href="namespacegwfvscmodule.html#a4ff0f551bca1a547401b8a152a01f042" title="Calculate fluid viscosity." alt="" coords="512,140,719,167"/>
<area shape="rect" href="namespacegwfvscmodule.html#a476a324bbc28b0fe0f403acd75a323d8" title="Update lak&#45;related viscosity ratios." alt="" coords="261,5,458,32"/>
<area shape="rect" href="namespacegwfvscmodule.html#af4070491a5fac8c9ef18a537d9bff7af" title="Update maw&#45;related viscosity ratios." alt="" coords="255,56,464,83"/>
<area shape="rect" href="namespacegwfvscmodule.html#aa7423dfe6d14b2ecc499adf4bd9ff259" title="Update sfr&#45;related viscosity ratios." alt="" coords="262,107,457,133"/>
<area shape="rect" href="namespacegwfvscmodule.html#a3e5f71e404ad7000d2873ea98ccccedc" title="advance ghb while accounting for viscosity" alt="" coords="274,158,445,199"/>
<area shape="rect" href="namespacegwfvscmodule.html#ac936522aab940bab0a3a777937950905" title="Advance the boundary packages when viscosity is active." alt="" coords="5,81,207,108"/>
</map>
</div>

</div>
</div>
<a id="a4bfcfd4477ee17446430a763d198634b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4bfcfd4477ee17446430a763d198634b">&#9670;&nbsp;</a></span>calc_vsc_ratio()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(dp) function gwfvscmodule::calc_vsc_ratio </td>
          <td>(</td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>viscref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>bndvisc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gwf3vsc8_8f90_source.html#l00764">764</a> of file <a class="el" href="gwf3vsc8_8f90_source.html">gwf3vsc8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: viscref</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: bndvisc</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;<span class="keywordtype">    real</span>(DP) :: viscratio</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="comment">! -------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    viscratio = viscref / bndvisc</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfvscmodule_a4bfcfd4477ee17446430a763d198634b_icgraph.png" border="0" usemap="#anamespacegwfvscmodule_a4bfcfd4477ee17446430a763d198634b_icgraph" alt=""/></div>
<map name="anamespacegwfvscmodule_a4bfcfd4477ee17446430a763d198634b_icgraph" id="anamespacegwfvscmodule_a4bfcfd4477ee17446430a763d198634b_icgraph">
<area shape="rect" title="calculate and return the viscosity ratio" alt="" coords="755,129,905,171"/>
<area shape="rect" href="namespacegwfvscmodule.html#a48756737f677d59dbbd74ddd89c85791" title="Account for viscosity in the aquiferhorizontal flow barriers." alt="" coords="534,5,685,47"/>
<area shape="rect" href="namespacegwfvscmodule.html#a60546a198d138f74fb1224edcdbfeb10" title="Apply viscosity to the conductance term." alt="" coords="524,71,695,112"/>
<area shape="rect" href="namespacegwfvscmodule.html#a476a324bbc28b0fe0f403acd75a323d8" title="Update lak&#45;related viscosity ratios." alt="" coords="261,137,458,163"/>
<area shape="rect" href="namespacegwfvscmodule.html#af4070491a5fac8c9ef18a537d9bff7af" title="Update maw&#45;related viscosity ratios." alt="" coords="255,187,464,214"/>
<area shape="rect" href="namespacegwfvscmodule.html#aa7423dfe6d14b2ecc499adf4bd9ff259" title="Update sfr&#45;related viscosity ratios." alt="" coords="512,238,707,265"/>
<area shape="rect" href="namespacegwfvscmodule.html#a3e5f71e404ad7000d2873ea98ccccedc" title="advance ghb while accounting for viscosity" alt="" coords="274,71,445,112"/>
<area shape="rect" href="namespacegwfvscmodule.html#ac936522aab940bab0a3a777937950905" title="Advance the boundary packages when viscosity is active." alt="" coords="5,162,207,189"/>
</map>
</div>

</div>
</div>
<a id="ade94da49d74bd1a3a57c51fe6165a66a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade94da49d74bd1a3a57c51fe6165a66a">&#9670;&nbsp;</a></span>get_visc_ratio()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfvscmodule::get_visc_ratio </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfvscmodule_1_1gwfvsctype.html">gwfvsctype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>gwhdn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>gwhdm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(inout)&#160;</td>
          <td class="paramname"><em>viscratio</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Calculate the viscosity ratio applied to the hydraulic characteristic provided by the user. The viscosity ratio is applicable only when the hydraulic characteristic is specified as positive and will not be applied when the hydchr is negative </p>

<p class="definition">Definition at line <a class="el" href="gwf3vsc8_8f90_source.html#l00835">835</a> of file <a class="el" href="gwf3vsc8_8f90_source.html">gwf3vsc8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceconstantsmodule.html">constantsmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespaceconstantsmodule.html#af918ac22cd0b232deea67660bfbc9ce1">done</a></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    <span class="keywordtype">class</span>(GwfVscType) :: this</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: n, m</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: gwhdn, gwhdm</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(inout)</span> :: viscratio</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    <span class="comment">! -- loca</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: cellid</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;<span class="comment">! ------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    viscratio = <a class="code" href="namespaceconstantsmodule.html#af918ac22cd0b232deea67660bfbc9ce1">done</a></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    <span class="keywordflow">if</span> (gwhdm &gt; gwhdn) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;      cellid = m</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (gwhdn &gt;= gwhdm) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;      cellid = n</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    <span class="keyword">call </span>this%calc_q_visc(cellid, viscratio)</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    <span class="keywordflow">return</span></div>
<div class="ttc" id="anamespaceconstantsmodule_html_af918ac22cd0b232deea67660bfbc9ce1"><div class="ttname"><a href="namespaceconstantsmodule.html#af918ac22cd0b232deea67660bfbc9ce1">constantsmodule::done</a></div><div class="ttdeci">real(dp), parameter done</div><div class="ttdoc">real constant 1</div><div class="ttdef"><b>Definition:</b> <a href="_constants_8f90_source.html#l00073">Constants.f90:73</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a299b276ae0f74aa8126099c60769a307"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a299b276ae0f74aa8126099c60769a307">&#9670;&nbsp;</a></span>read_dimensions()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfvscmodule::read_dimensions </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfvscmodule_1_1gwfvsctype.html">gwfvsctype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Read dimensions for the viscosity package </p>

<p class="definition">Definition at line <a class="el" href="gwf3vsc8_8f90_source.html#l01039">1039</a> of file <a class="el" href="gwf3vsc8_8f90_source.html">gwf3vsc8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    <span class="keywordtype">class</span>(GwfVscType), <span class="keywordtype">intent(inout)</span> :: this</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;    <span class="keywordtype">character(len=LINELENGTH)</span> :: errmsg, keyword</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ierr</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    <span class="keywordtype">logical</span> :: isfound, endOfBlock</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;    <span class="comment">! -- format</span></div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;<span class="comment">! ------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;    <span class="comment">! -- get dimensions block</span></div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;    <span class="keyword">call </span>this%parser%GetBlock(<span class="stringliteral">&#39;DIMENSIONS&#39;</span>, isfound, ierr, &amp;</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;                              supportopenclose=.true.)</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;    <span class="comment">! -- parse dimensions block if detected</span></div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    <span class="keywordflow">if</span> (isfound) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;      <span class="keyword">write</span> (this%iout, <span class="stringliteral">&#39;(/1x,a)&#39;</span>) <span class="stringliteral">&#39;Processing VSC DIMENSIONS block&#39;</span></div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;      <span class="keywordflow">do</span></div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;        <span class="keyword">call </span>this%parser%GetNextLine(endofblock)</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;        <span class="keywordflow">if</span> (endofblock) <span class="keywordflow">exit</span></div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;        <span class="keyword">call </span>this%parser%GetStringCaps(keyword)</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;        <span class="keywordflow">select case</span> (keyword)</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;NVISCSPECIES&#39;</span>)</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;          this%nviscspecies = this%parser%GetInteger()</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;          <span class="keyword">write</span> (this%iout, <span class="stringliteral">&#39;(4x,a,i0)&#39;</span>) <span class="stringliteral">&#39;NVISCSPECIES = &#39;</span>, this%nviscspecies</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;<span class="keywordflow">        case default</span></div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;          <span class="keyword">write</span> (errmsg, <span class="stringliteral">&#39;(4x,a,a)&#39;</span>) &amp;</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;            <span class="stringliteral">&#39;unknown VSC dimension: &#39;</span>, trim(keyword)</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;          <span class="keyword">call </span>store_error(errmsg)</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;          <span class="keyword">call </span>this%parser%StoreErrorUnit()</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;<span class="keywordflow">        end select</span></div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;      <span class="keyword">write</span> (this%iout, <span class="stringliteral">&#39;(1x,a)&#39;</span>) <span class="stringliteral">&#39;End of VSC DIMENSIONS block&#39;</span></div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;      <span class="keyword">call </span>store_error(<span class="stringliteral">&#39;Required VSC DIMENSIONS block not found.&#39;</span>)</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;      <span class="keyword">call </span>this%parser%StoreErrorUnit()</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;    <span class="comment">! -- check dimension</span></div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    <span class="keywordflow">if</span> (this%nviscspecies &lt; 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;      <span class="keyword">call </span>store_error(<span class="stringliteral">&#39;NVISCSPECIES must be greater than zero.&#39;</span>)</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;      <span class="keyword">call </span>this%parser%StoreErrorUnit()</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfvscmodule_a299b276ae0f74aa8126099c60769a307_cgraph.png" border="0" usemap="#anamespacegwfvscmodule_a299b276ae0f74aa8126099c60769a307_cgraph" alt=""/></div>
<map name="anamespacegwfvscmodule_a299b276ae0f74aa8126099c60769a307_cgraph" id="anamespacegwfvscmodule_a299b276ae0f74aa8126099c60769a307_cgraph">
<area shape="rect" title="@ brief Read dimensions" alt="" coords="5,61,160,102"/>
<area shape="rect" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e" title="Store error message." alt="" coords="208,68,383,95"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="431,68,569,95"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="617,27,785,69"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title="Subroutine to stop the program." alt="" coords="617,93,785,134"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="833,5,1028,32"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title="Write simulation message." alt="" coords="847,57,1015,98"/>
</map>
</div>

</div>
</div>
<a id="a71e335e71bec38bb05cf1737afd0deb2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71e335e71bec38bb05cf1737afd0deb2">&#9670;&nbsp;</a></span>read_options()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfvscmodule::read_options </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfvscmodule_1_1gwfvsctype.html">gwfvsctype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Reads the options block inside the VSC package. </p>

<p class="definition">Definition at line <a class="el" href="gwf3vsc8_8f90_source.html#l01353">1353</a> of file <a class="el" href="gwf3vsc8_8f90_source.html">gwf3vsc8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceopenspecmodule.html">openspecmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespaceopenspecmodule.html#a5cd9b8ccff306158f81ed8cc744b1e46">access</a>, <a class="code" href="namespaceopenspecmodule.html#ade3198b3fa7a2972dae70d888f866536">form</a></div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceinputoutputmodule.html">inputoutputmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespaceinputoutputmodule.html#a653efe7e8a111c5e477fea26e0b04fe5">urword</a>, <a class="code" href="namespaceinputoutputmodule.html#a535bdfca3d31ebc3a8e4bd5af6890d55">getunit</a>, <a class="code" href="namespaceinputoutputmodule.html#a12462c53c53955327093c22ab7b89d99">urdaux</a>, <a class="code" href="namespaceinputoutputmodule.html#ae97851e3edae8d9809e384058a1a4d52">openfile</a></div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;    <span class="keywordtype">class</span>(GwfVscType) :: this</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;    <span class="keywordtype">character(len=LINELENGTH)</span> :: warnmsg, errmsg, keyword, keyword2</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;    <span class="keywordtype">character(len=MAXCHARLEN)</span> :: fname</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ierr</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;    <span class="keywordtype">logical</span> :: isfound, endOfBlock</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;    <span class="comment">! -- formats</span></div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">parameter</span> :: fmtfileout = &amp;</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;      <span class="stringliteral">&quot;(1x, &#39;VSC&#39;, 1x, a, 1x, &#39;Will be saved to file: &#39;, &amp;</span></div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;<span class="stringliteral"></span><span class="stringliteral">      &amp;a, /4x, &#39;opened on unit: &#39;, I7)&quot;</span></div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">parameter</span> :: fmtlinear = &amp;</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;      <span class="stringliteral">&quot;(/,1x,&#39;Viscosity will vary linearly with temperature &amp;</span></div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;<span class="stringliteral"></span><span class="stringliteral">      &amp;change &#39;)&quot;</span></div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">parameter</span> :: fmtnonlinear = &amp;</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;      <span class="stringliteral">&quot;(/,1x,&#39;Viscosity will vary non-linearly with temperature &amp;</span></div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;<span class="stringliteral"></span><span class="stringliteral">      &amp;change &#39;)&quot;</span></div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;<span class="comment">! ------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;    <span class="comment">! -- get options block</span></div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;    <span class="keyword">call </span>this%parser%GetBlock(<span class="stringliteral">&#39;OPTIONS&#39;</span>, isfound, ierr, &amp;</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;                              supportopenclose=.true., blockrequired=.false.)</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;    <span class="comment">! -- parse options block if detected</span></div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;    <span class="keywordflow">if</span> (isfound) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;      <span class="keyword">write</span> (this%iout, <span class="stringliteral">&#39;(1x,a)&#39;</span>) <span class="stringliteral">&#39;Processing VSC OPTIONS block&#39;</span></div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;      <span class="keywordflow">do</span></div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;        <span class="keyword">call </span>this%parser%GetNextLine(endofblock)</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;        <span class="keywordflow">if</span> (endofblock) <span class="keywordflow">exit</span></div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;        <span class="keyword">call </span>this%parser%GetStringCaps(keyword)</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;        <span class="keywordflow">select case</span> (keyword)</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;VISCREF&#39;</span>)</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;          this%viscref = this%parser%GetDouble()</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;          <span class="keyword">write</span> (this%iout, <span class="stringliteral">&#39;(4x,a,1pg15.6)&#39;</span>) &amp;</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;            <span class="stringliteral">&#39;Reference viscosity has been set to: &#39;</span>, &amp;</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;            this%viscref</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;VISCOSITY&#39;</span>)</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;          <span class="keyword">call </span>this%parser%GetStringCaps(keyword)</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;          <span class="keywordflow">if</span> (keyword == <span class="stringliteral">&#39;FILEOUT&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;            <span class="keyword">call </span>this%parser%GetString(fname)</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;            this%ioutvisc = <a class="code" href="namespaceinputoutputmodule.html#a535bdfca3d31ebc3a8e4bd5af6890d55">getunit</a>()</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;            <span class="keyword">call </span><a class="code" href="namespaceinputoutputmodule.html#ae97851e3edae8d9809e384058a1a4d52">openfile</a>(this%ioutvisc, this%iout, fname, <span class="stringliteral">&#39;DATA(BINARY)&#39;</span>, &amp;</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;                          <a class="code" href="namespaceopenspecmodule.html#ade3198b3fa7a2972dae70d888f866536">form</a>, <a class="code" href="namespaceopenspecmodule.html#a5cd9b8ccff306158f81ed8cc744b1e46">access</a>, <span class="stringliteral">&#39;REPLACE&#39;</span>)</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;            <span class="keyword">write</span> (this%iout, fmtfileout) &amp;</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;              <span class="stringliteral">&#39;VISCOSITY&#39;</span>, fname, this%ioutvisc</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;            errmsg = <span class="stringliteral">&#39;Optional VISCOSITY keyword must be &#39;</span>// &amp;</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;                     <span class="stringliteral">&#39;followed by FILEOUT&#39;</span></div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;            <span class="keyword">call </span>store_error(errmsg)</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;TEMPERATURE_SPECIES_NAME&#39;</span>)</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;          <span class="keyword">call </span>this%parser%GetStringCaps(this%name_temp_spec)</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;          <span class="keyword">write</span> (this%iout, <span class="stringliteral">&#39;(4x, a)&#39;</span>) <span class="stringliteral">&#39;Temperature species name set to: &#39;</span>// &amp;</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;            trim(this%name_temp_spec)</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;THERMAL_FORMULATION&#39;</span>)</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;          <span class="keyword">call </span>this%parser%GetStringCaps(keyword2)</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;          <span class="keywordflow">if</span> (trim(adjustl(keyword2)) == <span class="stringliteral">&#39;LINEAR&#39;</span>) this%thermivisc = 1</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;          <span class="keywordflow">if</span> (trim(adjustl(keyword2)) == <span class="stringliteral">&#39;NONLINEAR&#39;</span>) this%thermivisc = 2</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;          <span class="keywordflow">select case</span> (this%thermivisc)</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;          <span class="keywordflow">case</span> (1)</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;            <span class="keyword">write</span> (this%iout, fmtlinear)</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;          <span class="keywordflow">case</span> (2)</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;            <span class="keyword">write</span> (this%iout, fmtnonlinear)</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;<span class="keywordflow">          end select</span></div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;THERMAL_A2&#39;</span>)</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;          this%a2 = this%parser%GetDouble()</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;          <span class="keywordflow">if</span> (this%thermivisc == 2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;            <span class="keyword">write</span> (this%iout, <span class="stringliteral">&#39;(4x,a,1pg15.6)&#39;</span>) &amp;</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;              <span class="stringliteral">&#39;A2 in nonlinear viscosity formulation has been set to: &#39;</span>, &amp;</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;              this%a2</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;            <span class="keyword">write</span> (this%iout, <span class="stringliteral">&#39;(4x,a,/,4x,a,/,4x,a)&#39;</span>) <span class="stringliteral">&#39;THERMAL_A2 specified by user &amp;</span></div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;<span class="stringliteral"></span><span class="stringliteral">              &amp;in VSC Package input file. LINEAR viscosity &#39;</span>, <span class="stringliteral">&#39;formulation also &amp;</span></div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;<span class="stringliteral"></span><span class="stringliteral">              &amp;specified. THERMAL_A2 will not affect &#39;</span>, <span class="stringliteral">&#39;viscosity calculations.&#39;</span></div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;THERMAL_A3&#39;</span>)</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;          this%a3 = this%parser%GetDouble()</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;          <span class="keywordflow">if</span> (this%thermivisc == 2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;            <span class="keyword">write</span> (this%iout, <span class="stringliteral">&#39;(4x,a,1pg15.6)&#39;</span>) &amp;</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;              <span class="stringliteral">&#39;A3 in nonlinear viscosity formulation has been set to: &#39;</span>, &amp;</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;              this%a3</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;            <span class="keyword">write</span> (this%iout, <span class="stringliteral">&#39;(4x,a,/,4x,a,/,4x,a)&#39;</span>) <span class="stringliteral">&#39;THERMAL_A3 specified by user &amp;</span></div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;<span class="stringliteral"></span><span class="stringliteral">              &amp;in VSC Package input file. LINEAR viscosity &#39;</span>, <span class="stringliteral">&#39;formulation also &amp;</span></div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;<span class="stringliteral"></span><span class="stringliteral">              &amp;specified. THERMAL_A3 will not affect &#39;</span>, <span class="stringliteral">&#39;viscosity calculations.&#39;</span></div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;THERMAL_A4&#39;</span>)</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;          this%a4 = this%parser%GetDouble()</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;          <span class="keywordflow">if</span> (this%thermivisc == 2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;            <span class="keyword">write</span> (this%iout, <span class="stringliteral">&#39;(4x,a,1pg15.6)&#39;</span>) &amp;</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;              <span class="stringliteral">&#39;A4 in nonlinear viscosity formulation has been set to: &#39;</span>, &amp;</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;              this%a4</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;            <span class="keyword">write</span> (this%iout, <span class="stringliteral">&#39;(4x,a,/,4x,a,/,4x,a)&#39;</span>) <span class="stringliteral">&#39;THERMAL_A4 specified by user &amp;</span></div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;<span class="stringliteral"></span><span class="stringliteral">              &amp;in VSC Package input file. LINEAR viscosity &#39;</span>, <span class="stringliteral">&#39;formulation also &amp;</span></div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;<span class="stringliteral"></span><span class="stringliteral">              &amp;specified. THERMAL_A4 will not affect &#39;</span>, <span class="stringliteral">&#39;viscosity calculations.&#39;</span></div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;<span class="keywordflow">        case default</span></div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;          <span class="keyword">write</span> (errmsg, <span class="stringliteral">&#39;(4x,a,a)&#39;</span>) <span class="stringliteral">&#39;**Error. Unknown VSC option: &#39;</span>, &amp;</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;            trim(keyword)</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;          <span class="keyword">call </span>store_error(errmsg)</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;          <span class="keyword">call </span>this%parser%StoreErrorUnit()</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;<span class="keywordflow">        end select</span></div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;      <span class="keywordflow">if</span> (this%thermivisc == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;        <span class="keywordflow">if</span> (this%a2 == 0.0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;          <span class="keyword">write</span> (errmsg, <span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;LINEAR option selected for varying  &amp;</span></div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;<span class="stringliteral"></span><span class="stringliteral">            &amp;viscosity with temperature, but A1, a surrogate for &amp;</span></div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;<span class="stringliteral"></span><span class="stringliteral">            &amp;dVISC/dT, set equal to 0.0&#39;</span></div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;          <span class="keyword">call </span>store_error(errmsg)</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;      <span class="keywordflow">if</span> (this%thermivisc &gt; 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;        <span class="keywordflow">if</span> (this%a2 == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;          <span class="keyword">write</span> (warnmsg, <span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;NONLINEAR option selected for &amp;</span></div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;<span class="stringliteral"></span><span class="stringliteral">            &amp;varying viscosity with temperature, but A2 set equal to &amp;</span></div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;<span class="stringliteral"></span><span class="stringliteral">            &amp;zero which may lead to unintended values for viscosity&#39;</span></div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;          <span class="keyword">call </span>store_warning(errmsg)</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;        <span class="keywordflow">if</span> (this%a3 == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;          <span class="keyword">write</span> (warnmsg, <span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;NONLINEAR option selected for &amp;</span></div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;<span class="stringliteral"></span><span class="stringliteral">            &amp;varying viscosity with temperature,, but A3 set equal to &amp;</span></div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;<span class="stringliteral"></span><span class="stringliteral">            &amp;zero which may lead to unintended values for viscosity&#39;</span></div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;          <span class="keyword">call </span>store_warning(warnmsg)</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;        <span class="keywordflow">if</span> (this%a4 == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;          <span class="keyword">write</span> (warnmsg, <span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;NONLINEAR option selected for &amp;</span></div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;<span class="stringliteral"></span><span class="stringliteral">            &amp;varying viscosity with temperature, BUT A4 SET EQUAL TO &amp;</span></div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;<span class="stringliteral"></span><span class="stringliteral">            &amp;zero which may lead to unintended values for viscosity&#39;</span></div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;          <span class="keyword">call </span>store_warning(warnmsg)</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;    <span class="keyword">write</span> (this%iout, <span class="stringliteral">&#39;(/,1x,a)&#39;</span>) <span class="stringliteral">&#39;end of VSC options block&#39;</span></div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;    <span class="keywordflow">return</span></div>
<div class="ttc" id="anamespaceinputoutputmodule_html"><div class="ttname"><a href="namespaceinputoutputmodule.html">inputoutputmodule</a></div><div class="ttdef"><b>Definition:</b> <a href="_input_output_8f90_source.html#l00003">InputOutput.f90:3</a></div></div>
<div class="ttc" id="anamespaceinputoutputmodule_html_a12462c53c53955327093c22ab7b89d99"><div class="ttname"><a href="namespaceinputoutputmodule.html#a12462c53c53955327093c22ab7b89d99">inputoutputmodule::urdaux</a></div><div class="ttdeci">subroutine, public urdaux(naux, inunit, iout, lloc, istart, istop, auxname, line, text)</div><div class="ttdef"><b>Definition:</b> <a href="_input_output_8f90_source.html#l01784">InputOutput.f90:1785</a></div></div>
<div class="ttc" id="anamespaceinputoutputmodule_html_a535bdfca3d31ebc3a8e4bd5af6890d55"><div class="ttname"><a href="namespaceinputoutputmodule.html#a535bdfca3d31ebc3a8e4bd5af6890d55">inputoutputmodule::getunit</a></div><div class="ttdeci">integer(i4b) function, public getunit()</div><div class="ttdoc">Get a free unit number.</div><div class="ttdef"><b>Definition:</b> <a href="_input_output_8f90_source.html#l00188">InputOutput.f90:189</a></div></div>
<div class="ttc" id="anamespaceinputoutputmodule_html_a653efe7e8a111c5e477fea26e0b04fe5"><div class="ttname"><a href="namespaceinputoutputmodule.html#a653efe7e8a111c5e477fea26e0b04fe5">inputoutputmodule::urword</a></div><div class="ttdeci">subroutine, public urword(LINE, ICOL, ISTART, ISTOP, NCODE, N, R, IOUT, IN)</div><div class="ttdoc">Extract a word from a string.</div><div class="ttdef"><b>Definition:</b> <a href="_input_output_8f90_source.html#l00762">InputOutput.f90:763</a></div></div>
<div class="ttc" id="anamespaceinputoutputmodule_html_ae97851e3edae8d9809e384058a1a4d52"><div class="ttname"><a href="namespaceinputoutputmodule.html#ae97851e3edae8d9809e384058a1a4d52">inputoutputmodule::openfile</a></div><div class="ttdeci">subroutine, public openfile(iu, iout, fname, ftype, fmtarg_opt, accarg_opt, filstat_opt, mode_opt)</div><div class="ttdoc">Open a file.</div><div class="ttdef"><b>Definition:</b> <a href="_input_output_8f90_source.html#l00036">InputOutput.f90:38</a></div></div>
<div class="ttc" id="anamespaceopenspecmodule_html"><div class="ttname"><a href="namespaceopenspecmodule.html">openspecmodule</a></div><div class="ttdef"><b>Definition:</b> <a href="_open_spec_8f90_source.html#l00001">OpenSpec.f90:1</a></div></div>
<div class="ttc" id="anamespaceopenspecmodule_html_a5cd9b8ccff306158f81ed8cc744b1e46"><div class="ttname"><a href="namespaceopenspecmodule.html#a5cd9b8ccff306158f81ed8cc744b1e46">openspecmodule::access</a></div><div class="ttdeci">character(len=20) access</div><div class="ttdef"><b>Definition:</b> <a href="_open_spec_8f90_source.html#l00007">OpenSpec.f90:7</a></div></div>
<div class="ttc" id="anamespaceopenspecmodule_html_ade3198b3fa7a2972dae70d888f866536"><div class="ttname"><a href="namespaceopenspecmodule.html#ade3198b3fa7a2972dae70d888f866536">openspecmodule::form</a></div><div class="ttdeci">character(len=20) form</div><div class="ttdef"><b>Definition:</b> <a href="_open_spec_8f90_source.html#l00007">OpenSpec.f90:7</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfvscmodule_a71e335e71bec38bb05cf1737afd0deb2_cgraph.png" border="0" usemap="#anamespacegwfvscmodule_a71e335e71bec38bb05cf1737afd0deb2_cgraph" alt=""/></div>
<map name="anamespacegwfvscmodule_a71e335e71bec38bb05cf1737afd0deb2_cgraph" id="anamespacegwfvscmodule_a71e335e71bec38bb05cf1737afd0deb2_cgraph">
<area shape="rect" title="@ brief Read Options block" alt="" coords="5,203,160,244"/>
<area shape="rect" href="namespaceinputoutputmodule.html#a535bdfca3d31ebc3a8e4bd5af6890d55" title="Get a free unit number." alt="" coords="228,17,383,59"/>
<area shape="rect" href="namespaceinputoutputmodule.html#ae97851e3edae8d9809e384058a1a4d52" title="Open a file." alt="" coords="228,108,383,149"/>
<area shape="rect" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e" title="Store error message." alt="" coords="669,189,844,215"/>
<area shape="rect" href="namespacesimmodule.html#a0c10520244b0246773a188954a67ec9e" title="Store warning message." alt="" coords="208,235,403,262"/>
<area shape="rect" href="namespaceinputoutputmodule.html#a12462c53c53955327093c22ab7b89d99" title=" " alt="" coords="228,287,383,328"/>
<area shape="rect" href="namespaceinputoutputmodule.html#a653efe7e8a111c5e477fea26e0b04fe5" title="Extract a word from a string." alt="" coords="451,287,605,328"/>
<area shape="rect" href="namespaceinputoutputmodule.html#ac5134655c31ac9beeb4688f504efd801" title="Assign a free unopened unit number." alt="" coords="451,5,605,47"/>
<area shape="rect" href="namespaceinputoutputmodule.html#a8290bae8ca0756e38ce13459dfebe985" title="Convert to upper case." alt="" coords="451,71,605,112"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="908,235,1047,262"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="1095,228,1263,269"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title="Subroutine to stop the program." alt="" coords="1095,163,1263,204"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="1311,235,1505,262"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title="Write simulation message." alt="" coords="1324,287,1492,328"/>
<area shape="rect" href="namespaceinputoutputmodule.html#a5d0681efcccbea67f1d521a6729cbb4f" title="Convert to lower case." alt="" coords="679,345,834,387"/>
<area shape="rect" href="namespacesimmodule.html#a83910ed20af1fec9bdf46cad8c276538" title="Store the file unit number." alt="" coords="653,239,860,266"/>
</map>
</div>

</div>
</div>
<a id="ad17b5274d93137f048c77dc4fa182f74"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad17b5274d93137f048c77dc4fa182f74">&#9670;&nbsp;</a></span>read_packagedata()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfvscmodule::read_packagedata </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfvscmodule_1_1gwfvsctype.html">gwfvsctype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method to read data for the viscosity package. </p>

<p class="definition">Definition at line <a class="el" href="gwf3vsc8_8f90_source.html#l01093">1093</a> of file <a class="el" href="gwf3vsc8_8f90_source.html">gwf3vsc8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;    <span class="keywordtype">class</span>(GwfVscType) :: this</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;    <span class="keywordtype">character(len=LINELENGTH)</span> :: errmsg</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;    <span class="keywordtype">character(len=LINELENGTH)</span> :: line</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ierr</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: iviscspec</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    <span class="keywordtype">logical</span> :: isfound, endOfBlock</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;    <span class="keywordtype">logical</span> :: blockrequired</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span> :: itemp</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    <span class="keywordtype">character(len=10)</span> :: c10</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    <span class="keywordtype">character(len=16)</span> :: c16</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;    <span class="comment">! -- format</span></div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">parameter</span> :: fmterr = &amp;</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;      <span class="stringliteral">&quot;(&#39;Invalid value for IRHOSPEC (&#39;,i0,&#39;) detected in VSC Package. &amp;</span></div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;<span class="stringliteral"></span><span class="stringliteral">      &amp;IRHOSPEC must be &gt; 0 and &lt;= NVISCSPECIES, and duplicate values &amp;</span></div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;<span class="stringliteral"></span><span class="stringliteral">      &amp;are not allowed.&#39;)&quot;</span></div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;<span class="comment">! ------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;    <span class="comment">! -- initialize</span></div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    <span class="keyword">allocate</span> (itemp(this%nviscspecies))</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;    itemp(:) = 0</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;    <span class="comment">! -- get packagedata block</span></div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    blockrequired = .true.</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;    <span class="keyword">call </span>this%parser%GetBlock(<span class="stringliteral">&#39;PACKAGEDATA&#39;</span>, isfound, ierr, &amp;</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;                              blockrequired=blockrequired, &amp;</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;                              supportopenclose=.true.)</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    <span class="comment">! -- parse packagedata block</span></div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;    <span class="keywordflow">if</span> (isfound) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;      <span class="keyword">write</span> (this%iout, <span class="stringliteral">&#39;(1x,a)&#39;</span>) <span class="stringliteral">&#39;Procesing VSC PACKAGEDATA block&#39;</span></div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;      <span class="keywordflow">do</span></div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;        <span class="keyword">call </span>this%parser%GetNextLine(endofblock)</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;        <span class="keywordflow">if</span> (endofblock) <span class="keywordflow">exit</span></div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;        iviscspec = this%parser%GetInteger()</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;        <span class="keywordflow">if</span> (iviscspec &lt; 1 .or. iviscspec &gt; this%nviscspecies) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;          <span class="keyword">write</span> (errmsg, fmterr) iviscspec</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;          <span class="keyword">call </span>store_error(errmsg)</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;        <span class="keywordflow">if</span> (itemp(iviscspec) /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;          <span class="keyword">write</span> (errmsg, fmterr) iviscspec</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;          <span class="keyword">call </span>store_error(errmsg)</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;        itemp(iviscspec) = 1</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;        this%dviscdc(iviscspec) = this%parser%GetDouble()</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;        this%cviscref(iviscspec) = this%parser%GetDouble()</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;        <span class="keyword">call </span>this%parser%GetStringCaps(this%cmodelname(iviscspec))</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;        <span class="keyword">call </span>this%parser%GetStringCaps(this%cauxspeciesname(iviscspec))</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;        <span class="keywordflow">if</span> (this%cauxspeciesname(iviscspec) == this%name_temp_spec) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;          <span class="keywordflow">if</span> (this%idxtmpr &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;            <span class="keyword">write</span> (errmsg, <span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;More than one species in VSC input identified &amp;</span></div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;<span class="stringliteral"></span><span class="stringliteral">              &amp;as &#39;</span>//trim(this%name_temp_spec)//<span class="stringliteral">&#39;. Only one species may be &amp;</span></div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;<span class="stringliteral"></span><span class="stringliteral">              &amp;designated to represent temperature.&#39;</span></div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;            <span class="keyword">call </span>store_error(errmsg)</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;            this%idxtmpr = iviscspec</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;            <span class="keywordflow">if</span> (this%thermivisc == 2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;              this%ivisc(iviscspec) = 2</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;      <span class="keyword">call </span>store_error(<span class="stringliteral">&#39;Required VSC PACKAGEDATA block not found.&#39;</span>)</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;      <span class="keyword">call </span>this%parser%StoreErrorUnit()</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;    <span class="comment">! -- Check for errors.</span></div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;    <span class="keywordflow">if</span> (count_errors() &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;      <span class="keyword">call </span>this%parser%StoreErrorUnit()</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;    <span class="comment">! -- write packagedata information</span></div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;    <span class="keyword">write</span> (this%iout, <span class="stringliteral">&#39;(/,1x,a)&#39;</span>) <span class="stringliteral">&#39;Summary of species information in VSC Package&#39;</span></div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;    <span class="keyword">write</span> (this%iout, <span class="stringliteral">&#39;(1a11,5a17)&#39;</span>) &amp;</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;      <span class="stringliteral">&#39;Species&#39;</span>, <span class="stringliteral">&#39;DVISCDC&#39;</span>, <span class="stringliteral">&#39;CVISCREF&#39;</span>, <span class="stringliteral">&#39;Model&#39;</span>, <span class="stringliteral">&#39;AUXSPECIESNAME&#39;</span></div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;    <span class="keywordflow">do</span> iviscspec = 1, this%nviscspecies</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;      <span class="keyword">write</span> (c10, <span class="stringliteral">&#39;(i0)&#39;</span>) iviscspec</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;      line = <span class="stringliteral">&#39; &#39;</span>//adjustr(c10)</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160; </div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;      <span class="keyword">write</span> (c16, <span class="stringliteral">&#39;(g15.6)&#39;</span>) this%dviscdc(iviscspec)</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;      line = trim(line)//<span class="stringliteral">&#39; &#39;</span>//adjustr(c16)</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;      <span class="keyword">write</span> (c16, <span class="stringliteral">&#39;(g15.6)&#39;</span>) this%cviscref(iviscspec)</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;      line = trim(line)//<span class="stringliteral">&#39; &#39;</span>//adjustr(c16)</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;      <span class="keyword">write</span> (c16, <span class="stringliteral">&#39;(a)&#39;</span>) this%cmodelname(iviscspec)</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;      line = trim(line)//<span class="stringliteral">&#39; &#39;</span>//adjustr(c16)</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;      <span class="keyword">write</span> (c16, <span class="stringliteral">&#39;(a)&#39;</span>) this%cauxspeciesname(iviscspec)</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;      line = trim(line)//<span class="stringliteral">&#39; &#39;</span>//adjustr(c16)</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;      <span class="keyword">write</span> (this%iout, <span class="stringliteral">&#39;(a)&#39;</span>) trim(line)</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;    <span class="comment">! -- deallocate</span></div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    <span class="keyword">deallocate</span> (itemp)</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;    <span class="keyword">write</span> (this%iout, <span class="stringliteral">&#39;(/,1x,a)&#39;</span>) <span class="stringliteral">&#39;End of VSC PACKAGEDATA block&#39;</span></div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfvscmodule_ad17b5274d93137f048c77dc4fa182f74_cgraph.png" border="0" usemap="#anamespacegwfvscmodule_ad17b5274d93137f048c77dc4fa182f74_cgraph" alt=""/></div>
<map name="anamespacegwfvscmodule_ad17b5274d93137f048c77dc4fa182f74_cgraph" id="anamespacegwfvscmodule_ad17b5274d93137f048c77dc4fa182f74_cgraph">
<area shape="rect" title="@ brief Read data for package" alt="" coords="5,35,160,77"/>
<area shape="rect" href="namespacesimmodule.html#a4c46e49de78d4498dd4ec106357775e6" title="Return number of errors." alt="" coords="208,17,392,44"/>
<area shape="rect" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e" title="Store error message." alt="" coords="213,68,387,95"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="440,68,579,95"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="627,27,795,69"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title="Subroutine to stop the program." alt="" coords="627,93,795,134"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="843,5,1037,32"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title="Write simulation message." alt="" coords="856,57,1024,98"/>
</map>
</div>

</div>
</div>
<a id="af5e187ed3445d268cfddedcf54ec1ae1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5e187ed3445d268cfddedcf54ec1ae1">&#9670;&nbsp;</a></span>set_concentration_pointer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfvscmodule::set_concentration_pointer </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfvscmodule_1_1gwfvsctype.html">gwfvsctype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=lenmodelname), intent(in)&#160;</td>
          <td class="paramname"><em>modelname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), pointer&#160;</td>
          <td class="paramname"><em>conc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), dimension(:), pointer&#160;</td>
          <td class="paramname"><em>icbund</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in), optional&#160;</td>
          <td class="paramname"><em>istmpr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Pass in a gwt model name, concentration array, and ibound, and store a pointer to these in the VSC package so that viscosity can be calculated from them. This routine is called from the gwfgwt exchange in the <a class="el" href="namespacegwfgwtexchangemodule.html#aec07441e9d3360a6ed1e87e8c00e8f94">exg_ar()</a> method. </p>

<p class="definition">Definition at line <a class="el" href="gwf3vsc8_8f90_source.html#l01518">1518</a> of file <a class="el" href="gwf3vsc8_8f90_source.html">gwf3vsc8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;    <span class="keywordtype">class</span>(GwfVscType) :: this</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;    <span class="keywordtype">character(len=LENMODELNAME)</span>, <span class="keywordtype">intent(in)</span> :: modelname</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">pointer</span> :: conc</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">pointer</span> :: icbund</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: istmpr</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: i</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;    <span class="keywordtype">logical</span> :: found</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;<span class="comment">! ------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;    this%iconcset = 1</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;    found = .false.</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;    <span class="keywordflow">do</span> i = 1, this%nviscspecies</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;      <span class="keywordflow">if</span> (this%cmodelname(i) == modelname) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;        this%modelconc(i)%conc =&gt; conc</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;        this%modelconc(i)%icbund =&gt; icbund</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;        found = .true.</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;        <span class="keywordflow">exit</span></div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="aeeb4cb22f5cd30e78cd6255cca088b00"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeeb4cb22f5cd30e78cd6255cca088b00">&#9670;&nbsp;</a></span>set_npf_pointers()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfvscmodule::set_npf_pointers </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfvscmodule_1_1gwfvsctype.html">gwfvsctype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set array and variable pointers from the NPF package for access by VSC. </p>

<p class="definition">Definition at line <a class="el" href="gwf3vsc8_8f90_source.html#l00338">338</a> of file <a class="el" href="gwf3vsc8_8f90_source.html">gwf3vsc8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="keywordtype">class</span>(GwfVscType) :: this</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="keywordtype">character(len=LENMEMPATH)</span> :: npfMemoryPath</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="comment">! -- Set pointers to other package variables</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="comment">! -- NPF</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    npfmemorypath = create_mem_path(this%name_model, <span class="stringliteral">&#39;NPF&#39;</span>)</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="keyword">call </span>mem_setptr(this%k11, <span class="stringliteral">&#39;K11&#39;</span>, npfmemorypath)</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="keyword">call </span>mem_setptr(this%k22, <span class="stringliteral">&#39;K22&#39;</span>, npfmemorypath)</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="keyword">call </span>mem_setptr(this%k33, <span class="stringliteral">&#39;K33&#39;</span>, npfmemorypath)</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="keyword">call </span>mem_setptr(this%k11input, <span class="stringliteral">&#39;K11INPUT&#39;</span>, npfmemorypath)</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="keyword">call </span>mem_setptr(this%k22input, <span class="stringliteral">&#39;K22INPUT&#39;</span>, npfmemorypath)</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="keyword">call </span>mem_setptr(this%k33input, <span class="stringliteral">&#39;K33INPUT&#39;</span>, npfmemorypath)</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="keyword">call </span>mem_setptr(this%kchangeper, <span class="stringliteral">&#39;KCHANGEPER&#39;</span>, npfmemorypath)</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="keyword">call </span>mem_setptr(this%kchangestp, <span class="stringliteral">&#39;KCHANGESTP&#39;</span>, npfmemorypath)</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="keyword">call </span>mem_setptr(this%nodekchange, <span class="stringliteral">&#39;NODEKCHANGE&#39;</span>, npfmemorypath)</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfvscmodule_aeeb4cb22f5cd30e78cd6255cca088b00_cgraph.png" border="0" usemap="#anamespacegwfvscmodule_aeeb4cb22f5cd30e78cd6255cca088b00_cgraph" alt=""/></div>
<map name="anamespacegwfvscmodule_aeeb4cb22f5cd30e78cd6255cca088b00_cgraph" id="anamespacegwfvscmodule_aeeb4cb22f5cd30e78cd6255cca088b00_cgraph">
<area shape="rect" title="Set pointers to NPF variables." alt="" coords="5,61,179,102"/>
<area shape="rect" href="namespacememoryhelpermodule.html#abe77d18fe02d108d80f414f9fafa592d" title="returns the path to the memory object" alt="" coords="227,61,393,102"/>
<area shape="rect" href="namespacememoryhelpermodule.html#a5405f58247a0962e5449ebc1e4dcff0f" title="Generic routine to check the length of (parts of) the memory address." alt="" coords="441,61,608,102"/>
<area shape="rect" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e" title="Store error message." alt="" coords="656,68,831,95"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="879,68,1017,95"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="1065,27,1233,69"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title="Subroutine to stop the program." alt="" coords="1065,93,1233,134"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="1281,5,1476,32"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title="Write simulation message." alt="" coords="1295,57,1463,98"/>
</map>
</div>

</div>
</div>
<a id="aadf8dec9590927ff339a690749631564"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aadf8dec9590927ff339a690749631564">&#9670;&nbsp;</a></span>set_options()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfvscmodule::set_options </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfvscmodule_1_1gwfvsctype.html">gwfvsctype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structgwfvscinputdatamodule_1_1gwfvscinputdatatype.html">gwfvscinputdatatype</a>), intent(in)&#160;</td>
          <td class="paramname"><em>input_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">input_data</td><td>the input data to be set </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3vsc8_8f90_source.html#l01500">1500</a> of file <a class="el" href="gwf3vsc8_8f90_source.html">gwf3vsc8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;    <span class="keywordtype">class</span>(GwfVscType) :: this</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;    <span class="keywordtype">type</span>(GwfVscInputDataType), <span class="keywordtype">intent(in)</span> :: input_data<span class="comment"> !&lt; the input data to be set</span></div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160; </div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;    this%viscref = input_data%viscref</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7542b09c9c9601c4586595a3e824a1c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7542b09c9c9601c4586595a3e824a1c1">&#9670;&nbsp;</a></span>set_packagedata()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfvscmodule::set_packagedata </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfvscmodule_1_1gwfvsctype.html">gwfvsctype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structgwfvscinputdatamodule_1_1gwfvscinputdatatype.html">gwfvscinputdatatype</a>), intent(in)&#160;</td>
          <td class="paramname"><em>input_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>this vscoancy pkg </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">input_data</td><td>the input data to be set </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3vsc8_8f90_source.html#l01200">1200</a> of file <a class="el" href="gwf3vsc8_8f90_source.html">gwf3vsc8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;    <span class="keywordtype">class</span>(GwfVscType) :: this<span class="comment"> !&lt; this vscoancy pkg</span></div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;    <span class="keywordtype">type</span>(GwfVscInputDataType), <span class="keywordtype">intent(in)</span> :: input_data<span class="comment"> !&lt; the input data to be set</span></div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;    <span class="comment">! local</span></div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ispec</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160; </div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;    <span class="keywordflow">do</span> ispec = 1, this%nviscspecies</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;      this%dviscdc(ispec) = input_data%dviscdc(ispec)</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;      this%cviscref(ispec) = input_data%cviscref(ispec)</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;      this%cmodelname(ispec) = input_data%cmodelname(ispec)</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;      this%cauxspeciesname(ispec) = input_data%cauxspeciesname(ispec)</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160; </div>
</div><!-- fragment -->
</div>
</div>
<a id="a60546a198d138f74fb1224edcdbfeb10"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60546a198d138f74fb1224edcdbfeb10">&#9670;&nbsp;</a></span>update_bnd_cond()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(dp) function gwfvscmodule::update_bnd_cond </td>
          <td>(</td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>bndvisc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>viscref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>spcfdcond</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>When the viscosity package is active apply the viscosity ratio to the active boundary package's conductance term. </p>

<p class="definition">Definition at line <a class="el" href="gwf3vsc8_8f90_source.html#l00742">742</a> of file <a class="el" href="gwf3vsc8_8f90_source.html">gwf3vsc8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: viscref</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: bndvisc</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: spcfdcond</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;<span class="keywordtype">    real</span>(DP) :: vscratio</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;<span class="keywordtype">    real</span>(DP) :: updatedcond</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;<span class="comment">! -------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    vscratio = calc_vsc_ratio(viscref, bndvisc)</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    <span class="comment">! -- calculate new conductance here</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    updatedcond = vscratio * spcfdcond</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfvscmodule_a60546a198d138f74fb1224edcdbfeb10_cgraph.png" border="0" usemap="#anamespacegwfvscmodule_a60546a198d138f74fb1224edcdbfeb10_cgraph" alt=""/></div>
<map name="anamespacegwfvscmodule_a60546a198d138f74fb1224edcdbfeb10_cgraph" id="anamespacegwfvscmodule_a60546a198d138f74fb1224edcdbfeb10_cgraph">
<area shape="rect" title="Apply viscosity to the conductance term." alt="" coords="5,5,176,47"/>
<area shape="rect" href="namespacegwfvscmodule.html#a4bfcfd4477ee17446430a763d198634b" title="calculate and return the viscosity ratio" alt="" coords="224,5,375,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfvscmodule_a60546a198d138f74fb1224edcdbfeb10_icgraph.png" border="0" usemap="#anamespacegwfvscmodule_a60546a198d138f74fb1224edcdbfeb10_icgraph" alt=""/></div>
<map name="anamespacegwfvscmodule_a60546a198d138f74fb1224edcdbfeb10_icgraph" id="anamespacegwfvscmodule_a60546a198d138f74fb1224edcdbfeb10_icgraph">
<area shape="rect" title="Apply viscosity to the conductance term." alt="" coords="473,5,644,47"/>
<area shape="rect" href="namespacegwfvscmodule.html#a3e5f71e404ad7000d2873ea98ccccedc" title="advance ghb while accounting for viscosity" alt="" coords="255,5,425,47"/>
<area shape="rect" href="namespacegwfvscmodule.html#ac936522aab940bab0a3a777937950905" title="Advance the boundary packages when viscosity is active." alt="" coords="5,13,207,39"/>
</map>
</div>

</div>
</div>
<a id="a3b649113d90d0467d113a631558195f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b649113d90d0467d113a631558195f7">&#9670;&nbsp;</a></span>update_k_with_vsc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfvscmodule::update_k_with_vsc </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfvscmodule_1_1gwfvsctype.html">gwfvsctype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This routine called after updating the viscosity values using the latest concentration and/or temperature values. The ratio mu_o/mu, reference viscosity divided by the updated viscosity value, is multiplied by K for each cell. </p>

<p class="definition">Definition at line <a class="el" href="gwf3vsc8_8f90_source.html#l00892">892</a> of file <a class="el" href="gwf3vsc8_8f90_source.html">gwf3vsc8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    <span class="keywordtype">class</span>(GwfVscType) :: this</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;<span class="keywordtype">    real</span>(DP) :: viscratio</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;<span class="comment">! ------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    <span class="comment">! -- For viscosity-based K&#39;s, apply change of K to K11 by starting with</span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;    <span class="comment">!    user-specified K values and not the K&#39;s leftover from the last viscosity</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    <span class="comment">!    update.</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    <span class="keywordflow">do</span> n = 1, this%dis%nodes</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;      <span class="keyword">call </span>this%calc_q_visc(n, viscratio)</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;      this%k11(n) = this%k11input(n) * viscratio</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;      this%k22(n) = this%k22input(n) * viscratio</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;      this%k33(n) = this%k33input(n) * viscratio</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;      this%nodekchange(n) = 1</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    <span class="comment">! -- Flag kchange</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    <span class="keyword">call </span>this%vsc_set_changed_at(kper, kstp)</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a54a002f87a7fb6c4e3d6040d957081a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54a002f87a7fb6c4e3d6040d957081a2">&#9670;&nbsp;</a></span>vsc_ad()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfvscmodule::vsc_ad </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfvscmodule_1_1gwfvsctype.html">gwfvsctype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Advance data in the VSC package. The method sets or advances time series, time array series, and observation data. </p>

<p class="definition">Definition at line <a class="el" href="gwf3vsc8_8f90_source.html#l00405">405</a> of file <a class="el" href="gwf3vsc8_8f90_source.html">gwf3vsc8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="keywordtype">class</span>(GwfVscType) :: this</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment">! ------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="comment">! -- update viscosity using the latest concentration/temperature</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="keyword">call </span>this%vsc_calcvisc()</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac936522aab940bab0a3a777937950905"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac936522aab940bab0a3a777937950905">&#9670;&nbsp;</a></span>vsc_ad_bnd()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfvscmodule::vsc_ad_bnd </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfvscmodule_1_1gwfvsctype.html">gwfvsctype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(<a class="el" href="structbndmodule_1_1bndtype.html">bndtype</a>), pointer&#160;</td>
          <td class="paramname"><em>packobj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>hnew</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Update the conductance values associate with inflow from a boundary when VSC package is active. </p>

<p class="definition">Definition at line <a class="el" href="gwf3vsc8_8f90_source.html#l00423">423</a> of file <a class="el" href="gwf3vsc8_8f90_source.html">gwf3vsc8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacebndmodule.html">bndmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="structbndmodule_1_1bndtype.html">bndtype</a></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="keywordtype">class</span>(GwfVscType) :: this</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="keywordtype">class</span>(BndType), <span class="keywordtype">pointer</span> :: packobj</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(:)</span> :: hnew</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: i, j</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n, locvisc, locelev</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span> :: locconc</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="comment">! -- initialize</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    locvisc = 0</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    locelev = 0</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <span class="keyword">allocate</span> (locconc(this%nviscspecies))</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    locconc(:) = 0</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <span class="comment">! -- Add viscosity terms for conductance-dependent boundaries</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="keywordflow">do</span> n = 1, packobj%naux</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;      <span class="keywordflow">if</span> (packobj%auxname(n) == <span class="stringliteral">&#39;VISCOSITY&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        locvisc = n</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (packobj%auxname(n) == <span class="stringliteral">&#39;ELEVATION&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        locelev = n</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="comment">! -- find aux columns for conc (or temp.) that affect viscosity</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="keywordflow">do</span> i = 1, this%nviscspecies</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;      locconc(i) = 0</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;      <span class="keywordflow">do</span> j = 1, packobj%naux</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        <span class="keywordflow">if</span> (this%cauxspeciesname(i) == packobj%auxname(j)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;          locconc(i) = j</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;          <span class="keywordflow">exit</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;      <span class="keywordflow">if</span> (locconc(i) == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        <span class="comment">! -- one not found, so don&#39;t use and mark all as 0</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        locconc(:) = 0</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        <span class="keywordflow">exit</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <span class="comment">! -- apply viscosity terms to inflow from boundary based on package type</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="keywordflow">select case</span> (packobj%filtyp)</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <span class="keywordflow">case</span> (<span class="stringliteral">&#39;GHB&#39;</span>, <span class="stringliteral">&#39;DRN&#39;</span>, <span class="stringliteral">&#39;RIV&#39;</span>)</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;      <span class="comment">! -- general head, drain, and river boundary</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;      <span class="keyword">call </span>vsc_ad_standard_bnd(packobj, hnew, this%visc, this%viscref, &amp;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                               locelev, locvisc, locconc, this%dviscdc, &amp;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                               this%cviscref, this%ivisc, this%a2, this%a3, &amp;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                               this%a4, this%ctemp)</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="keywordflow">case</span> (<span class="stringliteral">&#39;LAK&#39;</span>)</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;      <span class="comment">! -- lake</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;      <span class="comment">!  Update &#39;viscratios&#39; internal to lak such that they are</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;      <span class="comment">!  automatically applied in the LAK calc_cond() routine</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;      <span class="keyword">call </span>vsc_ad_lak(packobj, this%visc, this%viscref, this%elev, locvisc, &amp;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                      locconc, this%dviscdc, this%cviscref, this%ivisc, &amp;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                      this%a2, this%a3, this%a4, this%ctemp)</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <span class="keywordflow">case</span> (<span class="stringliteral">&#39;SFR&#39;</span>)</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;      <span class="comment">! -- streamflow routing</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;      <span class="comment">!  Update &#39;viscratios&#39; internal to sfr such that they are</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;      <span class="comment">!  automatically applied in the SFR calc_cond() routine</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;      <span class="keyword">call </span>vsc_ad_sfr(packobj, this%visc, this%viscref, this%elev, locvisc, &amp;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                      locconc, this%dviscdc, this%cviscref, this%ivisc, &amp;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                      this%a2, this%a3, this%a4, this%ctemp)</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <span class="keywordflow">case</span> (<span class="stringliteral">&#39;MAW&#39;</span>)</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;      <span class="comment">! -- multi-aquifer well</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;      <span class="keyword">call </span>vsc_ad_maw(packobj, this%visc, this%viscref, this%elev, locvisc, &amp;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                      locconc, this%dviscdc, this%cviscref, this%ivisc, &amp;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                      this%a2, this%a3, this%a4, this%ctemp)</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="keywordflow">case</span> (<span class="stringliteral">&#39;UZF&#39;</span>)</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;      <span class="comment">! -- unsaturated-zone flow</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="keywordflow">    case default</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;      <span class="comment">! -- nothing</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="keywordflow">    end select</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <span class="comment">! -- deallocate</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="keyword">deallocate</span> (locconc)</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="keywordflow">return</span></div>
<div class="ttc" id="anamespacebndmodule_html"><div class="ttname"><a href="namespacebndmodule.html">bndmodule</a></div><div class="ttdoc">This module contains the base boundary package.</div><div class="ttdef"><b>Definition:</b> <a href="_boundary_package_8f90_source.html#l00008">BoundaryPackage.f90:8</a></div></div>
<div class="ttc" id="astructbndmodule_1_1bndtype_html"><div class="ttname"><a href="structbndmodule_1_1bndtype.html">bndmodule::bndtype</a></div><div class="ttdoc">@ brief BndType</div><div class="ttdef"><b>Definition:</b> <a href="_boundary_package_8f90_source.html#l00047">BoundaryPackage.f90:47</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfvscmodule_ac936522aab940bab0a3a777937950905_cgraph.png" border="0" usemap="#anamespacegwfvscmodule_ac936522aab940bab0a3a777937950905_cgraph" alt=""/></div>
<map name="anamespacegwfvscmodule_ac936522aab940bab0a3a777937950905_cgraph" id="anamespacegwfvscmodule_ac936522aab940bab0a3a777937950905_cgraph">
<area shape="rect" title="Advance the boundary packages when viscosity is active." alt="" coords="5,85,207,112"/>
<area shape="rect" href="namespacegwfvscmodule.html#a476a324bbc28b0fe0f403acd75a323d8" title="Update lak&#45;related viscosity ratios." alt="" coords="261,56,458,83"/>
<area shape="rect" href="namespacegwfvscmodule.html#af4070491a5fac8c9ef18a537d9bff7af" title="Update maw&#45;related viscosity ratios." alt="" coords="255,173,464,200"/>
<area shape="rect" href="namespacegwfvscmodule.html#aa7423dfe6d14b2ecc499adf4bd9ff259" title="Update sfr&#45;related viscosity ratios." alt="" coords="262,5,457,32"/>
<area shape="rect" href="namespacegwfvscmodule.html#a3e5f71e404ad7000d2873ea98ccccedc" title="advance ghb while accounting for viscosity" alt="" coords="274,107,445,149"/>
<area shape="rect" href="namespacegwfvscmodule.html#a5e8b4072354d11b735667328a8417e98" title="@ brief Calculate the boundary viscosity" alt="" coords="522,78,673,119"/>
<area shape="rect" href="namespacegwfvscmodule.html#a4bfcfd4477ee17446430a763d198634b" title="calculate and return the viscosity ratio" alt="" coords="747,19,898,61"/>
<area shape="rect" href="namespacegwfvscmodule.html#af8db7009f19b86ca75174726d2358001" title=" " alt="" coords="731,85,915,112"/>
<area shape="rect" href="namespacegwfvscmodule.html#a60546a198d138f74fb1224edcdbfeb10" title="Apply viscosity to the conductance term." alt="" coords="512,143,683,185"/>
</map>
</div>

</div>
</div>
<a id="a476a324bbc28b0fe0f403acd75a323d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a476a324bbc28b0fe0f403acd75a323d8">&#9670;&nbsp;</a></span>vsc_ad_lak()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfvscmodule::vsc_ad_lak </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structbndmodule_1_1bndtype.html">bndtype</a>), pointer&#160;</td>
          <td class="paramname"><em>packobj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>visc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>viscref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>elev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>locvisc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>locconc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>dviscdc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>cviscref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>ivisc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>a2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>a3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>a4</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>ctemp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>When the viscosity package is active, update the viscosity ratio that is applied to the lakebed conductance calculated in the LAK package </p>

<p class="definition">Definition at line <a class="el" href="gwf3vsc8_8f90_source.html#l00626">626</a> of file <a class="el" href="gwf3vsc8_8f90_source.html">gwf3vsc8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacebndmodule.html">bndmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="structbndmodule_1_1bndtype.html">bndtype</a></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacelakmodule.html">lakmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="structlakmodule_1_1laktype.html">laktype</a></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    <span class="keywordtype">class</span>(BndType), <span class="keywordtype">pointer</span> :: packobj</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: viscref</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: a2, a3, a4</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: locvisc</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: locconc</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: ivisc</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: visc</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: elev</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: dviscdc</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: cviscref</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(inout)</span> :: ctemp</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: node</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="keywordtype">    real</span>(DP) :: visclak</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="comment">! -------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <span class="comment">! -- update viscosity ratios for updating hyd. cond (and conductance)</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    <span class="keywordflow">select type</span> (packobj)</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;<span class="keywordflow">    type is</span> (<a class="code" href="structlakmodule_1_1laktype.html">laktype</a>)</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;      <span class="keywordflow">do</span> n = 1, packobj%nbound</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;        <span class="comment">! -- get gwf node number</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;        node = packobj%nodelist(n)</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;        <span class="comment">! -- Check if boundary cell is active, cycle if not</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;        <span class="keywordflow">if</span> (packobj%ibound(node) &lt;= 0) cycle</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;        <span class="comment">! --</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;        <span class="comment">! -- calculate the viscosity associcated with the boundary</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;        visclak = calc_bnd_viscosity(n, locvisc, locconc, viscref, dviscdc, &amp;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;                                     cviscref, ctemp, ivisc, a2, a3, a4, &amp;</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                                     packobj%auxvar)</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        <span class="comment">! -- fill lak relative viscosity into column 1 of viscratios</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        packobj%viscratios(1, n) = calc_vsc_ratio(viscref, visclak)</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        <span class="comment">! -- fill gwf relative viscosity into column 2 of viscratios</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        packobj%viscratios(2, n) = calc_vsc_ratio(viscref, visc(node))</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="keywordflow">    end select</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    <span class="keywordflow">return</span></div>
<div class="ttc" id="anamespacelakmodule_html"><div class="ttname"><a href="namespacelakmodule.html">lakmodule</a></div><div class="ttdef"><b>Definition:</b> <a href="gwf3lak8_8f90_source.html#l00001">gwf3lak8.f90:1</a></div></div>
<div class="ttc" id="astructlakmodule_1_1laktype_html"><div class="ttname"><a href="structlakmodule_1_1laktype.html">lakmodule::laktype</a></div><div class="ttdef"><b>Definition:</b> <a href="gwf3lak8_8f90_source.html#l00049">gwf3lak8.f90:49</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfvscmodule_a476a324bbc28b0fe0f403acd75a323d8_cgraph.png" border="0" usemap="#anamespacegwfvscmodule_a476a324bbc28b0fe0f403acd75a323d8_cgraph" alt=""/></div>
<map name="anamespacegwfvscmodule_a476a324bbc28b0fe0f403acd75a323d8_cgraph" id="anamespacegwfvscmodule_a476a324bbc28b0fe0f403acd75a323d8_cgraph">
<area shape="rect" title="Update lak&#45;related viscosity ratios." alt="" coords="5,46,203,73"/>
<area shape="rect" href="namespacegwfvscmodule.html#a5e8b4072354d11b735667328a8417e98" title="@ brief Calculate the boundary viscosity" alt="" coords="251,5,401,47"/>
<area shape="rect" href="namespacegwfvscmodule.html#a4bfcfd4477ee17446430a763d198634b" title="calculate and return the viscosity ratio" alt="" coords="251,71,401,112"/>
<area shape="rect" href="namespacegwfvscmodule.html#af8db7009f19b86ca75174726d2358001" title=" " alt="" coords="449,13,633,39"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfvscmodule_a476a324bbc28b0fe0f403acd75a323d8_icgraph.png" border="0" usemap="#anamespacegwfvscmodule_a476a324bbc28b0fe0f403acd75a323d8_icgraph" alt=""/></div>
<map name="anamespacegwfvscmodule_a476a324bbc28b0fe0f403acd75a323d8_icgraph" id="anamespacegwfvscmodule_a476a324bbc28b0fe0f403acd75a323d8_icgraph">
<area shape="rect" title="Update lak&#45;related viscosity ratios." alt="" coords="255,5,452,32"/>
<area shape="rect" href="namespacegwfvscmodule.html#ac936522aab940bab0a3a777937950905" title="Advance the boundary packages when viscosity is active." alt="" coords="5,5,207,32"/>
</map>
</div>

</div>
</div>
<a id="af4070491a5fac8c9ef18a537d9bff7af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4070491a5fac8c9ef18a537d9bff7af">&#9670;&nbsp;</a></span>vsc_ad_maw()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfvscmodule::vsc_ad_maw </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structbndmodule_1_1bndtype.html">bndtype</a>), pointer&#160;</td>
          <td class="paramname"><em>packobj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>visc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>viscref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>elev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>locvisc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>locconc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>dviscdc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>cviscref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>ivisc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>a2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>a3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>a4</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>ctemp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>When the viscosity package is active, update the viscosity ratio that is applied to the conductance calculated in the MAW package </p>

<p class="definition">Definition at line <a class="el" href="gwf3vsc8_8f90_source.html#l00684">684</a> of file <a class="el" href="gwf3vsc8_8f90_source.html">gwf3vsc8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacebndmodule.html">bndmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="structbndmodule_1_1bndtype.html">bndtype</a></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacemawmodule.html">mawmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="structmawmodule_1_1mawtype.html">mawtype</a></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    <span class="keywordtype">class</span>(BndType), <span class="keywordtype">pointer</span> :: packobj</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: viscref</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: a2, a3, a4</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: locvisc</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: locconc</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: ivisc</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: visc</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: elev</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: dviscdc</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: cviscref</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(inout)</span> :: ctemp</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: node</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="keywordtype">    real</span>(DP) :: viscmaw</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="comment">! -------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    <span class="comment">! -- update viscosity ratios for updating hyd. cond (and conductance)</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    <span class="keywordflow">select type</span> (packobj)</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;<span class="keywordflow">    type is</span> (<a class="code" href="structmawmodule_1_1mawtype.html">mawtype</a>)</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;      <span class="keywordflow">do</span> n = 1, packobj%nbound</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;        <span class="comment">! -- get gwf node number</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;        node = packobj%nodelist(n)</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        <span class="comment">! -- Check if boundary cell is active, cycle if not</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;        <span class="keywordflow">if</span> (packobj%ibound(node) &lt;= 0) cycle</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;        <span class="comment">! --</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;        <span class="comment">! -- calculate the viscosity associcated with the boundary</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;        viscmaw = calc_bnd_viscosity(n, locvisc, locconc, viscref, dviscdc, &amp;</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                                     cviscref, ctemp, ivisc, a2, a3, a4, &amp;</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                                     packobj%auxvar)</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;        <span class="comment">! -- fill lak relative viscosity into column 1 of viscratios</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;        packobj%viscratios(1, n) = calc_vsc_ratio(viscref, viscmaw)</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;        <span class="comment">! -- fill gwf relative viscosity into column 2 of viscratios</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;        packobj%viscratios(2, n) = calc_vsc_ratio(viscref, visc(node))</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;<span class="keywordflow">    end select</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    <span class="keywordflow">return</span></div>
<div class="ttc" id="anamespacemawmodule_html"><div class="ttname"><a href="namespacemawmodule.html">mawmodule</a></div><div class="ttdef"><b>Definition:</b> <a href="gwf3maw8_8f90_source.html#l00001">gwf3maw8.f90:1</a></div></div>
<div class="ttc" id="astructmawmodule_1_1mawtype_html"><div class="ttname"><a href="structmawmodule_1_1mawtype.html">mawmodule::mawtype</a></div><div class="ttdef"><b>Definition:</b> <a href="gwf3maw8_8f90_source.html#l00043">gwf3maw8.f90:43</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfvscmodule_af4070491a5fac8c9ef18a537d9bff7af_cgraph.png" border="0" usemap="#anamespacegwfvscmodule_af4070491a5fac8c9ef18a537d9bff7af_cgraph" alt=""/></div>
<map name="anamespacegwfvscmodule_af4070491a5fac8c9ef18a537d9bff7af_cgraph" id="anamespacegwfvscmodule_af4070491a5fac8c9ef18a537d9bff7af_cgraph">
<area shape="rect" title="Update maw&#45;related viscosity ratios." alt="" coords="5,46,215,73"/>
<area shape="rect" href="namespacegwfvscmodule.html#a5e8b4072354d11b735667328a8417e98" title="@ brief Calculate the boundary viscosity" alt="" coords="263,5,413,47"/>
<area shape="rect" href="namespacegwfvscmodule.html#a4bfcfd4477ee17446430a763d198634b" title="calculate and return the viscosity ratio" alt="" coords="263,71,413,112"/>
<area shape="rect" href="namespacegwfvscmodule.html#af8db7009f19b86ca75174726d2358001" title=" " alt="" coords="461,13,645,39"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfvscmodule_af4070491a5fac8c9ef18a537d9bff7af_icgraph.png" border="0" usemap="#anamespacegwfvscmodule_af4070491a5fac8c9ef18a537d9bff7af_icgraph" alt=""/></div>
<map name="anamespacegwfvscmodule_af4070491a5fac8c9ef18a537d9bff7af_icgraph" id="anamespacegwfvscmodule_af4070491a5fac8c9ef18a537d9bff7af_icgraph">
<area shape="rect" title="Update maw&#45;related viscosity ratios." alt="" coords="255,5,464,32"/>
<area shape="rect" href="namespacegwfvscmodule.html#ac936522aab940bab0a3a777937950905" title="Advance the boundary packages when viscosity is active." alt="" coords="5,5,207,32"/>
</map>
</div>

</div>
</div>
<a id="aa7423dfe6d14b2ecc499adf4bd9ff259"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7423dfe6d14b2ecc499adf4bd9ff259">&#9670;&nbsp;</a></span>vsc_ad_sfr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfvscmodule::vsc_ad_sfr </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structbndmodule_1_1bndtype.html">bndtype</a>), pointer&#160;</td>
          <td class="paramname"><em>packobj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>visc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>viscref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>elev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>locvisc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>locconc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>dviscdc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>cviscref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>ivisc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>a2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>a3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>a4</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>ctemp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>When the viscosity package is active, update the viscosity ratio that is applied to the hydraulic conductivity specified in the SFR package </p>

<p class="definition">Definition at line <a class="el" href="gwf3vsc8_8f90_source.html#l00568">568</a> of file <a class="el" href="gwf3vsc8_8f90_source.html">gwf3vsc8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacebndmodule.html">bndmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="structbndmodule_1_1bndtype.html">bndtype</a></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacesfrmodule.html">sfrmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="structsfrmodule_1_1sfrtype.html">sfrtype</a></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="keywordtype">class</span>(BndType), <span class="keywordtype">pointer</span> :: packobj</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: viscref</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: a2, a3, a4</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: locvisc</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: locconc</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: ivisc</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: visc</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: elev</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: dviscdc</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: cviscref</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(inout)</span> :: ctemp</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: node</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="keywordtype">    real</span>(DP) :: viscsfr</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="comment">! -------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    <span class="comment">! -- update viscosity ratios for updating hyd. cond (and conductance)</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    <span class="keywordflow">select type</span> (packobj)</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="keywordflow">    type is</span> (<a class="code" href="structsfrmodule_1_1sfrtype.html">sfrtype</a>)</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;      <span class="keywordflow">do</span> n = 1, packobj%nbound</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        <span class="comment">! -- get gwf node number</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        node = packobj%nodelist(n)</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        <span class="comment">! -- Check if boundary cell is active, cycle if not</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        <span class="keywordflow">if</span> (packobj%ibound(node) &lt;= 0) cycle</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;        <span class="comment">! --</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;        <span class="comment">! -- calculate the viscosity associcated with the boundary</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        viscsfr = calc_bnd_viscosity(n, locvisc, locconc, viscref, dviscdc, &amp;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                                     cviscref, ctemp, ivisc, a2, a3, a4, &amp;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                                     packobj%auxvar)</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        <span class="comment">! -- fill sfr relative viscosity into column 1 of viscratios</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        packobj%viscratios(1, n) = calc_vsc_ratio(viscref, viscsfr)</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        <span class="comment">! -- fill gwf relative viscosity into column 2 of viscratios</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        packobj%viscratios(2, n) = calc_vsc_ratio(viscref, visc(node))</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="keywordflow">    end select</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <span class="keywordflow">return</span></div>
<div class="ttc" id="anamespacesfrmodule_html"><div class="ttname"><a href="namespacesfrmodule.html">sfrmodule</a></div><div class="ttdoc">This module contains the SFR package methods.</div><div class="ttdef"><b>Definition:</b> <a href="gwf3sfr8_8f90_source.html#l00007">gwf3sfr8.f90:7</a></div></div>
<div class="ttc" id="astructsfrmodule_1_1sfrtype_html"><div class="ttname"><a href="structsfrmodule_1_1sfrtype.html">sfrmodule::sfrtype</a></div><div class="ttdef"><b>Definition:</b> <a href="gwf3sfr8_8f90_source.html#l00050">gwf3sfr8.f90:50</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfvscmodule_aa7423dfe6d14b2ecc499adf4bd9ff259_cgraph.png" border="0" usemap="#anamespacegwfvscmodule_aa7423dfe6d14b2ecc499adf4bd9ff259_cgraph" alt=""/></div>
<map name="anamespacegwfvscmodule_aa7423dfe6d14b2ecc499adf4bd9ff259_cgraph" id="anamespacegwfvscmodule_aa7423dfe6d14b2ecc499adf4bd9ff259_cgraph">
<area shape="rect" title="Update sfr&#45;related viscosity ratios." alt="" coords="5,46,200,73"/>
<area shape="rect" href="namespacegwfvscmodule.html#a5e8b4072354d11b735667328a8417e98" title="@ brief Calculate the boundary viscosity" alt="" coords="248,5,399,47"/>
<area shape="rect" href="namespacegwfvscmodule.html#a4bfcfd4477ee17446430a763d198634b" title="calculate and return the viscosity ratio" alt="" coords="248,71,399,112"/>
<area shape="rect" href="namespacegwfvscmodule.html#af8db7009f19b86ca75174726d2358001" title=" " alt="" coords="447,13,631,39"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfvscmodule_aa7423dfe6d14b2ecc499adf4bd9ff259_icgraph.png" border="0" usemap="#anamespacegwfvscmodule_aa7423dfe6d14b2ecc499adf4bd9ff259_icgraph" alt=""/></div>
<map name="anamespacegwfvscmodule_aa7423dfe6d14b2ecc499adf4bd9ff259_icgraph" id="anamespacegwfvscmodule_aa7423dfe6d14b2ecc499adf4bd9ff259_icgraph">
<area shape="rect" title="Update sfr&#45;related viscosity ratios." alt="" coords="255,5,449,32"/>
<area shape="rect" href="namespacegwfvscmodule.html#ac936522aab940bab0a3a777937950905" title="Advance the boundary packages when viscosity is active." alt="" coords="5,5,207,32"/>
</map>
</div>

</div>
</div>
<a id="a3e5f71e404ad7000d2873ea98ccccedc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e5f71e404ad7000d2873ea98ccccedc">&#9670;&nbsp;</a></span>vsc_ad_standard_bnd()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfvscmodule::vsc_ad_standard_bnd </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structbndmodule_1_1bndtype.html">bndtype</a>), pointer&#160;</td>
          <td class="paramname"><em>packobj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>hnew</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>visc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>viscref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>locelev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>locvisc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>locconc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>dviscdc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>cviscref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>ivisc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>a2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>a3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>a4</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>ctemp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>When flow enters from ghb boundary type, take into account the effects of viscosity on the user-specified conductance terms </p>

<p class="definition">Definition at line <a class="el" href="gwf3vsc8_8f90_source.html#l00517">517</a> of file <a class="el" href="gwf3vsc8_8f90_source.html">gwf3vsc8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacebndmodule.html">bndmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="structbndmodule_1_1bndtype.html">bndtype</a></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="keywordtype">class</span>(BndType), <span class="keywordtype">pointer</span> :: packobj</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(:)</span> :: hnew</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(:)</span> :: visc</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: a2, a3, a4</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">intent(in)</span> :: viscref</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: locelev</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: locvisc</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: locconc</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: ivisc</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: dviscdc</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: cviscref</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(inout)</span> :: ctemp</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: node</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="keywordtype">    real</span>(DP) :: viscbnd</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="comment">! -------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <span class="comment">! -- Process density terms for each GHB</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <span class="keywordflow">do</span> n = 1, packobj%nbound</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;      node = packobj%nodelist(n)</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;      <span class="comment">! -- Check if boundary cell is active, cycle if not</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;      <span class="keywordflow">if</span> (packobj%ibound(node) &lt;= 0) cycle</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;      <span class="comment">! -- calculate the viscosity associcated with the boundary</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;      viscbnd = calc_bnd_viscosity(n, locvisc, locconc, viscref, dviscdc, &amp;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                                   cviscref, ctemp, ivisc, a2, a3, a4, &amp;</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                                   packobj%auxvar)</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;      <span class="comment">! -- update boundary conductance based on viscosity effects</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;      packobj%bound(2, n) = update_bnd_cond(viscbnd, viscref, &amp;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                                            packobj%condinput(n))</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfvscmodule_a3e5f71e404ad7000d2873ea98ccccedc_cgraph.png" border="0" usemap="#anamespacegwfvscmodule_a3e5f71e404ad7000d2873ea98ccccedc_cgraph" alt=""/></div>
<map name="anamespacegwfvscmodule_a3e5f71e404ad7000d2873ea98ccccedc_cgraph" id="anamespacegwfvscmodule_a3e5f71e404ad7000d2873ea98ccccedc_cgraph">
<area shape="rect" title="advance ghb while accounting for viscosity" alt="" coords="5,39,176,80"/>
<area shape="rect" href="namespacegwfvscmodule.html#a5e8b4072354d11b735667328a8417e98" title="@ brief Calculate the boundary viscosity" alt="" coords="234,5,385,47"/>
<area shape="rect" href="namespacegwfvscmodule.html#a60546a198d138f74fb1224edcdbfeb10" title="Apply viscosity to the conductance term." alt="" coords="224,71,395,112"/>
<area shape="rect" href="namespacegwfvscmodule.html#af8db7009f19b86ca75174726d2358001" title=" " alt="" coords="443,13,627,39"/>
<area shape="rect" href="namespacegwfvscmodule.html#a4bfcfd4477ee17446430a763d198634b" title="calculate and return the viscosity ratio" alt="" coords="459,71,610,112"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfvscmodule_a3e5f71e404ad7000d2873ea98ccccedc_icgraph.png" border="0" usemap="#anamespacegwfvscmodule_a3e5f71e404ad7000d2873ea98ccccedc_icgraph" alt=""/></div>
<map name="anamespacegwfvscmodule_a3e5f71e404ad7000d2873ea98ccccedc_icgraph" id="anamespacegwfvscmodule_a3e5f71e404ad7000d2873ea98ccccedc_icgraph">
<area shape="rect" title="advance ghb while accounting for viscosity" alt="" coords="255,5,425,47"/>
<area shape="rect" href="namespacegwfvscmodule.html#ac936522aab940bab0a3a777937950905" title="Advance the boundary packages when viscosity is active." alt="" coords="5,13,207,39"/>
</map>
</div>

</div>
</div>
<a id="aacf466247c12fc23a1e504b7242ecf81"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aacf466247c12fc23a1e504b7242ecf81">&#9670;&nbsp;</a></span>vsc_ar()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfvscmodule::vsc_ar </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfvscmodule_1_1gwfvsctype.html">gwfvsctype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), dimension(:), pointer&#160;</td>
          <td class="paramname"><em>ibound</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Generic method to allocate and read static data for the viscosity package available within the GWF model type. </p>

<p class="definition">Definition at line <a class="el" href="gwf3vsc8_8f90_source.html#l00235">235</a> of file <a class="el" href="gwf3vsc8_8f90_source.html">gwf3vsc8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="keywordtype">class</span>(GwfVscType) :: this</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">pointer</span> :: ibound</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="comment">! -- formats</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">! ------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="comment">! -- store pointers to arguments that were passed in</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    this%ibound =&gt; ibound</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="comment">! -- Set pointers to npf variables</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="keyword">call </span>this%set_npf_pointers()</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a701ebbb47ddf624dfff88d0a85dfa651"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a701ebbb47ddf624dfff88d0a85dfa651">&#9670;&nbsp;</a></span>vsc_ar_bnd()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfvscmodule::vsc_ar_bnd </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfvscmodule_1_1gwfvsctype.html">gwfvsctype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(<a class="el" href="structbndmodule_1_1bndtype.html">bndtype</a>), pointer&#160;</td>
          <td class="paramname"><em>packobj</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Viscosity ar_bnd rountine to activate viscosity in the advanced packages. This routine is called from <a class="el" href="namespacegwfmodule.html#aba063161cc9e105dab30ab57967bf5e6" title="GroundWater Flow Model Allocate and Read.">gwf_ar()</a> as it moves through each package </p>

<p class="definition">Definition at line <a class="el" href="gwf3vsc8_8f90_source.html#l00261">261</a> of file <a class="el" href="gwf3vsc8_8f90_source.html">gwf3vsc8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacebndmodule.html">bndmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="structbndmodule_1_1bndtype.html">bndtype</a></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacedrnmodule.html">drnmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="structdrnmodule_1_1drntype.html">drntype</a></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceghbmodule.html">ghbmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="structghbmodule_1_1ghbtype.html">ghbtype</a></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacerivmodule.html">rivmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="structrivmodule_1_1rivtype.html">rivtype</a></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacelakmodule.html">lakmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="structlakmodule_1_1laktype.html">laktype</a></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacesfrmodule.html">sfrmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="structsfrmodule_1_1sfrtype.html">sfrtype</a></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacemawmodule.html">mawmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="structmawmodule_1_1mawtype.html">mawtype</a></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="keywordtype">class</span>(GwfVscType) :: this</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="keywordtype">class</span>(BndType), <span class="keywordtype">pointer</span> :: packobj</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="comment">! ----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="comment">! -- Add density terms based on boundary package type</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="keywordflow">select case</span> (packobj%filtyp)</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keywordflow">case</span> (<span class="stringliteral">&#39;DRN&#39;</span>)</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      <span class="comment">! -- activate viscosity for the drain package</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      <span class="keywordflow">select type</span> (packobj)</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="keywordflow">      type is</span> (<a class="code" href="structdrnmodule_1_1drntype.html">drntype</a>)</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        <span class="keyword">call </span>packobj%bnd_activate_viscosity()</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="keywordflow">      end select</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keywordflow">case</span> (<span class="stringliteral">&#39;GHB&#39;</span>)</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;      <span class="comment">! -- activate viscosity for the drain package</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;      <span class="keywordflow">select type</span> (packobj)</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="keywordflow">      type is</span> (<a class="code" href="structghbmodule_1_1ghbtype.html">ghbtype</a>)</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        <span class="keyword">call </span>packobj%bnd_activate_viscosity()</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="keywordflow">      end select</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keywordflow">case</span> (<span class="stringliteral">&#39;RIV&#39;</span>)</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      <span class="comment">! -- activate viscosity for the drain package</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      <span class="keywordflow">select type</span> (packobj)</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="keywordflow">      type is</span> (<a class="code" href="structrivmodule_1_1rivtype.html">rivtype</a>)</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        <span class="keyword">call </span>packobj%bnd_activate_viscosity()</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="keywordflow">      end select</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="keywordflow">case</span> (<span class="stringliteral">&#39;LAK&#39;</span>)</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      <span class="comment">! -- activate viscosity for lake package</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      <span class="keywordflow">select type</span> (packobj)</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="keywordflow">      type is</span> (<a class="code" href="structlakmodule_1_1laktype.html">laktype</a>)</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        <span class="keyword">call </span>packobj%lak_activate_viscosity()</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="keywordflow">      end select</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160; </div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="keywordflow">case</span> (<span class="stringliteral">&#39;SFR&#39;</span>)</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      <span class="comment">! -- activate viscosity for sfr package</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      <span class="keywordflow">select type</span> (packobj)</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="keywordflow">      type is</span> (<a class="code" href="structsfrmodule_1_1sfrtype.html">sfrtype</a>)</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        <span class="keyword">call </span>packobj%sfr_activate_viscosity()</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="keywordflow">      end select</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160; </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="keywordflow">case</span> (<span class="stringliteral">&#39;MAW&#39;</span>)</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;      <span class="comment">! -- activate viscosity for maw package</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      <span class="keywordflow">select type</span> (packobj)</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="keywordflow">      type is</span> (<a class="code" href="structmawmodule_1_1mawtype.html">mawtype</a>)</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        <span class="keyword">call </span>packobj%maw_activate_viscosity()</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="keywordflow">      end select</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160; </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="keywordflow">    case default</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;      <span class="comment">! -- nothing</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="keywordflow">    end select</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="keywordflow">return</span></div>
<div class="ttc" id="anamespacedrnmodule_html"><div class="ttname"><a href="namespacedrnmodule.html">drnmodule</a></div><div class="ttdef"><b>Definition:</b> <a href="gwf3drn8_8f90_source.html#l00001">gwf3drn8.f90:1</a></div></div>
<div class="ttc" id="anamespaceghbmodule_html"><div class="ttname"><a href="namespaceghbmodule.html">ghbmodule</a></div><div class="ttdef"><b>Definition:</b> <a href="gwf3ghb8_8f90_source.html#l00001">gwf3ghb8.f90:1</a></div></div>
<div class="ttc" id="anamespacerivmodule_html"><div class="ttname"><a href="namespacerivmodule.html">rivmodule</a></div><div class="ttdef"><b>Definition:</b> <a href="gwf3riv8_8f90_source.html#l00001">gwf3riv8.f90:1</a></div></div>
<div class="ttc" id="astructdrnmodule_1_1drntype_html"><div class="ttname"><a href="structdrnmodule_1_1drntype.html">drnmodule::drntype</a></div><div class="ttdef"><b>Definition:</b> <a href="gwf3drn8_8f90_source.html#l00022">gwf3drn8.f90:22</a></div></div>
<div class="ttc" id="astructghbmodule_1_1ghbtype_html"><div class="ttname"><a href="structghbmodule_1_1ghbtype.html">ghbmodule::ghbtype</a></div><div class="ttdef"><b>Definition:</b> <a href="gwf3ghb8_8f90_source.html#l00019">gwf3ghb8.f90:19</a></div></div>
<div class="ttc" id="astructrivmodule_1_1rivtype_html"><div class="ttname"><a href="structrivmodule_1_1rivtype.html">rivmodule::rivtype</a></div><div class="ttdef"><b>Definition:</b> <a href="gwf3riv8_8f90_source.html#l00019">gwf3riv8.f90:19</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4ff0f551bca1a547401b8a152a01f042"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ff0f551bca1a547401b8a152a01f042">&#9670;&nbsp;</a></span>vsc_calcvisc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfvscmodule::vsc_calcvisc </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfvscmodule_1_1gwfvsctype.html">gwfvsctype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Calculates fluid viscosity based on concentration or temperature </p>

<p class="definition">Definition at line <a class="el" href="gwf3vsc8_8f90_source.html#l01221">1221</a> of file <a class="el" href="gwf3vsc8_8f90_source.html">gwf3vsc8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;    <span class="keywordtype">class</span>(GwfVscType) :: this</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160; </div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: i</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;<span class="comment">! ------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;    <span class="comment">! -- Calculate the viscosity using the specified concentration and/or</span></div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;    <span class="comment">!    temperature arrays</span></div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;    <span class="keywordflow">do</span> n = 1, this%dis%nodes</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;      <span class="keywordflow">do</span> i = 1, this%nviscspecies</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;        <span class="keywordflow">if</span> (this%modelconc(i)%icbund(n) == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;          this%ctemp = dzero</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;          this%ctemp(i) = this%modelconc(i)%conc(n)</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;      this%visc(n) = calc_visc(this%ivisc, this%viscref, this%dviscdc, &amp;</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;                               this%cviscref, this%ctemp, this%a2, &amp;</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;                               this%a3, this%a4)</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfvscmodule_a4ff0f551bca1a547401b8a152a01f042_cgraph.png" border="0" usemap="#anamespacegwfvscmodule_a4ff0f551bca1a547401b8a152a01f042_cgraph" alt=""/></div>
<map name="anamespacegwfvscmodule_a4ff0f551bca1a547401b8a152a01f042_cgraph" id="anamespacegwfvscmodule_a4ff0f551bca1a547401b8a152a01f042_cgraph">
<area shape="rect" title="Calculate fluid viscosity." alt="" coords="5,5,212,32"/>
<area shape="rect" href="namespacegwfvscmodule.html#af8db7009f19b86ca75174726d2358001" title=" " alt="" coords="260,5,444,32"/>
</map>
</div>

</div>
</div>
<a id="a49dbcbea3bf6fa2bf163418f83c24558"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a49dbcbea3bf6fa2bf163418f83c24558">&#9670;&nbsp;</a></span>vsc_cr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public gwfvscmodule::vsc_cr </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structgwfvscmodule_1_1gwfvsctype.html">gwfvsctype</a>), pointer&#160;</td>
          <td class="paramname"><em>vscobj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>name_model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>inunit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>iout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create a new VSC Package object. </p>

<p class="definition">Definition at line <a class="el" href="gwf3vsc8_8f90_source.html#l00148">148</a> of file <a class="el" href="gwf3vsc8_8f90_source.html">gwf3vsc8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keywordtype">type</span>(GwfVscType), <span class="keywordtype">pointer</span> :: vscobj</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: name_model</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: inunit</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: iout</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">! ------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="comment">! -- Create the object</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="keyword">allocate</span> (vscobj)</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="comment">! -- create name and memory path</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="keyword">call </span>vscobj%set_names(1, name_model, <span class="stringliteral">&#39;VSC&#39;</span>, <span class="stringliteral">&#39;VSC&#39;</span>)</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="comment">! -- Allocate scalars</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="keyword">call </span>vscobj%allocate_scalars()</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="comment">! -- Set variables</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    vscobj%inunit = inunit</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    vscobj%iout = iout</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="comment">! -- Initialize block parser</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keyword">call </span>vscobj%parser%Initialize(vscobj%inunit, vscobj%iout)</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfvscmodule_a49dbcbea3bf6fa2bf163418f83c24558_icgraph.png" border="0" usemap="#anamespacegwfvscmodule_a49dbcbea3bf6fa2bf163418f83c24558_icgraph" alt=""/></div>
<map name="anamespacegwfvscmodule_a49dbcbea3bf6fa2bf163418f83c24558_icgraph" id="anamespacegwfvscmodule_a49dbcbea3bf6fa2bf163418f83c24558_icgraph">
<area shape="rect" title="@ brief Create a new package object" alt="" coords="1492,31,1659,57"/>
<area shape="rect" href="namespacegwfmodule.html#a0cb07c0232ce3627b9120eb42e7e164f" title="Create a new groundwater flow model object." alt="" coords="1297,31,1444,57"/>
<area shape="rect" href="namespacesimulationcreatemodule.html#a0043d2fa8d8b96e41e5e0fdfecaadae7" title="Set the models to be used for the simulation." alt="" coords="1068,23,1249,65"/>
<area shape="rect" href="namespacesimulationcreatemodule.html#a7d37a8b63b2b0874f875f45b6cf93f03" title="Read the simulation name file." alt="" coords="821,23,1020,65"/>
<area shape="rect" href="namespacesimulationcreatemodule.html#afcbe0fd3c140a3ba4f0a5409e5dc8781" title="Read the simulation name file and initialize the models, exchanges." alt="" coords="592,23,773,65"/>
<area shape="rect" href="namespacemf6coremodule.html#aa847da5116e01f4fad8885b0c4f96757" title="Initialize a simulation." alt="" coords="329,31,544,57"/>
<area shape="rect" href="namespacemf6bmi.html#aa886df822e4ea66c30a97a9060da5de8" title="Initialize the computational core." alt="" coords="107,5,276,32"/>
<area shape="rect" href="namespacemf6coremodule.html#a207819c711610066af1b83ec2a8efef0" title="Main controller." alt="" coords="101,56,281,83"/>
<area shape="rect" href="mf6_8f90.html#aa95bf577752f92b917375902bbb13863" title="MODFLOW 6 main entry point." alt="" coords="5,56,53,83"/>
</map>
</div>

</div>
</div>
<a id="a10527ea8afdd4162f7c51fed09df34e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a10527ea8afdd4162f7c51fed09df34e1">&#9670;&nbsp;</a></span>vsc_da()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfvscmodule::vsc_da </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfvscmodule_1_1gwfvsctype.html">gwfvsctype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Deallocate viscosity package scalars and arrays. </p>

<p class="definition">Definition at line <a class="el" href="gwf3vsc8_8f90_source.html#l00986">986</a> of file <a class="el" href="gwf3vsc8_8f90_source.html">gwf3vsc8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    <span class="keywordtype">class</span>(GwfVscType) :: this</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;<span class="comment">! ------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    <span class="comment">! -- Deallocate arrays if package was active</span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    <span class="keywordflow">if</span> (this%inunit &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;      <span class="keyword">call </span>mem_deallocate(this%visc)</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;      <span class="keyword">call </span>mem_deallocate(this%ivisc)</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;      <span class="keyword">call </span>mem_deallocate(this%dviscdc)</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;      <span class="keyword">call </span>mem_deallocate(this%cviscref)</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;      <span class="keyword">call </span>mem_deallocate(this%ctemp)</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;      <span class="keyword">deallocate</span> (this%cmodelname)</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;      <span class="keyword">deallocate</span> (this%cauxspeciesname)</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;      <span class="keyword">deallocate</span> (this%modelconc)</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    <span class="comment">! -- Scalars</span></div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    <span class="keyword">call </span>mem_deallocate(this%thermivisc)</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;    <span class="keyword">call </span>mem_deallocate(this%idxtmpr)</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;    <span class="keyword">call </span>mem_deallocate(this%ioutvisc)</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;    <span class="keyword">call </span>mem_deallocate(this%ireadelev)</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    <span class="keyword">call </span>mem_deallocate(this%iconcset)</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    <span class="keyword">call </span>mem_deallocate(this%viscref)</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;    <span class="keyword">call </span>mem_deallocate(this%nviscspecies)</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;    <span class="keyword">call </span>mem_deallocate(this%a2)</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    <span class="keyword">call </span>mem_deallocate(this%a3)</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    <span class="keyword">call </span>mem_deallocate(this%a4)</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    <span class="comment">! -- Nullify pointers to other package variables</span></div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    <span class="keyword">nullify</span> (this%k11)</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    <span class="keyword">nullify</span> (this%k22)</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    <span class="keyword">nullify</span> (this%k33)</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    <span class="keyword">nullify</span> (this%k11input)</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;    <span class="keyword">nullify</span> (this%k22input)</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    <span class="keyword">nullify</span> (this%k33input)</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    <span class="keyword">nullify</span> (this%kchangeper)</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    <span class="keyword">nullify</span> (this%kchangestp)</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    <span class="keyword">nullify</span> (this%nodekchange)</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;    <span class="comment">! -- deallocate parent</span></div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    <span class="keyword">call </span>this%NumericalPackageType%da()</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9ff1e8f540d4e8cc11373a2b9019bc4b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ff1e8f540d4e8cc11373a2b9019bc4b">&#9670;&nbsp;</a></span>vsc_df()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfvscmodule::vsc_df </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfvscmodule_1_1gwfvsctype.html">gwfvsctype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(<a class="el" href="structbasedismodule_1_1disbasetype.html">disbasetype</a>), intent(in), pointer&#160;</td>
          <td class="paramname"><em>dis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structgwfvscinputdatamodule_1_1gwfvscinputdatatype.html">gwfvscinputdatatype</a>), intent(in), optional&#160;</td>
          <td class="paramname"><em>vsc_input</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Define viscosity package options and dimensions </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>this viscosity package </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dis</td><td>pointer to discretization </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">vsc_input</td><td>optional vsc input data, otherwise read from file </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gwf3vsc8_8f90_source.html#l00181">181</a> of file <a class="el" href="gwf3vsc8_8f90_source.html">gwf3vsc8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keywordtype">class</span>(GwfVscType) :: this<span class="comment"> !&lt; this viscosity package</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keywordtype">class</span>(DisBaseType), <span class="keywordtype">pointer</span>, <span class="keywordtype">intent(in)</span> :: dis<span class="comment"> !&lt; pointer to discretization</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="keywordtype">type</span>(GwfVscInputDataType), <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: vsc_input<span class="comment"> !&lt; optional vsc input data, otherwise read from file</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="comment">! -- formats</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">parameter</span> :: fmtvsc = &amp;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      <span class="stringliteral">&quot;(1x,/1x,&#39;VSC -- Viscosity Package, version 1, 11/15/2022&#39;, &amp;</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="stringliteral"></span><span class="stringliteral">      &amp;&#39; input read from unit &#39;, i0, //)&quot;</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">! ------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="comment">! --print a message identifying the viscosity package</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keyword">write</span> (this%iout, fmtvsc) this%inunit</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="comment">! -- store pointers to arguments that were passed in</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    this%dis =&gt; dis</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160; </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordflow">if</span> (.not. <span class="keyword">present</span>(vsc_input)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      <span class="comment">! -- Read viscosity options</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      <span class="keyword">call </span>this%read_options()</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      <span class="comment">! -- Read viscosity dimensions</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      <span class="keyword">call </span>this%read_dimensions()</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      <span class="comment">! set from input data instead</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      <span class="keyword">call </span>this%set_options(vsc_input)</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      this%nviscspecies = vsc_input%nviscspecies</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="comment">! -- Allocate arrays</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="keyword">call </span>this%allocate_arrays(dis%nodes)</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160; </div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="keywordflow">if</span> (.not. <span class="keyword">present</span>(vsc_input)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;      <span class="comment">! -- Read viscosity packagedata</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      <span class="keyword">call </span>this%read_packagedata()</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;      <span class="comment">! set from input data instead</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      <span class="keyword">call </span>this%set_packagedata(vsc_input)</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5a697cdfdb547b390db3f442ba411068"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a697cdfdb547b390db3f442ba411068">&#9670;&nbsp;</a></span>vsc_ot_dv()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfvscmodule::vsc_ot_dv </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfvscmodule_1_1gwfvsctype.html">gwfvsctype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>idvfl</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Save calculated viscosity array to binary file </p>

<p class="definition">Definition at line <a class="el" href="gwf3vsc8_8f90_source.html#l00942">942</a> of file <a class="el" href="gwf3vsc8_8f90_source.html">gwf3vsc8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    <span class="keywordtype">class</span>(GwfVscType) :: this</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: idvfl</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    <span class="keywordtype">character(len=1)</span> :: cdatafmp = <span class="stringliteral">&#39; &#39;</span>, editdesc = <span class="stringliteral">&#39; &#39;</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ibinun</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: iprint</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: nvaluesp</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: nwidthp</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;<span class="keywordtype">    real</span>(DP) :: dinact</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;<span class="comment">! ------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    <span class="comment">! -- Set unit number for viscosity output</span></div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    <span class="keywordflow">if</span> (this%ioutvisc /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;      ibinun = 1</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;      ibinun = 0</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    <span class="keywordflow">if</span> (idvfl == 0) ibinun = 0</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    <span class="comment">! -- save viscosity array</span></div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    <span class="keywordflow">if</span> (ibinun /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;      iprint = 0</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;      dinact = dhnoflo</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;      <span class="comment">! -- write viscosity to binary file</span></div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;      <span class="keywordflow">if</span> (this%ioutvisc /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;        ibinun = this%ioutvisc</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;        <span class="keyword">call </span>this%dis%record_array(this%visc, this%iout, iprint, ibinun, &amp;</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;                                   <span class="stringliteral">&#39;         VISCOSITY&#39;</span>, cdatafmp, nvaluesp, &amp;</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;                                   nwidthp, editdesc, dinact)</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="abb2789ca0ad59b20766ce18635360c6c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb2789ca0ad59b20766ce18635360c6c">&#9670;&nbsp;</a></span>vsc_rp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfvscmodule::vsc_rp </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfvscmodule_1_1gwfvsctype.html">gwfvsctype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method to read and prepare period data for the VSC package. </p>

<p class="definition">Definition at line <a class="el" href="gwf3vsc8_8f90_source.html#l00365">365</a> of file <a class="el" href="gwf3vsc8_8f90_source.html">gwf3vsc8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacetdismodule.html">tdismodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacetdismodule.html#ad3443c7d7da2a67a75174c39c6d40c84">kstp</a>, <a class="code" href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">kper</a></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="keywordtype">class</span>(GwfVscType) :: this</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <span class="keywordtype">character(len=LINELENGTH)</span> :: errmsg</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: i</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="comment">! -- formats</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">parameter</span> :: fmtc = &amp;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      <span class="stringliteral">&quot;(&#39;Viscosity Package does not have a concentration set &amp;</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="stringliteral"></span><span class="stringliteral">       &amp;for species &#39;,i0,&#39;. One or more model names may be specified &amp;</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="stringliteral"></span><span class="stringliteral">       &amp;incorrectly in the PACKAGEDATA block or a GWF-GWT exchange may need &amp;</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="stringliteral"></span><span class="stringliteral">       &amp;to be activated.&#39;)&quot;</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment">! ------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="comment">! -- Check to make sure all concentration pointers have been set</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacetdismodule.html#ad3443c7d7da2a67a75174c39c6d40c84">kstp</a> * <a class="code" href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">kper</a> == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      <span class="keywordflow">do</span> i = 1, this%nviscspecies</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        <span class="keywordflow">if</span> (.not. <span class="keyword">associated</span>(this%modelconc(i)%conc)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;          <span class="keyword">write</span> (errmsg, fmtc) i</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;          <span class="keyword">call </span>store_error(errmsg)</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      <span class="keywordflow">if</span> (count_errors() &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        <span class="keyword">call </span>this%parser%StoreErrorUnit()</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="keywordflow">return</span></div>
<div class="ttc" id="anamespacetdismodule_html"><div class="ttname"><a href="namespacetdismodule.html">tdismodule</a></div><div class="ttdef"><b>Definition:</b> <a href="tdis_8f90_source.html#l00005">tdis.f90:5</a></div></div>
<div class="ttc" id="anamespacetdismodule_html_ad3443c7d7da2a67a75174c39c6d40c84"><div class="ttname"><a href="namespacetdismodule.html#ad3443c7d7da2a67a75174c39c6d40c84">tdismodule::kstp</a></div><div class="ttdeci">integer(i4b), pointer, public kstp</div><div class="ttdoc">current time step number</div><div class="ttdef"><b>Definition:</b> <a href="tdis_8f90_source.html#l00025">tdis.f90:25</a></div></div>
<div class="ttc" id="anamespacetdismodule_html_ae84d6ee69d7bba12d20a6255a398935b"><div class="ttname"><a href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">tdismodule::kper</a></div><div class="ttdeci">integer(i4b), pointer, public kper</div><div class="ttdoc">current stress period number</div><div class="ttdef"><b>Definition:</b> <a href="tdis_8f90_source.html#l00024">tdis.f90:24</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfvscmodule_abb2789ca0ad59b20766ce18635360c6c_cgraph.png" border="0" usemap="#anamespacegwfvscmodule_abb2789ca0ad59b20766ce18635360c6c_cgraph" alt=""/></div>
<map name="anamespacegwfvscmodule_abb2789ca0ad59b20766ce18635360c6c_cgraph" id="anamespacegwfvscmodule_abb2789ca0ad59b20766ce18635360c6c_cgraph">
<area shape="rect" title="@ brief Read new period data in viscosity package" alt="" coords="5,43,172,69"/>
<area shape="rect" href="namespacesimmodule.html#a4c46e49de78d4498dd4ec106357775e6" title="Return number of errors." alt="" coords="220,17,404,44"/>
<area shape="rect" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e" title="Store error message." alt="" coords="225,68,399,95"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="452,68,591,95"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="639,27,807,69"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title="Subroutine to stop the program." alt="" coords="639,93,807,134"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="855,5,1049,32"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title="Write simulation message." alt="" coords="868,57,1036,98"/>
</map>
</div>

</div>
</div>
<a id="a33c542887fbcf5b0816c293372dc66ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a33c542887fbcf5b0816c293372dc66ea">&#9670;&nbsp;</a></span>vsc_set_changed_at()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfvscmodule::vsc_set_changed_at </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfvscmodule_1_1gwfvsctype.html">gwfvsctype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>kper</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>kstp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Procedure called by VSC code when K updated due to viscosity changes. K values changed at (kper, kstp). </p>

<p class="definition">Definition at line <a class="el" href="gwf3vsc8_8f90_source.html#l00925">925</a> of file <a class="el" href="gwf3vsc8_8f90_source.html">gwf3vsc8.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    <span class="keywordtype">class</span>(GwfVscType) :: this</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: kper</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: kstp</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    this%kchangeper = kper</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    this%kchangestp = kstp</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacegwfvscmodule.html">gwfvscmodule</a></li>
    <li class="footer">Generated on Mon Dec 19 2022 20:08:37 for MODFLOW 6 by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
