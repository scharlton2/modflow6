<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MODFLOW 6: spatialmodelconnectionmodule Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="mf6-triangular-grid.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MODFLOW 6
   &#160;<span id="projectnumber">version 6.4.0</span>
   </div>
   <div id="projectbrief">MODFLOW 6 Code Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="namespaces.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="namespaces.html"><span>Modules&#160;List</span></a></li>
      <li><a href="namespacemembers.html"><span>Module&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('namespacespatialmodelconnectionmodule.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Types</a> &#124;
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">spatialmodelconnectionmodule Module Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Types</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">type &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structspatialmodelconnectionmodule_1_1spatialmodelconnectiontype.html">spatialmodelconnectiontype</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Class to manage spatial connection of a model to one or more models of the same type. Spatial connection here means that the model domains (spatial discretization) are adjacent and connected via DisConnExchangeType object(s). The connection itself is a Numerical Exchange as well, and part of a Numerical Solution providing the amat and rhs.  <a href="structspatialmodelconnectionmodule_1_1spatialmodelconnectiontype.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a76507ae198dd17cba071ffdbeb4d801e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacespatialmodelconnectionmodule.html#a76507ae198dd17cba071ffdbeb4d801e">spatialconnection_ctor</a> (this, model, exchange, name)</td></tr>
<tr class="memdesc:a76507ae198dd17cba071ffdbeb4d801e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct the spatial connection base.  <a href="namespacespatialmodelconnectionmodule.html#a76507ae198dd17cba071ffdbeb4d801e">More...</a><br /></td></tr>
<tr class="separator:a76507ae198dd17cba071ffdbeb4d801e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33bf848774c4a590db0f35095e21f84d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacespatialmodelconnectionmodule.html#a33bf848774c4a590db0f35095e21f84d">spatialcon_df</a> (this)</td></tr>
<tr class="memdesc:a33bf848774c4a590db0f35095e21f84d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Define this connection, mostly sets up the grid.  <a href="namespacespatialmodelconnectionmodule.html#a33bf848774c4a590db0f35095e21f84d">More...</a><br /></td></tr>
<tr class="separator:a33bf848774c4a590db0f35095e21f84d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afce8ea9e92b18b6ea282c8ae1fc6c4f7"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacespatialmodelconnectionmodule.html#afce8ea9e92b18b6ea282c8ae1fc6c4f7">spatialcon_ar</a> (this)</td></tr>
<tr class="memdesc:afce8ea9e92b18b6ea282c8ae1fc6c4f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate the connection,.  <a href="namespacespatialmodelconnectionmodule.html#afce8ea9e92b18b6ea282c8ae1fc6c4f7">More...</a><br /></td></tr>
<tr class="separator:afce8ea9e92b18b6ea282c8ae1fc6c4f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59c0b64c1ea956b6a3663b52ac18465b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacespatialmodelconnectionmodule.html#a59c0b64c1ea956b6a3663b52ac18465b">spatialcon_setmodelptrs</a> (this)</td></tr>
<tr class="memdesc:a59c0b64c1ea956b6a3663b52ac18465b"><td class="mdescLeft">&#160;</td><td class="mdescRight">set model pointers to connection  <a href="namespacespatialmodelconnectionmodule.html#a59c0b64c1ea956b6a3663b52ac18465b">More...</a><br /></td></tr>
<tr class="separator:a59c0b64c1ea956b6a3663b52ac18465b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b24a013bff5f6865ad9bccf37d713d4"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacespatialmodelconnectionmodule.html#a1b24a013bff5f6865ad9bccf37d713d4">spatialcon_connect</a> (this)</td></tr>
<tr class="memdesc:a1b24a013bff5f6865ad9bccf37d713d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">map interface model connections to our sparse matrix,  <a href="namespacespatialmodelconnectionmodule.html#a1b24a013bff5f6865ad9bccf37d713d4">More...</a><br /></td></tr>
<tr class="separator:a1b24a013bff5f6865ad9bccf37d713d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec90536f741cddef194442f90e8d7aa7"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacespatialmodelconnectionmodule.html#aec90536f741cddef194442f90e8d7aa7">maskownerconnections</a> (this)</td></tr>
<tr class="memdesc:aec90536f741cddef194442f90e8d7aa7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mask the owner's connections.  <a href="namespacespatialmodelconnectionmodule.html#aec90536f741cddef194442f90e8d7aa7">More...</a><br /></td></tr>
<tr class="separator:aec90536f741cddef194442f90e8d7aa7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace61fc3d934039f47a0eff6f420c235b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacespatialmodelconnectionmodule.html#ace61fc3d934039f47a0eff6f420c235b">createcoefficientmatrix</a> (this, sparse)</td></tr>
<tr class="memdesc:ace61fc3d934039f47a0eff6f420c235b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add connections, handled by the interface model,.  <a href="namespacespatialmodelconnectionmodule.html#ace61fc3d934039f47a0eff6f420c235b">More...</a><br /></td></tr>
<tr class="separator:ace61fc3d934039f47a0eff6f420c235b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0574292d636407e09dae880717f67331"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacespatialmodelconnectionmodule.html#a0574292d636407e09dae880717f67331">validateconnection</a> (this)</td></tr>
<tr class="memdesc:a0574292d636407e09dae880717f67331"><td class="mdescLeft">&#160;</td><td class="mdescRight">Validate this connection.  <a href="namespacespatialmodelconnectionmodule.html#a0574292d636407e09dae880717f67331">More...</a><br /></td></tr>
<tr class="separator:a0574292d636407e09dae880717f67331"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef271cf59d66fe8e5baef704109028fc"><td class="memItemLeft" align="right" valign="top">class(<a class="el" href="structspatialmodelconnectionmodule_1_1spatialmodelconnectiontype.html">spatialmodelconnectiontype</a>) function, pointer, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacespatialmodelconnectionmodule.html#aef271cf59d66fe8e5baef704109028fc">castasspatialmodelconnectionclass</a> (obj)</td></tr>
<tr class="memdesc:aef271cf59d66fe8e5baef704109028fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cast to SpatialModelConnectionType.  <a href="namespacespatialmodelconnectionmodule.html#aef271cf59d66fe8e5baef704109028fc">More...</a><br /></td></tr>
<tr class="separator:aef271cf59d66fe8e5baef704109028fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a141064bc892a55a9bd63d64cdf575bbe"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacespatialmodelconnectionmodule.html#a141064bc892a55a9bd63d64cdf575bbe">addspatialmodelconnectiontolist</a> (list, conn)</td></tr>
<tr class="memdesc:a141064bc892a55a9bd63d64cdf575bbe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add connection to a list.  <a href="namespacespatialmodelconnectionmodule.html#a141064bc892a55a9bd63d64cdf575bbe">More...</a><br /></td></tr>
<tr class="separator:a141064bc892a55a9bd63d64cdf575bbe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab03c81ae159b53ae92e07d83d48cca29"><td class="memItemLeft" align="right" valign="top">class(<a class="el" href="structspatialmodelconnectionmodule_1_1spatialmodelconnectiontype.html">spatialmodelconnectiontype</a>) function, pointer, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacespatialmodelconnectionmodule.html#ab03c81ae159b53ae92e07d83d48cca29">getspatialmodelconnectionfromlist</a> (list, idx)</td></tr>
<tr class="memdesc:ab03c81ae159b53ae92e07d83d48cca29"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the connection from a list.  <a href="namespacespatialmodelconnectionmodule.html#ab03c81ae159b53ae92e07d83d48cca29">More...</a><br /></td></tr>
<tr class="separator:ab03c81ae159b53ae92e07d83d48cca29"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a141064bc892a55a9bd63d64cdf575bbe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a141064bc892a55a9bd63d64cdf575bbe">&#9670;&nbsp;</a></span>addspatialmodelconnectiontolist()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public spatialmodelconnectionmodule::addspatialmodelconnectiontolist </td>
          <td>(</td>
          <td class="paramtype">type(listtype), intent(inout)&#160;</td>
          <td class="paramname"><em>list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(<a class="el" href="structspatialmodelconnectionmodule_1_1spatialmodelconnectiontype.html">spatialmodelconnectiontype</a>), intent(in), pointer&#160;</td>
          <td class="paramname"><em>conn</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">list</td><td>the list </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">conn</td><td>the connection </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_spatial_model_connection_8f90_source.html#l00512">512</a> of file <a class="el" href="_spatial_model_connection_8f90_source.html">SpatialModelConnection.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="keywordtype">type</span>(ListType), <span class="keywordtype">intent(inout)</span> :: list<span class="comment">                           !&lt; the list</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <span class="keywordtype">class</span>(SpatialModelConnectionType), <span class="keywordtype">pointer</span>, <span class="keywordtype">intent(in)</span> :: conn<span class="comment">  !&lt; the connection</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <span class="keywordtype">class</span>(*), <span class="keywordtype">pointer</span> :: obj</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    obj =&gt; conn</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="keyword">call </span>list%Add(obj)</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacespatialmodelconnectionmodule_a141064bc892a55a9bd63d64cdf575bbe_icgraph.png" border="0" usemap="#namespacespatialmodelconnectionmodule_a141064bc892a55a9bd63d64cdf575bbe_icgraph" alt=""/></div>
<map name="namespacespatialmodelconnectionmodule_a141064bc892a55a9bd63d64cdf575bbe_icgraph" id="namespacespatialmodelconnectionmodule_a141064bc892a55a9bd63d64cdf575bbe_icgraph">
<area shape="rect" title="Add connection to a list." alt="" coords="240,5,483,47"/>
<area shape="rect" href="namespaceconnectionbuildermodule.html#aef408e9381f69a203549fc5e8a355041" title="Create connections from exchanges." alt="" coords="5,5,192,47"/>
</map>
</div>

</div>
</div>
<a id="aef271cf59d66fe8e5baef704109028fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef271cf59d66fe8e5baef704109028fc">&#9670;&nbsp;</a></span>castasspatialmodelconnectionclass()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">class(<a class="el" href="structspatialmodelconnectionmodule_1_1spatialmodelconnectiontype.html">spatialmodelconnectiontype</a>) function, pointer, public spatialmodelconnectionmodule::castasspatialmodelconnectionclass </td>
          <td>(</td>
          <td class="paramtype">class(*), intent(inout), pointer&#160;</td>
          <td class="paramname"><em>obj</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">obj</td><td>object to be cast </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the instance of SpatialModelConnectionType </dd></dl>

<p class="definition">Definition at line <a class="el" href="_spatial_model_connection_8f90_source.html#l00495">495</a> of file <a class="el" href="_spatial_model_connection_8f90_source.html">SpatialModelConnection.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <span class="keywordtype">class</span>(*), <span class="keywordtype">pointer</span>, <span class="keywordtype">intent(inout)</span> :: obj<span class="comment">           !&lt; object to be cast</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="keywordtype">class</span>(SpatialModelConnectionType), <span class="keywordtype">pointer</span> :: res<span class="comment"> !&lt; the instance of SpatialModelConnectionType</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    res =&gt; null()</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <span class="keywordflow">if</span> (.not. <span class="keyword">associated</span>(obj)) <span class="keywordflow">return</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="keywordflow">select type</span> (obj)</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="keywordflow">    class is</span> (spatialmodelconnectiontype)</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;      res =&gt; obj</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="keywordflow">    end select</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacespatialmodelconnectionmodule_aef271cf59d66fe8e5baef704109028fc_icgraph.png" border="0" usemap="#namespacespatialmodelconnectionmodule_aef271cf59d66fe8e5baef704109028fc_icgraph" alt=""/></div>
<map name="namespacespatialmodelconnectionmodule_aef271cf59d66fe8e5baef704109028fc_icgraph" id="namespacespatialmodelconnectionmodule_aef271cf59d66fe8e5baef704109028fc_icgraph">
<area shape="rect" title="Cast to SpatialModelConnectionType." alt="" coords="1213,209,1475,251"/>
<area shape="rect" href="namespacespatialmodelconnectionmodule.html#ab03c81ae159b53ae92e07d83d48cca29" title="Get the connection from a list." alt="" coords="907,209,1165,251"/>
<area shape="rect" href="namespaceconnectionbuildermodule.html#aa5b7a09a35bdd2b85e44caea16bb075e" title="Add global exchanges from a certain numerical solution to the connections." alt="" coords="609,5,842,47"/>
<area shape="rect" href="namespacegwfgwtexchangemodule.html#a186c9181959e0a9abaa5eca74675574a" title="Link GWT connections to GWF connections or exchanges." alt="" coords="634,71,817,112"/>
<area shape="rect" href="namespacemf6coremodule.html#ae17efa5a9e03fd31617a08c08e20ae03" title="Finalize the simulation." alt="" coords="622,242,829,269"/>
<area shape="rect" href="namespacemf6coremodule.html#aab3891c5763fe8a941e6799fe9c82388" title="Finalize time step." alt="" coords="593,137,857,163"/>
<area shape="rect" href="namespacemf6coremodule.html#a40b8130d3cf17bc47fcb54c254aada8a" title="Read and prepare time step." alt="" coords="592,187,859,214"/>
<area shape="rect" href="namespaceconnectionbuildermodule.html#a70c99123d0984c94b5c28ee5f8cfccfe" title="Set connections to the solution." alt="" coords="629,395,822,436"/>
<area shape="rect" href="namespacemf6coremodule.html#a622ba9fa9473eb16b9f17553d6483ae9" title="Simulation allocate and read." alt="" coords="614,293,837,319"/>
<area shape="rect" href="namespacemf6coremodule.html#a55d3318977ea83a1389aec5f42d5a77f" title="Define the simulation." alt="" coords="614,343,837,370"/>
<area shape="rect" href="namespacemf6bmi.html#ab8397f78e5c3c405656064c227eca26f" title="Clean up the initialized simulation." alt="" coords="357,243,517,270"/>
<area shape="rect" href="namespacemf6coremodule.html#a207819c711610066af1b83ec2a8efef0" title="Main controller." alt="" coords="101,294,281,321"/>
<area shape="rect" href="mf6_8f90.html#aa95bf577752f92b917375902bbb13863" title="MODFLOW 6 main entry point." alt="" coords="5,294,53,321"/>
<area shape="rect" href="namespacemf6coremodule.html#a7526420bd1fc4ebd3a09487e8509eff7" title="Run a time step." alt="" coords="335,126,539,153"/>
<area shape="rect" href="namespacemf6xmi.html#ac693e2880714e2c5d97a752123b19b7b" title="Finalize the time step." alt="" coords="357,60,517,101"/>
<area shape="rect" href="namespacemf6bmi.html#a91fa63496b27ec97b5e1b689497cd10a" title="Perform a computational time step." alt="" coords="112,126,271,153"/>
<area shape="rect" href="namespacemf6xmi.html#aa078192e78aa3e261fc712bbdf6b38f0" title="Prepare a single time step." alt="" coords="355,177,518,219"/>
<area shape="rect" href="namespacemf6coremodule.html#aa847da5116e01f4fad8885b0c4f96757" title="Initialize a simulation." alt="" coords="329,345,544,371"/>
<area shape="rect" href="namespacemf6bmi.html#aa886df822e4ea66c30a97a9060da5de8" title="Initialize the computational core." alt="" coords="107,345,276,371"/>
</map>
</div>

</div>
</div>
<a id="ace61fc3d934039f47a0eff6f420c235b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace61fc3d934039f47a0eff6f420c235b">&#9670;&nbsp;</a></span>createcoefficientmatrix()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine spatialmodelconnectionmodule::createcoefficientmatrix </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structspatialmodelconnectionmodule_1_1spatialmodelconnectiontype.html">spatialmodelconnectiontype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(sparsematrix), intent(inout)&#160;</td>
          <td class="paramname"><em>sparse</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>this connection </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">sparse</td><td>the sparse matrix with the cell connections </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_spatial_model_connection_8f90_source.html#l00443">443</a> of file <a class="el" href="_spatial_model_connection_8f90_source.html">SpatialModelConnection.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacesimmodule.html">simmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61">ustop</a></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="keywordtype">class</span>(SpatialModelConnectionType) :: this<span class="comment">   !&lt; this connection</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <span class="keywordtype">type</span>(sparsematrix), <span class="keywordtype">intent(inout)</span> :: sparse<span class="comment"> !&lt; the sparse matrix with the cell connections</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <span class="comment">! local</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ierror</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160; </div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    this%nja = sparse%nnz</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%ia, this%neq + 1, <span class="stringliteral">&#39;IA&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%ja, this%nja, <span class="stringliteral">&#39;JA&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%amat, this%nja, <span class="stringliteral">&#39;AMAT&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160; </div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="keyword">call </span>sparse%sort()</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="keyword">call </span>sparse%filliaja(this%ia, this%ja, ierror)</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160; </div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="keywordflow">if</span> (ierror /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;      <span class="keyword">write</span> (*, *) <span class="stringliteral">&#39;Error: cannot fill ia/ja for model connection&#39;</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61">ustop</a>()</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160; </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacespatialmodelconnectionmodule_ace61fc3d934039f47a0eff6f420c235b_cgraph.png" border="0" usemap="#namespacespatialmodelconnectionmodule_ace61fc3d934039f47a0eff6f420c235b_cgraph" alt=""/></div>
<map name="namespacespatialmodelconnectionmodule_ace61fc3d934039f47a0eff6f420c235b_cgraph" id="namespacespatialmodelconnectionmodule_ace61fc3d934039f47a0eff6f420c235b_cgraph">
<area shape="rect" title="Add connections, handled by the interface model,." alt="" coords="5,61,232,102"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="280,68,419,95"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="467,27,635,69"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title="Subroutine to stop the program." alt="" coords="467,93,635,134"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="683,5,877,32"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title="Write simulation message." alt="" coords="696,57,864,98"/>
</map>
</div>

</div>
</div>
<a id="ab03c81ae159b53ae92e07d83d48cca29"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab03c81ae159b53ae92e07d83d48cca29">&#9670;&nbsp;</a></span>getspatialmodelconnectionfromlist()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">class(<a class="el" href="structspatialmodelconnectionmodule_1_1spatialmodelconnectiontype.html">spatialmodelconnectiontype</a>) function, pointer, public spatialmodelconnectionmodule::getspatialmodelconnectionfromlist </td>
          <td>(</td>
          <td class="paramtype">type(listtype), intent(inout)&#160;</td>
          <td class="paramname"><em>list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>idx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">list</td><td>the list </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">idx</td><td>the index of the connection </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the returned connection </dd></dl>

<p class="definition">Definition at line <a class="el" href="_spatial_model_connection_8f90_source.html#l00528">528</a> of file <a class="el" href="_spatial_model_connection_8f90_source.html">SpatialModelConnection.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="keywordtype">type</span>(ListType), <span class="keywordtype">intent(inout)</span> :: list<span class="comment">             !&lt; the list</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: idx<span class="comment">                   !&lt; the index of the connection</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="keywordtype">class</span>(SpatialModelConnectionType), <span class="keywordtype">pointer</span> :: res<span class="comment"> !&lt; the returned connection</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160; </div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <span class="comment">! local</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    <span class="keywordtype">class</span>(*), <span class="keywordtype">pointer</span> :: obj</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    obj =&gt; list%GetItem(idx)</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    res =&gt; castasspatialmodelconnectionclass(obj)</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacespatialmodelconnectionmodule_ab03c81ae159b53ae92e07d83d48cca29_cgraph.png" border="0" usemap="#namespacespatialmodelconnectionmodule_ab03c81ae159b53ae92e07d83d48cca29_cgraph" alt=""/></div>
<map name="namespacespatialmodelconnectionmodule_ab03c81ae159b53ae92e07d83d48cca29_cgraph" id="namespacespatialmodelconnectionmodule_ab03c81ae159b53ae92e07d83d48cca29_cgraph">
<area shape="rect" title="Get the connection from a list." alt="" coords="5,5,264,47"/>
<area shape="rect" href="namespacespatialmodelconnectionmodule.html#aef271cf59d66fe8e5baef704109028fc" title="Cast to SpatialModelConnectionType." alt="" coords="312,5,573,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacespatialmodelconnectionmodule_ab03c81ae159b53ae92e07d83d48cca29_icgraph.png" border="0" usemap="#namespacespatialmodelconnectionmodule_ab03c81ae159b53ae92e07d83d48cca29_icgraph" alt=""/></div>
<map name="namespacespatialmodelconnectionmodule_ab03c81ae159b53ae92e07d83d48cca29_icgraph" id="namespacespatialmodelconnectionmodule_ab03c81ae159b53ae92e07d83d48cca29_icgraph">
<area shape="rect" title="Get the connection from a list." alt="" coords="907,209,1165,251"/>
<area shape="rect" href="namespaceconnectionbuildermodule.html#aa5b7a09a35bdd2b85e44caea16bb075e" title="Add global exchanges from a certain numerical solution to the connections." alt="" coords="609,5,842,47"/>
<area shape="rect" href="namespacegwfgwtexchangemodule.html#a186c9181959e0a9abaa5eca74675574a" title="Link GWT connections to GWF connections or exchanges." alt="" coords="634,71,817,112"/>
<area shape="rect" href="namespacemf6coremodule.html#ae17efa5a9e03fd31617a08c08e20ae03" title="Finalize the simulation." alt="" coords="622,242,829,269"/>
<area shape="rect" href="namespacemf6coremodule.html#aab3891c5763fe8a941e6799fe9c82388" title="Finalize time step." alt="" coords="593,137,857,163"/>
<area shape="rect" href="namespacemf6coremodule.html#a40b8130d3cf17bc47fcb54c254aada8a" title="Read and prepare time step." alt="" coords="592,187,859,214"/>
<area shape="rect" href="namespaceconnectionbuildermodule.html#a70c99123d0984c94b5c28ee5f8cfccfe" title="Set connections to the solution." alt="" coords="629,395,822,436"/>
<area shape="rect" href="namespacemf6coremodule.html#a622ba9fa9473eb16b9f17553d6483ae9" title="Simulation allocate and read." alt="" coords="614,293,837,319"/>
<area shape="rect" href="namespacemf6coremodule.html#a55d3318977ea83a1389aec5f42d5a77f" title="Define the simulation." alt="" coords="614,343,837,370"/>
<area shape="rect" href="namespacemf6bmi.html#ab8397f78e5c3c405656064c227eca26f" title="Clean up the initialized simulation." alt="" coords="357,243,517,270"/>
<area shape="rect" href="namespacemf6coremodule.html#a207819c711610066af1b83ec2a8efef0" title="Main controller." alt="" coords="101,294,281,321"/>
<area shape="rect" href="mf6_8f90.html#aa95bf577752f92b917375902bbb13863" title="MODFLOW 6 main entry point." alt="" coords="5,294,53,321"/>
<area shape="rect" href="namespacemf6coremodule.html#a7526420bd1fc4ebd3a09487e8509eff7" title="Run a time step." alt="" coords="335,126,539,153"/>
<area shape="rect" href="namespacemf6xmi.html#ac693e2880714e2c5d97a752123b19b7b" title="Finalize the time step." alt="" coords="357,60,517,101"/>
<area shape="rect" href="namespacemf6bmi.html#a91fa63496b27ec97b5e1b689497cd10a" title="Perform a computational time step." alt="" coords="112,126,271,153"/>
<area shape="rect" href="namespacemf6xmi.html#aa078192e78aa3e261fc712bbdf6b38f0" title="Prepare a single time step." alt="" coords="355,177,518,219"/>
<area shape="rect" href="namespacemf6coremodule.html#aa847da5116e01f4fad8885b0c4f96757" title="Initialize a simulation." alt="" coords="329,345,544,371"/>
<area shape="rect" href="namespacemf6bmi.html#aa886df822e4ea66c30a97a9060da5de8" title="Initialize the computational core." alt="" coords="107,345,276,371"/>
</map>
</div>

</div>
</div>
<a id="aec90536f741cddef194442f90e8d7aa7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec90536f741cddef194442f90e8d7aa7">&#9670;&nbsp;</a></span>maskownerconnections()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine spatialmodelconnectionmodule::maskownerconnections </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structspatialmodelconnectionmodule_1_1spatialmodelconnectiontype.html">spatialmodelconnectiontype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Determine which connections are handled by the interface model (using the connections object in its discretization) and </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>the connection </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_spatial_model_connection_8f90_source.html#l00212">212</a> of file <a class="el" href="_spatial_model_connection_8f90_source.html">SpatialModelConnection.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacecsrutilsmodule.html">csrutilsmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacecsrutilsmodule.html#a0fbb240524fa0172b9ee6a14844f4470">getcsrindex</a></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keywordtype">class</span>(SpatialModelConnectionType) :: this<span class="comment"> !&lt; the connection</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="comment">! local</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ipos, n, m, nloc, mloc, csrIdx</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="keywordtype">type</span>(ConnectionsType), <span class="keywordtype">pointer</span> :: conn</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160; </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="comment">! set the mask on connections that are calculated by the interface model</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    conn =&gt; this%interfaceModel%dis%con</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="keywordflow">do</span> n = 1, conn%nodes</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;      <span class="comment">! only for connections internal to the owning model</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      <span class="keywordflow">if</span> (.not. <span class="keyword">associated</span>(this%gridConnection%idxToGlobal(n)%model, &amp;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                           this%owner)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        cycle</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      nloc = this%gridConnection%idxToGlobal(n)%index</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160; </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      <span class="keywordflow">do</span> ipos = conn%ia(n) + 1, conn%ia(n + 1) - 1</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        m = conn%ja(ipos)</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <span class="keywordflow">if</span> (.not. <span class="keyword">associated</span>(this%gridConnection%idxToGlobal(m)%model, &amp;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                             this%owner)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;          cycle</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        mloc = this%gridConnection%idxToGlobal(m)%index</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160; </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        <span class="keywordflow">if</span> (conn%mask(ipos) &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;          <span class="comment">! calculated by interface model, set local model&#39;s mask to zero</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;          csridx = <a class="code" href="namespacecsrutilsmodule.html#a0fbb240524fa0172b9ee6a14844f4470">getcsrindex</a>(nloc, mloc, this%owner%ia, this%owner%ja)</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;          <span class="keywordflow">if</span> (csridx == -1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;            <span class="comment">! this can only happen with periodic boundary conditions,</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;            <span class="comment">! then there is no need to set the mask</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;            <span class="keywordflow">if</span> (this%gridConnection%isPeriodic(nloc, mloc)) cycle</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160; </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;            <span class="keyword">write</span> (*, *) <span class="stringliteral">&#39;Error: cannot find cell connection in global system&#39;</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61">ustop</a>()</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160; </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;          <span class="keywordflow">if</span> (this%owner%dis%con%mask(csridx) &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;            <span class="keyword">call </span>this%owner%dis%con%set_mask(csridx, 0)</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;            <span class="comment">! edge case, someone will be calculating this connection</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;            <span class="comment">! so we ignore it here (TODO_MJR: add name)</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            <span class="keyword">write</span> (*, *) <span class="stringliteral">&#39;Debug: overlap detected, ignoring connection &#39;</span>, &amp;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;              nloc, <span class="stringliteral">&#39;:&#39;</span>, mloc, <span class="stringliteral">&#39; for model &#39;</span>, trim(this%owner%name), &amp;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;              <span class="stringliteral">&#39; in Exchange ???&#39;</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;            <span class="keyword">call </span>conn%set_mask(ipos, 0)</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160; </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacespatialmodelconnectionmodule_aec90536f741cddef194442f90e8d7aa7_cgraph.png" border="0" usemap="#namespacespatialmodelconnectionmodule_aec90536f741cddef194442f90e8d7aa7_cgraph" alt=""/></div>
<map name="namespacespatialmodelconnectionmodule_aec90536f741cddef194442f90e8d7aa7_cgraph" id="namespacespatialmodelconnectionmodule_aec90536f741cddef194442f90e8d7aa7_cgraph">
<area shape="rect" title="Mask the owner&#39;s connections." alt="" coords="5,35,232,77"/>
<area shape="rect" href="namespacecsrutilsmodule.html#a0fbb240524fa0172b9ee6a14844f4470" title="Return index for element i,j in CSR storage,." alt="" coords="280,17,483,44"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="312,68,451,95"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="531,27,699,69"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title="Subroutine to stop the program." alt="" coords="531,93,699,134"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="747,5,941,32"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title="Write simulation message." alt="" coords="760,57,928,98"/>
</map>
</div>

</div>
</div>
<a id="afce8ea9e92b18b6ea282c8ae1fc6c4f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afce8ea9e92b18b6ea282c8ae1fc6c4f7">&#9670;&nbsp;</a></span>spatialcon_ar()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine spatialmodelconnectionmodule::spatialcon_ar </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structspatialmodelconnectionmodule_1_1spatialmodelconnectiontype.html">spatialmodelconnectiontype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>this connection </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_spatial_model_connection_8f90_source.html#l00141">141</a> of file <a class="el" href="_spatial_model_connection_8f90_source.html">SpatialModelConnection.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="keywordtype">class</span>(SpatialModelConnectionType) :: this<span class="comment"> !&lt; this connection</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="comment">! local</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: icell, idx, localIdx</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="keywordtype">class</span>(GridConnectionType), <span class="keywordtype">pointer</span> :: gc</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keywordtype">class</span>(NumericalModelType), <span class="keywordtype">pointer</span> :: model</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160; </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="comment">! init x and ibound with model data</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    gc =&gt; this%gridConnection</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keywordflow">do</span> icell = 1, gc%nrOfCells</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      idx = gc%idxToGlobal(icell)%index</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      model =&gt; gc%idxToGlobal(icell)%model</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      this%interfaceModel%x(icell) = model%x(idx)</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      this%interfaceModel%ibound(icell) = model%ibound(idx)</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="comment">! fill mapping to global index (which can be</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="comment">! done now because moffset is set in sln_df)</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordflow">do</span> localidx = 1, gc%nrOfCells</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      gc%idxToGlobalIdx(localidx) = gc%idxToGlobal(localidx)%index + &amp;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                                    gc%idxToGlobal(localidx)%model%moffset</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
</div><!-- fragment -->
</div>
</div>
<a id="a1b24a013bff5f6865ad9bccf37d713d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b24a013bff5f6865ad9bccf37d713d4">&#9670;&nbsp;</a></span>spatialcon_connect()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine spatialmodelconnectionmodule::spatialcon_connect </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structspatialmodelconnectionmodule_1_1spatialmodelconnectiontype.html">spatialmodelconnectiontype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>this connection </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_spatial_model_connection_8f90_source.html#l00189">189</a> of file <a class="el" href="_spatial_model_connection_8f90_source.html">SpatialModelConnection.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="keywordtype">class</span>(SpatialModelConnectionType) :: this<span class="comment"> !&lt; this connection</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="comment">! local</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keywordtype">type</span>(sparsematrix) :: sparse</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keyword">call </span>sparse%init(this%neq, this%neq, 7)</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keyword">call </span>this%interfaceModel%model_ac(sparse)</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160; </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="comment">! create amat from sparse</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="keyword">call </span>this%createCoefficientMatrix(sparse)</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="keyword">call </span>sparse%destroy()</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160; </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="comment">! map connections</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="keyword">call </span>this%interfaceModel%model_mc(this%ia, this%ja)</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keyword">call </span>this%maskOwnerConnections()</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160; </div>
</div><!-- fragment -->
</div>
</div>
<a id="a33bf848774c4a590db0f35095e21f84d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a33bf848774c4a590db0f35095e21f84d">&#9670;&nbsp;</a></span>spatialcon_df()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine spatialmodelconnectionmodule::spatialcon_df </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structspatialmodelconnectionmodule_1_1spatialmodelconnectiontype.html">spatialmodelconnectiontype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>this connection </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_spatial_model_connection_8f90_source.html#l00122">122</a> of file <a class="el" href="_spatial_model_connection_8f90_source.html">SpatialModelConnection.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keywordtype">class</span>(SpatialModelConnectionType) :: this<span class="comment"> !&lt; this connection</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="comment">! create the grid connection data structure</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    this%nrOfConnections = this%getNrOfConnections()</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="keyword">call </span>this%gridConnection%construct(this%owner, &amp;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                                       this%nrOfConnections, &amp;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                                       this%name)</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    this%gridConnection%internalStencilDepth = this%internalStencilDepth</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    this%gridConnection%exchangeStencilDepth = this%exchangeStencilDepth</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keyword">call </span>this%setupGridConnection()</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    this%neq = this%gridConnection%nrOfCells</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keyword">call </span>this%allocateArrays()</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
</div><!-- fragment -->
</div>
</div>
<a id="a59c0b64c1ea956b6a3663b52ac18465b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59c0b64c1ea956b6a3663b52ac18465b">&#9670;&nbsp;</a></span>spatialcon_setmodelptrs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine spatialmodelconnectionmodule::spatialcon_setmodelptrs </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structspatialmodelconnectionmodule_1_1spatialmodelconnectiontype.html">spatialmodelconnectiontype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>this connection </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_spatial_model_connection_8f90_source.html#l00168">168</a> of file <a class="el" href="_spatial_model_connection_8f90_source.html">SpatialModelConnection.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="keywordtype">class</span>(SpatialModelConnectionType) :: this<span class="comment"> !&lt; this connection</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160; </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="comment">! point x, ibound, and rhs to connection</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    this%interfaceModel%x =&gt; this%x</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__checkin.html">mem_checkin</a>(this%interfaceModel%x, <span class="stringliteral">&#39;X&#39;</span>, &amp;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                     this%interfaceModel%memoryPath, <span class="stringliteral">&#39;X&#39;</span>, &amp;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                     this%memoryPath)</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    this%interfaceModel%rhs =&gt; this%rhs</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__checkin.html">mem_checkin</a>(this%interfaceModel%rhs, <span class="stringliteral">&#39;RHS&#39;</span>, &amp;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                     this%interfaceModel%memoryPath, <span class="stringliteral">&#39;RHS&#39;</span>, &amp;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                     this%memoryPath)</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    this%interfaceModel%ibound =&gt; this%active</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__checkin.html">mem_checkin</a>(this%interfaceModel%ibound, <span class="stringliteral">&#39;IBOUND&#39;</span>, &amp;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                     this%interfaceModel%memoryPath, <span class="stringliteral">&#39;IBOUND&#39;</span>, &amp;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                     this%memoryPath)</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160; </div>
</div><!-- fragment -->
</div>
</div>
<a id="a76507ae198dd17cba071ffdbeb4d801e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76507ae198dd17cba071ffdbeb4d801e">&#9670;&nbsp;</a></span>spatialconnection_ctor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine spatialmodelconnectionmodule::spatialconnection_ctor </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structspatialmodelconnectionmodule_1_1spatialmodelconnectiontype.html">spatialmodelconnectiontype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(numericalmodeltype), intent(in), pointer&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(disconnexchangetype), intent(in), pointer&#160;</td>
          <td class="paramname"><em>exchange</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This constructor is typically called from a derived class. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>the connection </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">model</td><td>the model that owns the connection </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">exchange</td><td>the primary exchange from which the connection is created </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">name</td><td>the connection name (for memory management mostly) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_spatial_model_connection_8f90_source.html#l00095">95</a> of file <a class="el" href="_spatial_model_connection_8f90_source.html">SpatialModelConnection.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keywordtype">class</span>(SpatialModelConnectionType) :: this<span class="comment">                   !&lt; the connection</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keywordtype">class</span>(NumericalModelType), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">pointer</span> :: model<span class="comment">     !&lt; the model that owns the connection</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keywordtype">class</span>(DisConnExchangeType), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">pointer</span> :: exchange<span class="comment"> !&lt; the primary exchange from which</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">                                                                !! the connection is created</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: name<span class="comment">                        !&lt; the connection name (for memory management mostly)</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    this%name = name</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    this%memoryPath = <a class="code" href="namespacememoryhelpermodule.html#a3791dbc2d4a06a0b9112158cff21f738">create_mem_path</a>(this%name)</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    this%owner =&gt; model</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    this%primaryExchange =&gt; exchange</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="keyword">allocate</span> (this%gridConnection)</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keyword">call </span>this%allocateScalars()</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    this%internalStencilDepth = 1</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    this%exchangeStencilDepth = 1</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    this%nrOfConnections = 0</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="comment">! this should be set in derived ctor</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    this%interfaceModel =&gt; null()</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacespatialmodelconnectionmodule_a76507ae198dd17cba071ffdbeb4d801e_cgraph.png" border="0" usemap="#namespacespatialmodelconnectionmodule_a76507ae198dd17cba071ffdbeb4d801e_cgraph" alt=""/></div>
<map name="namespacespatialmodelconnectionmodule_a76507ae198dd17cba071ffdbeb4d801e_cgraph" id="namespacespatialmodelconnectionmodule_a76507ae198dd17cba071ffdbeb4d801e_cgraph">
<area shape="rect" title="Construct the spatial connection base." alt="" coords="5,61,232,102"/>
<area shape="rect" href="namespacememoryhelpermodule.html#a3791dbc2d4a06a0b9112158cff21f738" title="returns the path to the memory object" alt="" coords="280,61,447,102"/>
<area shape="rect" href="namespacememoryhelpermodule.html#a5405f58247a0962e5449ebc1e4dcff0f" title="Generic routine to check the length of (parts of) the memory address." alt="" coords="495,61,661,102"/>
<area shape="rect" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e" title="Store error message." alt="" coords="709,68,884,95"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="932,68,1071,95"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="1119,27,1287,69"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title="Subroutine to stop the program." alt="" coords="1119,93,1287,134"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="1335,5,1529,32"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title="Write simulation message." alt="" coords="1348,57,1516,98"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacespatialmodelconnectionmodule_a76507ae198dd17cba071ffdbeb4d801e_icgraph.png" border="0" usemap="#namespacespatialmodelconnectionmodule_a76507ae198dd17cba071ffdbeb4d801e_icgraph" alt=""/></div>
<map name="namespacespatialmodelconnectionmodule_a76507ae198dd17cba071ffdbeb4d801e_icgraph" id="namespacespatialmodelconnectionmodule_a76507ae198dd17cba071ffdbeb4d801e_icgraph">
<area shape="rect" title="Construct the spatial connection base." alt="" coords="280,13,507,54"/>
<area shape="rect" href="structspatialmodelconnectionmodule_1_1spatialmodelconnectiontype.html#a9a8646d6e793d99f3a83e81a05d8a9f1" title=" " alt="" coords="5,5,232,61"/>
</map>
</div>

</div>
</div>
<a id="a0574292d636407e09dae880717f67331"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0574292d636407e09dae880717f67331">&#9670;&nbsp;</a></span>validateconnection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine spatialmodelconnectionmodule::validateconnection </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structspatialmodelconnectionmodule_1_1spatialmodelconnectiontype.html">spatialmodelconnectiontype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>this connection </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_spatial_model_connection_8f90_source.html#l00467">467</a> of file <a class="el" href="_spatial_model_connection_8f90_source.html">SpatialModelConnection.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacesimvariablesmodule.html">simvariablesmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacesimvariablesmodule.html#a08c1a8900029e311ac640e2319c6a234">errmsg</a></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacesimmodule.html">simmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="keywordtype">class</span>(SpatialModelConnectionType) :: this<span class="comment"> !&lt; this connection</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <span class="comment">! local</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <span class="keywordtype">class</span>(DisConnExchangeType), <span class="keywordtype">pointer</span> :: conEx =&gt; null()</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160; </div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    conex =&gt; this%primaryExchange</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="keywordflow">if</span> (conex%ixt3d &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;      <span class="comment">! if XT3D, we need these angles:</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;      <span class="keywordflow">if</span> (conex%model1%dis%con%ianglex == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        <span class="keyword">write</span> (<a class="code" href="namespacesimvariablesmodule.html#a08c1a8900029e311ac640e2319c6a234">errmsg</a>, <span class="stringliteral">&#39;(1x,a,a,a,a,a)&#39;</span>) <span class="stringliteral">&#39;XT3D configured on the exchange &#39;</span>, &amp;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;          trim(conex%name), <span class="stringliteral">&#39; but the discretization in model &#39;</span>, &amp;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;          trim(conex%model1%name), <span class="stringliteral">&#39; has no ANGLDEGX specified&#39;</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(<a class="code" href="namespacesimvariablesmodule.html#a08c1a8900029e311ac640e2319c6a234">errmsg</a>)</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      <span class="keywordflow">if</span> (conex%model2%dis%con%ianglex == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        <span class="keyword">write</span> (<a class="code" href="namespacesimvariablesmodule.html#a08c1a8900029e311ac640e2319c6a234">errmsg</a>, <span class="stringliteral">&#39;(1x,a,a,a,a,a)&#39;</span>) <span class="stringliteral">&#39;XT3D configured on the exchange &#39;</span>, &amp;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;          trim(conex%name), <span class="stringliteral">&#39; but the discretization in model &#39;</span>, &amp;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;          trim(conex%model2%name), <span class="stringliteral">&#39; has no ANGLDEGX specified&#39;</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(<a class="code" href="namespacesimvariablesmodule.html#a08c1a8900029e311ac640e2319c6a234">errmsg</a>)</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160; </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacespatialmodelconnectionmodule_a0574292d636407e09dae880717f67331_cgraph.png" border="0" usemap="#namespacespatialmodelconnectionmodule_a0574292d636407e09dae880717f67331_cgraph" alt=""/></div>
<map name="namespacespatialmodelconnectionmodule_a0574292d636407e09dae880717f67331_cgraph" id="namespacespatialmodelconnectionmodule_a0574292d636407e09dae880717f67331_cgraph">
<area shape="rect" title="Validate this connection." alt="" coords="5,61,232,102"/>
<area shape="rect" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e" title="Store error message." alt="" coords="280,68,455,95"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="503,68,641,95"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="689,27,857,69"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title="Subroutine to stop the program." alt="" coords="689,93,857,134"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="905,5,1100,32"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title="Write simulation message." alt="" coords="919,57,1087,98"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="anamespacesimvariablesmodule_html_a08c1a8900029e311ac640e2319c6a234"><div class="ttname"><a href="namespacesimvariablesmodule.html#a08c1a8900029e311ac640e2319c6a234">simvariablesmodule::errmsg</a></div><div class="ttdeci">character(len=maxcharlen) errmsg</div><div class="ttdoc">error message string</div><div class="ttdef"><b>Definition:</b> <a href="_sim_variables_8f90_source.html#l00017">SimVariables.f90:17</a></div></div>
<div class="ttc" id="anamespacesimmodule_html_a21870712a1166225fdcd5b60bffb353e"><div class="ttname"><a href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">simmodule::store_error</a></div><div class="ttdeci">subroutine, public store_error(msg, terminate)</div><div class="ttdoc">Store error message.</div><div class="ttdef"><b>Definition:</b> <a href="_sim_8f90_source.html#l00129">Sim.f90:129</a></div></div>
<div class="ttc" id="anamespacecsrutilsmodule_html"><div class="ttname"><a href="namespacecsrutilsmodule.html">csrutilsmodule</a></div><div class="ttdef"><b>Definition:</b> <a href="_csr_utils_8f90_source.html#l00001">CsrUtils.f90:1</a></div></div>
<div class="ttc" id="anamespacesimmodule_html"><div class="ttname"><a href="namespacesimmodule.html">simmodule</a></div><div class="ttdoc">This module contains simulation methods.</div><div class="ttdef"><b>Definition:</b> <a href="_sim_8f90_source.html#l00010">Sim.f90:10</a></div></div>
<div class="ttc" id="anamespacememoryhelpermodule_html_a3791dbc2d4a06a0b9112158cff21f738"><div class="ttname"><a href="namespacememoryhelpermodule.html#a3791dbc2d4a06a0b9112158cff21f738">memoryhelpermodule::create_mem_path</a></div><div class="ttdeci">character(len=lenmempath) function create_mem_path(component, subcomponent)</div><div class="ttdoc">returns the path to the memory object</div><div class="ttdef"><b>Definition:</b> <a href="_memory_helper_8f90_source.html#l00021">MemoryHelper.f90:21</a></div></div>
<div class="ttc" id="ainterfacememorymanagermodule_1_1mem__checkin_html"><div class="ttname"><a href="interfacememorymanagermodule_1_1mem__checkin.html">memorymanagermodule::mem_checkin</a></div><div class="ttdef"><b>Definition:</b> <a href="_memory_manager_8f90_source.html#l00058">MemoryManager.f90:58</a></div></div>
<div class="ttc" id="anamespacecsrutilsmodule_html_a0fbb240524fa0172b9ee6a14844f4470"><div class="ttname"><a href="namespacecsrutilsmodule.html#a0fbb240524fa0172b9ee6a14844f4470">csrutilsmodule::getcsrindex</a></div><div class="ttdeci">integer(i4b) function, public getcsrindex(i, j, ia, ja)</div><div class="ttdoc">Return index for element i,j in CSR storage,.</div><div class="ttdef"><b>Definition:</b> <a href="_csr_utils_8f90_source.html#l00013">CsrUtils.f90:13</a></div></div>
<div class="ttc" id="anamespacesimmodule_html_a0be97214c1d4fcf42bc4ddc27b111b61"><div class="ttname"><a href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61">simmodule::ustop</a></div><div class="ttdeci">subroutine, public ustop(stopmess, ioutlocal)</div><div class="ttdoc">Stop the simulation.</div><div class="ttdef"><b>Definition:</b> <a href="_sim_8f90_source.html#l00364">Sim.f90:364</a></div></div>
<div class="ttc" id="ainterfacememorymanagermodule_1_1mem__allocate_html"><div class="ttname"><a href="interfacememorymanagermodule_1_1mem__allocate.html">memorymanagermodule::mem_allocate</a></div><div class="ttdef"><b>Definition:</b> <a href="_memory_manager_8f90_source.html#l00049">MemoryManager.f90:49</a></div></div>
<div class="ttc" id="anamespacesimvariablesmodule_html"><div class="ttname"><a href="namespacesimvariablesmodule.html">simvariablesmodule</a></div><div class="ttdoc">This module contains simulation variables.</div><div class="ttdef"><b>Definition:</b> <a href="_sim_variables_8f90_source.html#l00009">SimVariables.f90:9</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacespatialmodelconnectionmodule.html">spatialmodelconnectionmodule</a></li>
    <li class="footer">Generated on Wed Jun 29 2022 19:23:12 for MODFLOW 6 by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
