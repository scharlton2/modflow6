<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MODFLOW 6: connectionbuildermodule Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="mf6-triangular-grid.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MODFLOW 6
   &#160;<span id="projectnumber">version 6.4.0</span>
   </div>
   <div id="projectbrief">MODFLOW 6 Code Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="namespaces.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="namespaces.html"><span>Modules&#160;List</span></a></li>
      <li><a href="namespacemembers.html"><span>Module&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('namespaceconnectionbuildermodule.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Types</a> &#124;
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">connectionbuildermodule Module Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Types</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">type &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structconnectionbuildermodule_1_1connectionbuildertype.html">connectionbuildertype</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a504f9d8e8687efb8ddcf247efbc9bc3c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceconnectionbuildermodule.html#a504f9d8e8687efb8ddcf247efbc9bc3c">processsolution</a> (this, solution)</td></tr>
<tr class="memdesc:a504f9d8e8687efb8ddcf247efbc9bc3c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process the exchanges in the solution into model connections.  <a href="namespaceconnectionbuildermodule.html#a504f9d8e8687efb8ddcf247efbc9bc3c">More...</a><br /></td></tr>
<tr class="separator:a504f9d8e8687efb8ddcf247efbc9bc3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef408e9381f69a203549fc5e8a355041"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceconnectionbuildermodule.html#aef408e9381f69a203549fc5e8a355041">processexchanges</a> (this, exchanges, newConnections)</td></tr>
<tr class="memdesc:aef408e9381f69a203549fc5e8a355041"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create connections from exchanges.  <a href="namespaceconnectionbuildermodule.html#aef408e9381f69a203549fc5e8a355041">More...</a><br /></td></tr>
<tr class="separator:aef408e9381f69a203549fc5e8a355041"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5601b21c926febbb01f731dc5c26d5a8"><td class="memItemLeft" align="right" valign="top">class(spatialmodelconnectiontype) function, pointer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceconnectionbuildermodule.html#a5601b21c926febbb01f731dc5c26d5a8">createmodelconnection</a> (model, exchange)</td></tr>
<tr class="memdesc:a5601b21c926febbb01f731dc5c26d5a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a model connection of a given type.  <a href="namespaceconnectionbuildermodule.html#a5601b21c926febbb01f731dc5c26d5a8">More...</a><br /></td></tr>
<tr class="separator:a5601b21c926febbb01f731dc5c26d5a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70c99123d0984c94b5c28ee5f8cfccfe"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceconnectionbuildermodule.html#a70c99123d0984c94b5c28ee5f8cfccfe">setconnectionstosolution</a> (this, connections, solution)</td></tr>
<tr class="memdesc:a70c99123d0984c94b5c28ee5f8cfccfe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set connections to the solution.  <a href="namespaceconnectionbuildermodule.html#a70c99123d0984c94b5c28ee5f8cfccfe">More...</a><br /></td></tr>
<tr class="separator:a70c99123d0984c94b5c28ee5f8cfccfe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5b7a09a35bdd2b85e44caea16bb075e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceconnectionbuildermodule.html#aa5b7a09a35bdd2b85e44caea16bb075e">assignexchangestoconnections</a> (this, exchanges, connections)</td></tr>
<tr class="memdesc:aa5b7a09a35bdd2b85e44caea16bb075e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add global exchanges from a certain numerical solution to the connections.  <a href="namespaceconnectionbuildermodule.html#aa5b7a09a35bdd2b85e44caea16bb075e">More...</a><br /></td></tr>
<tr class="separator:aa5b7a09a35bdd2b85e44caea16bb075e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="aa5b7a09a35bdd2b85e44caea16bb075e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5b7a09a35bdd2b85e44caea16bb075e">&#9670;&nbsp;</a></span>assignexchangestoconnections()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine connectionbuildermodule::assignexchangestoconnections </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structconnectionbuildermodule_1_1connectionbuildertype.html">connectionbuildertype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(listtype), intent(in), pointer&#160;</td>
          <td class="paramname"><em>exchanges</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(listtype), intent(inout)&#160;</td>
          <td class="paramname"><em>connections</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This concerns all exchanges of the proper type. Inside the connection it will be used to extend the interface grid with the possibility to include cells from models which are indirectly connected, through yet another exchange object. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>the connection builder object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">exchanges</td><td>all exchanges in a solution </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">connections</td><td>all connections that are created for this solution </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_connection_builder_8f90_source.html#l00256">256</a> of file <a class="el" href="_connection_builder_8f90_source.html">ConnectionBuilder.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keywordtype">class</span>(ConnectionBuilderType) :: this<span class="comment">              !&lt; the connection builder object</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="keywordtype">type</span>(ListType), <span class="keywordtype">pointer</span>, <span class="keywordtype">intent(in)</span> :: exchanges<span class="comment">  !&lt; all exchanges in a solution</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="keywordtype">type</span>(ListType), <span class="keywordtype">intent(inout)</span> :: connections<span class="comment">         !&lt; all connections that are created for this solution</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="comment">! local</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: iex, iconn</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="keywordtype">class</span>(DisConnExchangeType), <span class="keywordtype">pointer</span> :: conEx</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keywordtype">class</span>(SpatialModelConnectionType), <span class="keywordtype">pointer</span> :: modelConn</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keywordtype">class</span>(*), <span class="keywordtype">pointer</span> :: exPtr</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keywordtype">type</span>(ListType) :: keepList</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="comment">! first filter on exchanges of proper type</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="keywordflow">do</span> iex = 1, exchanges%Count()</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      conex =&gt; getdisconnexchangefromlist(exchanges, iex)</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;      <span class="keywordflow">if</span> (.not. <span class="keyword">associated</span>(conex)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <span class="comment">! if it is not DisConnExchangeType, we should skip it</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        <span class="keywordflow">continue</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      exptr =&gt; conex</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      <span class="keyword">call </span>keeplist%Add(exptr)</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160; </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="comment">! now add them to the model connections</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keywordflow">do</span> iconn = 1, connections%Count()</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      modelconn =&gt; getspatialmodelconnectionfromlist(connections, iconn)</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      <span class="keywordflow">do</span> iex = 1, keeplist%Count()</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        exptr =&gt; keeplist%GetItem(iex)</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        <span class="keyword">call </span>modelconn%globalExchanges%Add(exptr)</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="comment">! clean</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keyword">call </span>keeplist%Clear(destroy=.false.)</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceconnectionbuildermodule_aa5b7a09a35bdd2b85e44caea16bb075e_cgraph.png" border="0" usemap="#namespaceconnectionbuildermodule_aa5b7a09a35bdd2b85e44caea16bb075e_cgraph" alt=""/></div>
<map name="namespaceconnectionbuildermodule_aa5b7a09a35bdd2b85e44caea16bb075e_cgraph" id="namespaceconnectionbuildermodule_aa5b7a09a35bdd2b85e44caea16bb075e_cgraph">
<area shape="rect" title="Add global exchanges from a certain numerical solution to the connections." alt="" coords="5,39,239,80"/>
<area shape="rect" href="namespacedisconnexchangemodule.html#a63ac91d936c8b44104f8e091a81e7ac2" title=" " alt="" coords="309,5,523,47"/>
<area shape="rect" href="namespacespatialmodelconnectionmodule.html#ab03c81ae159b53ae92e07d83d48cca29" title="Get the connection from a list." alt="" coords="287,71,545,112"/>
<area shape="rect" href="namespacedisconnexchangemodule.html#a9ad5f8b11f95c70aeda06b186754b567" title=" " alt="" coords="615,5,833,47"/>
<area shape="rect" href="namespacespatialmodelconnectionmodule.html#aef271cf59d66fe8e5baef704109028fc" title="Cast to SpatialModelConnectionType." alt="" coords="593,71,855,112"/>
</map>
</div>

</div>
</div>
<a id="a5601b21c926febbb01f731dc5c26d5a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5601b21c926febbb01f731dc5c26d5a8">&#9670;&nbsp;</a></span>createmodelconnection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">class(spatialmodelconnectiontype) function, pointer connectionbuildermodule::createmodelconnection </td>
          <td>(</td>
          <td class="paramtype">class(numericalmodeltype), intent(in), pointer&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(disconnexchangetype), intent(in), pointer&#160;</td>
          <td class="paramname"><em>exchange</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This is a factory method to create the various types of model connections </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">model</td><td>the model for which the connection will be created </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">exchange</td><td>the type of connection </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the created connection </dd></dl>

<p class="definition">Definition at line <a class="el" href="_connection_builder_8f90_source.html#l00158">158</a> of file <a class="el" href="_connection_builder_8f90_source.html">ConnectionBuilder.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacesimmodule.html">simmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61">ustop</a></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacegwfgwfconnectionmodule.html">gwfgwfconnectionmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="structgwfgwfconnectionmodule_1_1gwfgwfconnectiontype.html">gwfgwfconnectiontype</a></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacegwtgwtconnectionmodule.html">gwtgwtconnectionmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="structgwtgwtconnectionmodule_1_1gwtgwtconnectiontype.html">gwtgwtconnectiontype</a></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacegwfmodule.html">gwfmodule</a>, <span class="keywordtype">only</span>: gwfmodeltype</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="keywordtype">class</span>(NumericalModelType), <span class="keywordtype">pointer</span>, <span class="keywordtype">intent(in)</span> :: model<span class="comment">     !&lt; the model for which the connection will be created</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="keywordtype">class</span>(DisConnExchangeType), <span class="keywordtype">pointer</span>, <span class="keywordtype">intent(in)</span> :: exchange<span class="comment"> !&lt; the type of connection</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="keywordtype">class</span>(SpatialModelConnectionType), <span class="keywordtype">pointer</span> :: connection<span class="comment">    !&lt; the created connection</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="comment">! different concrete connection types:</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="keywordtype">class</span>(GwfGwfConnectionType), <span class="keywordtype">pointer</span> :: flowConnection =&gt; null()</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="keywordtype">class</span>(GwtGwtConnectionType), <span class="keywordtype">pointer</span> :: transportConnection =&gt; null()</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    connection =&gt; null()</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="comment">! select on type of connection to create</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="keywordflow">select case</span> (exchange%typename)</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keywordflow">case</span> (<span class="stringliteral">&#39;GWF-GWF&#39;</span>)</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      <span class="keyword">allocate</span> (<a class="code" href="structgwfgwfconnectionmodule_1_1gwfgwfconnectiontype.html">gwfgwfconnectiontype</a> :: flowconnection)</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      <span class="keyword">call </span>flowconnection%construct(model, exchange)</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      connection =&gt; flowconnection</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;      flowconnection =&gt; null()</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keywordflow">case</span> (<span class="stringliteral">&#39;GWT-GWT&#39;</span>)</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      <span class="keyword">allocate</span> (<a class="code" href="structgwtgwtconnectionmodule_1_1gwtgwtconnectiontype.html">gwtgwtconnectiontype</a> :: transportconnection)</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      <span class="keyword">call </span>transportconnection%construct(model, exchange)</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      connection =&gt; transportconnection</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      transportconnection =&gt; null()</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="keywordflow">    case default</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      <span class="keyword">write</span> (*, *) <span class="stringliteral">&#39;Error (which should never happen): &#39;</span>// &amp;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        <span class="stringliteral">&#39;undefined exchangetype found&#39;</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61">ustop</a>()</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="keywordflow">    end select</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceconnectionbuildermodule_a5601b21c926febbb01f731dc5c26d5a8_cgraph.png" border="0" usemap="#namespaceconnectionbuildermodule_a5601b21c926febbb01f731dc5c26d5a8_cgraph" alt=""/></div>
<map name="namespaceconnectionbuildermodule_a5601b21c926febbb01f731dc5c26d5a8_cgraph" id="namespaceconnectionbuildermodule_a5601b21c926febbb01f731dc5c26d5a8_cgraph">
<area shape="rect" title="Create a model connection of a given type." alt="" coords="5,61,192,102"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="240,68,379,95"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="427,27,595,69"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title="Subroutine to stop the program." alt="" coords="427,93,595,134"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="643,5,837,32"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title="Write simulation message." alt="" coords="656,57,824,98"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceconnectionbuildermodule_a5601b21c926febbb01f731dc5c26d5a8_icgraph.png" border="0" usemap="#namespaceconnectionbuildermodule_a5601b21c926febbb01f731dc5c26d5a8_icgraph" alt=""/></div>
<map name="namespaceconnectionbuildermodule_a5601b21c926febbb01f731dc5c26d5a8_icgraph" id="namespaceconnectionbuildermodule_a5601b21c926febbb01f731dc5c26d5a8_icgraph">
<area shape="rect" title="Create a model connection of a given type." alt="" coords="240,5,427,47"/>
<area shape="rect" href="namespaceconnectionbuildermodule.html#aef408e9381f69a203549fc5e8a355041" title="Create connections from exchanges." alt="" coords="5,5,192,47"/>
</map>
</div>

</div>
</div>
<a id="aef408e9381f69a203549fc5e8a355041"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef408e9381f69a203549fc5e8a355041">&#9670;&nbsp;</a></span>processexchanges()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine connectionbuildermodule::processexchanges </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structconnectionbuildermodule_1_1connectionbuildertype.html">connectionbuildertype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(listtype), intent(in), pointer&#160;</td>
          <td class="paramname"><em>exchanges</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(listtype), intent(inout)&#160;</td>
          <td class="paramname"><em>newConnections</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>If the configuration demands it, this will create connections, for the exchanges (one connection per exchange) add them to the global list, and return them as</p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">newConnections</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>the connection builder object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">exchanges</td><td>the list of exchanges to process </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">newconnections</td><td>the newly created connections </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_connection_builder_8f90_source.html#l00081">81</a> of file <a class="el" href="_connection_builder_8f90_source.html">ConnectionBuilder.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacelistsmodule.html">listsmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacelistsmodule.html#aa04fa4e835743f2005800850259f8014">baseconnectionlist</a>, <a class="code" href="namespacelistsmodule.html#a3e857b53bd777fd84ebcc75f2d7fe273">baseexchangelist</a></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceversionmodule.html">versionmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespaceversionmodule.html#ab82d1ea64df56737f03bbbe06c1499bd">idevelopmode</a></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="keywordtype">class</span>(ConnectionBuilderType) :: this<span class="comment">              !&lt; the connection builder object</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keywordtype">type</span>(ListType), <span class="keywordtype">pointer</span>, <span class="keywordtype">intent(in)</span> :: exchanges<span class="comment">  !&lt; the list of exchanges to process</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keywordtype">type</span>(ListType), <span class="keywordtype">intent(inout)</span> :: newConnections<span class="comment">   !&lt; the newly created connections</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="comment">! local</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="keywordtype">class</span>(DisConnExchangeType), <span class="keywordtype">pointer</span> :: conEx</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keywordtype">class</span>(BaseExchangeType), <span class="keywordtype">pointer</span> :: baseEx</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: iex, ibasex</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keywordtype">class</span>(SpatialModelConnectionType), <span class="keywordtype">pointer</span> :: modelConnection</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keywordtype">logical(LGP)</span> :: isPeriodic</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: status</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordtype">logical(LGP)</span> :: dev_always_ifmod</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordtype">character(len=16)</span> :: envvar</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="comment">! Force use of the interface model</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    dev_always_ifmod = .false.</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespaceversionmodule.html#ab82d1ea64df56737f03bbbe06c1499bd">idevelopmode</a> == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      <span class="keyword">call </span>get_environment_variable(<span class="stringliteral">&#39;DEV_ALWAYS_USE_IFMOD&#39;</span>, &amp;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                                    <span class="keywordtype">value</span>=envvar, status=status)</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      <span class="keywordflow">if</span> (status == 0 .and. envvar == <span class="stringliteral">&#39;1&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        dev_always_ifmod = .true.</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <span class="keyword">write</span> (*, <span class="stringliteral">&#39;(a,/)&#39;</span>) <span class="stringliteral">&quot;### Experimental: forcing interface model ###&quot;</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="keywordflow">do</span> iex = 1, exchanges%Count()</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      conex =&gt; getdisconnexchangefromlist(exchanges, iex)</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      <span class="keywordflow">if</span> (.not. <span class="keyword">associated</span>(conex)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <span class="comment">! if it is not DisConnExchangeType, we can skip it</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <span class="keywordflow">continue</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      <span class="comment">! for now, if we have XT3D on the interface, we use a connection,</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      <span class="comment">! (this will be more generic in the future)</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      <span class="keywordflow">if</span> (conex%use_interface_model() .or. conex%dev_ifmod_on &amp;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;          .or. dev_always_ifmod) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        <span class="comment">! we should not get period connections here</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        isperiodic = <span class="keyword">associated</span>(conex%model1, conex%model2)</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <span class="keywordflow">if</span> (isperiodic) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;          <span class="keyword">write</span> (*, *) <span class="stringliteral">&#39;Error (which should never happen): interface model &#39;</span>// &amp;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            <span class="stringliteral">&#39;does not support periodic boundary condition&#39;</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61">ustop</a>()</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <span class="comment">! create new model connection for model 1</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        modelconnection =&gt; createmodelconnection(conex%model1, conex)</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        <span class="keyword">call </span>addspatialmodelconnectiontolist(<a class="code" href="namespacelistsmodule.html#aa04fa4e835743f2005800850259f8014">baseconnectionlist</a>, modelconnection)</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        <span class="keyword">call </span>addspatialmodelconnectiontolist(newconnections, modelconnection)</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <span class="comment">! and for model 2, unless periodic</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        modelconnection =&gt; createmodelconnection(conex%model2, conex)</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <span class="keyword">call </span>addspatialmodelconnectiontolist(<a class="code" href="namespacelistsmodule.html#aa04fa4e835743f2005800850259f8014">baseconnectionlist</a>, modelconnection)</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <span class="keyword">call </span>addspatialmodelconnectiontolist(newconnections, modelconnection)</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        <span class="comment">! remove this exchange from the base list, ownership</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        <span class="comment">! now lies with the connection</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <span class="keywordflow">do</span> ibasex = 1, <a class="code" href="namespacelistsmodule.html#a3e857b53bd777fd84ebcc75f2d7fe273">baseexchangelist</a>%Count()</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;          baseex =&gt; getbaseexchangefromlist(<a class="code" href="namespacelistsmodule.html#a3e857b53bd777fd84ebcc75f2d7fe273">baseexchangelist</a>, ibasex)</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;          <span class="keywordflow">if</span> (conex%id == baseex%id) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacelistsmodule.html#a3e857b53bd777fd84ebcc75f2d7fe273">baseexchangelist</a>%RemoveNode(ibasex, .false.)</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            <span class="keywordflow">exit</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160; </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160; </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceconnectionbuildermodule_aef408e9381f69a203549fc5e8a355041_cgraph.png" border="0" usemap="#namespaceconnectionbuildermodule_aef408e9381f69a203549fc5e8a355041_cgraph" alt=""/></div>
<map name="namespaceconnectionbuildermodule_aef408e9381f69a203549fc5e8a355041_cgraph" id="namespaceconnectionbuildermodule_aef408e9381f69a203549fc5e8a355041_cgraph">
<area shape="rect" title="Create connections from exchanges." alt="" coords="5,129,192,171"/>
<area shape="rect" href="namespacespatialmodelconnectionmodule.html#a141064bc892a55a9bd63d64cdf575bbe" title="Add connection to a list." alt="" coords="240,5,483,47"/>
<area shape="rect" href="namespaceconnectionbuildermodule.html#a5601b21c926febbb01f731dc5c26d5a8" title="Create a model connection of a given type." alt="" coords="268,71,455,112"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="571,107,709,134"/>
<area shape="rect" href="namespacebaseexchangemodule.html#ad92f8ec5d783349adc5a61e4e3d31f4b" title=" " alt="" coords="263,188,459,229"/>
<area shape="rect" href="namespacedisconnexchangemodule.html#a63ac91d936c8b44104f8e091a81e7ac2" title=" " alt="" coords="254,253,469,295"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="797,68,965,109"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title="Subroutine to stop the program." alt="" coords="797,133,965,175"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="1013,46,1208,73"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title="Write simulation message." alt="" coords="1027,97,1195,139"/>
<area shape="rect" href="namespacebaseexchangemodule.html#a471891cf69ccccc8dcca6ee6ee3e6993" title=" " alt="" coords="541,188,739,229"/>
<area shape="rect" href="namespacedisconnexchangemodule.html#a9ad5f8b11f95c70aeda06b186754b567" title=" " alt="" coords="531,253,749,295"/>
</map>
</div>

</div>
</div>
<a id="a504f9d8e8687efb8ddcf247efbc9bc3c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a504f9d8e8687efb8ddcf247efbc9bc3c">&#9670;&nbsp;</a></span>processsolution()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine connectionbuildermodule::processsolution </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structconnectionbuildermodule_1_1connectionbuildertype.html">connectionbuildertype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(basesolutiontype), pointer&#160;</td>
          <td class="paramname"><em>solution</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This routine processes all exchanges in a solution and, when required, creates model connections of the proper type (GWF-GWF, GWT-GWT, ...) for a subset. It removes this subset of exchanges from the solution and replaces them with the created connections. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>the connection builder object </td></tr>
    <tr><td class="paramname">solution</td><td>the solution for which the exchanges are processed </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_connection_builder_8f90_source.html#l00039">39</a> of file <a class="el" href="_connection_builder_8f90_source.html">ConnectionBuilder.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="keywordtype">class</span>(ConnectionBuilderType) :: this<span class="comment">            !&lt; the connection builder object</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="keywordtype">class</span>(BaseSolutionType), <span class="keywordtype">pointer</span> :: solution<span class="comment">    !&lt; the solution for which the exchanges are processed</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="comment">! local</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="keywordtype">class</span>(NumericalSolutionType), <span class="keywordtype">pointer</span> :: numSol</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="keywordtype">type</span>(ListType) :: newConnections</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="comment">! we only deal with Num. Sol. here</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="keywordflow">select type</span> (solution)</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="keywordflow">    class is</span> (numericalsolutiontype)</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;      numsol =&gt; solution</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="keywordflow">    class default</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      <span class="keywordflow">return</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="keywordflow">    end select</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="comment">! create the connections and add local exchanges</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="keyword">call </span>this%processExchanges(numsol%exchangelist, newconnections)</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="keywordflow">if</span> (newconnections%Count() == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      <span class="keywordflow">return</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160; </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="keyword">write</span> (iout, <span class="stringliteral">&#39;(1x,a,i0,a,a)&#39;</span>) <span class="stringliteral">&#39;Created &#39;</span>, newconnections%Count(), &amp;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      <span class="stringliteral">&#39; model connections for solution &#39;</span>, trim(solution%name)</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="comment">! set the global exchanges from this solution to</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="comment">! the model connections</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="keyword">call </span>this%assignExchangesToConnections(numsol%exchangelist, newconnections)</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="comment">! replace numerical exchanges in solution with connections</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keyword">call </span>this%setConnectionsToSolution(newconnections, numsol)</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160; </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="comment">! clean up local resources</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="keyword">call </span>newconnections%Clear(destroy=.false.)</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
</div><!-- fragment -->
</div>
</div>
<a id="a70c99123d0984c94b5c28ee5f8cfccfe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70c99123d0984c94b5c28ee5f8cfccfe">&#9670;&nbsp;</a></span>setconnectionstosolution()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine connectionbuildermodule::setconnectionstosolution </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structconnectionbuildermodule_1_1connectionbuildertype.html">connectionbuildertype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(listtype), intent(inout)&#160;</td>
          <td class="paramname"><em>connections</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(numericalsolutiontype), intent(in), pointer&#160;</td>
          <td class="paramname"><em>solution</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This adds the connections to the solution and removes those exchanges which are replaced by a connection </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>the connection builder object </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">connections</td><td>the connections created for the solution </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">solution</td><td>the solution to which the connections are set </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_connection_builder_8f90_source.html#l00199">199</a> of file <a class="el" href="_connection_builder_8f90_source.html">ConnectionBuilder.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keywordtype">class</span>(ConnectionBuilderType) :: this<span class="comment">                          !&lt; the connection builder object</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordtype">type</span>(ListType), <span class="keywordtype">intent(inout)</span> :: connections<span class="comment">                  !&lt; the connections created for the solution</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="keywordtype">class</span>(NumericalSolutionType), <span class="keywordtype">pointer</span>, <span class="keywordtype">intent(in)</span> :: solution<span class="comment"> !&lt; the solution to which the connections are set</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="comment">! local</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keywordtype">type</span>(ListType) :: keepList</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keywordtype">class</span>(*), <span class="keywordtype">pointer</span> :: exPtr, exPtr2, connPtr</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="keywordtype">class</span>(SpatialModelConnectionType), <span class="keywordtype">pointer</span> :: conn</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: iex, iconn</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="keywordtype">logical(LGP)</span> :: keepExchange</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160; </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="comment">! first add all exchanges not replaced by the connections to a list</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="keywordflow">do</span> iex = 1, solution%exchangelist%Count()</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;      exptr =&gt; solution%exchangelist%GetItem(iex)</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      <span class="comment">! will this exchange be replaced by a connection?</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      keepexchange = .true.</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;      <span class="keywordflow">do</span> iconn = 1, connections%Count()</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        conn =&gt; getspatialmodelconnectionfromlist(connections, iconn)</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        exptr2 =&gt; conn%primaryExchange</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">associated</span>(exptr2, exptr)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;          <span class="comment">! if so, don&#39;t add it to the list</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;          keepexchange = .false.</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;          <span class="keywordflow">exit</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      <span class="keywordflow">if</span> (keepexchange) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        <span class="keyword">call </span>keeplist%Add(exptr)</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="comment">! first add persisting exchanges</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="keyword">call </span>solution%exchangelist%Clear(destroy=.false.)</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="keywordflow">do</span> iex = 1, keeplist%Count()</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      exptr =&gt; keeplist%GetItem(iex)</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      <span class="keyword">call </span>solution%exchangelist%Add(exptr)</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160; </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="comment">! now add connections</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keywordflow">do</span> iconn = 1, connections%Count()</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      connptr =&gt; connections%GetItem(iconn)</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      <span class="keyword">call </span>solution%exchangelist%Add(connptr)</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160; </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="comment">! clean up</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="keyword">call </span>keeplist%Clear(destroy=.false.)</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160; </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceconnectionbuildermodule_a70c99123d0984c94b5c28ee5f8cfccfe_cgraph.png" border="0" usemap="#namespaceconnectionbuildermodule_a70c99123d0984c94b5c28ee5f8cfccfe_cgraph" alt=""/></div>
<map name="namespaceconnectionbuildermodule_a70c99123d0984c94b5c28ee5f8cfccfe_cgraph" id="namespaceconnectionbuildermodule_a70c99123d0984c94b5c28ee5f8cfccfe_cgraph">
<area shape="rect" title="Set connections to the solution." alt="" coords="5,5,199,47"/>
<area shape="rect" href="namespacespatialmodelconnectionmodule.html#ab03c81ae159b53ae92e07d83d48cca29" title="Get the connection from a list." alt="" coords="247,5,505,47"/>
<area shape="rect" href="namespacespatialmodelconnectionmodule.html#aef271cf59d66fe8e5baef704109028fc" title="Cast to SpatialModelConnectionType." alt="" coords="553,5,815,47"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="anamespacelistsmodule_html_aa04fa4e835743f2005800850259f8014"><div class="ttname"><a href="namespacelistsmodule.html#aa04fa4e835743f2005800850259f8014">listsmodule::baseconnectionlist</a></div><div class="ttdeci">type(listtype), public baseconnectionlist</div><div class="ttdef"><b>Definition:</b> <a href="mf6lists_8f90_source.html#l00028">mf6lists.f90:28</a></div></div>
<div class="ttc" id="anamespacesimmodule_html"><div class="ttname"><a href="namespacesimmodule.html">simmodule</a></div><div class="ttdoc">This module contains simulation methods.</div><div class="ttdef"><b>Definition:</b> <a href="_sim_8f90_source.html#l00010">Sim.f90:10</a></div></div>
<div class="ttc" id="anamespacegwfgwfconnectionmodule_html"><div class="ttname"><a href="namespacegwfgwfconnectionmodule.html">gwfgwfconnectionmodule</a></div><div class="ttdef"><b>Definition:</b> <a href="_gwf_gwf_connection_8f90_source.html#l00001">GwfGwfConnection.f90:1</a></div></div>
<div class="ttc" id="astructgwtgwtconnectionmodule_1_1gwtgwtconnectiontype_html"><div class="ttname"><a href="structgwtgwtconnectionmodule_1_1gwtgwtconnectiontype.html">gwtgwtconnectionmodule::gwtgwtconnectiontype</a></div><div class="ttdoc">Connects a GWT model to other GWT models in space. Derives from NumericalExchangeType so the solution...</div><div class="ttdef"><b>Definition:</b> <a href="_gwt_gwt_connection_8f90_source.html#l00026">GwtGwtConnection.f90:26</a></div></div>
<div class="ttc" id="anamespacelistsmodule_html"><div class="ttname"><a href="namespacelistsmodule.html">listsmodule</a></div><div class="ttdef"><b>Definition:</b> <a href="mf6lists_8f90_source.html#l00001">mf6lists.f90:1</a></div></div>
<div class="ttc" id="anamespacegwfmodule_html"><div class="ttname"><a href="namespacegwfmodule.html">gwfmodule</a></div><div class="ttdef"><b>Definition:</b> <a href="gwf3_8f90_source.html#l00001">gwf3.f90:1</a></div></div>
<div class="ttc" id="astructgwfgwfconnectionmodule_1_1gwfgwfconnectiontype_html"><div class="ttname"><a href="structgwfgwfconnectionmodule_1_1gwfgwfconnectiontype.html">gwfgwfconnectionmodule::gwfgwfconnectiontype</a></div><div class="ttdoc">Connecting a GWF model to other models in space, implements NumericalExchangeType so the solution can...</div><div class="ttdef"><b>Definition:</b> <a href="_gwf_gwf_connection_8f90_source.html#l00030">GwfGwfConnection.f90:30</a></div></div>
<div class="ttc" id="anamespacesimmodule_html_a0be97214c1d4fcf42bc4ddc27b111b61"><div class="ttname"><a href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61">simmodule::ustop</a></div><div class="ttdeci">subroutine, public ustop(stopmess, ioutlocal)</div><div class="ttdoc">Stop the simulation.</div><div class="ttdef"><b>Definition:</b> <a href="_sim_8f90_source.html#l00364">Sim.f90:364</a></div></div>
<div class="ttc" id="anamespacelistsmodule_html_a3e857b53bd777fd84ebcc75f2d7fe273"><div class="ttname"><a href="namespacelistsmodule.html#a3e857b53bd777fd84ebcc75f2d7fe273">listsmodule::baseexchangelist</a></div><div class="ttdeci">type(listtype), public baseexchangelist</div><div class="ttdef"><b>Definition:</b> <a href="mf6lists_8f90_source.html#l00025">mf6lists.f90:25</a></div></div>
<div class="ttc" id="anamespaceversionmodule_html_ab82d1ea64df56737f03bbbe06c1499bd"><div class="ttname"><a href="namespaceversionmodule.html#ab82d1ea64df56737f03bbbe06c1499bd">versionmodule::idevelopmode</a></div><div class="ttdeci">integer(i4b), parameter idevelopmode</div><div class="ttdef"><b>Definition:</b> <a href="version_8f90_source.html#l00017">version.f90:17</a></div></div>
<div class="ttc" id="anamespaceversionmodule_html"><div class="ttname"><a href="namespaceversionmodule.html">versionmodule</a></div><div class="ttdoc">This module contains version information.</div><div class="ttdef"><b>Definition:</b> <a href="version_8f90_source.html#l00007">version.f90:7</a></div></div>
<div class="ttc" id="anamespacegwtgwtconnectionmodule_html"><div class="ttname"><a href="namespacegwtgwtconnectionmodule.html">gwtgwtconnectionmodule</a></div><div class="ttdef"><b>Definition:</b> <a href="_gwt_gwt_connection_8f90_source.html#l00001">GwtGwtConnection.f90:1</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceconnectionbuildermodule.html">connectionbuildermodule</a></li>
    <li class="footer">Generated on Wed Jun 29 2022 19:22:59 for MODFLOW 6 by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
