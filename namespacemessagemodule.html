<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MODFLOW 6: messagemodule Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="mf6-triangular-grid.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MODFLOW 6
   &#160;<span id="projectnumber">version 6.4.0</span>
   </div>
   <div id="projectbrief">MODFLOW 6 Code Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="namespaces.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="namespaces.html"><span>Modules&#160;List</span></a></li>
      <li><a href="namespacemembers.html"><span>Module&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('namespacemessagemodule.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Types</a> &#124;
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">messagemodule Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This module contains message methods.  
<a href="namespacemessagemodule.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Types</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">type &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmessagemodule_1_1messagetype.html">messagetype</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:af57e8a19af378d96a293148972615b75"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemessagemodule.html#af57e8a19af378d96a293148972615b75">init_message</a> (this)</td></tr>
<tr class="memdesc:af57e8a19af378d96a293148972615b75"><td class="mdescLeft">&#160;</td><td class="mdescRight">Always initialize the message object.  <a href="namespacemessagemodule.html#af57e8a19af378d96a293148972615b75">More...</a><br /></td></tr>
<tr class="separator:af57e8a19af378d96a293148972615b75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac34972f49b5bf1188e25ae6c71c78c3"><td class="memItemLeft" align="right" valign="top">integer(i4b) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemessagemodule.html#aac34972f49b5bf1188e25ae6c71c78c3">count_message</a> (this)</td></tr>
<tr class="memdesc:aac34972f49b5bf1188e25ae6c71c78c3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return number of messages.  <a href="namespacemessagemodule.html#aac34972f49b5bf1188e25ae6c71c78c3">More...</a><br /></td></tr>
<tr class="separator:aac34972f49b5bf1188e25ae6c71c78c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb042877db7244d1b0c2cf1c352dcf7d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemessagemodule.html#adb042877db7244d1b0c2cf1c352dcf7d">set_max_message</a> (this, imax)</td></tr>
<tr class="memdesc:adb042877db7244d1b0c2cf1c352dcf7d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the maximum number of messages stored.  <a href="namespacemessagemodule.html#adb042877db7244d1b0c2cf1c352dcf7d">More...</a><br /></td></tr>
<tr class="separator:adb042877db7244d1b0c2cf1c352dcf7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68b486068da42c9fe01798129ee83af2"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemessagemodule.html#a68b486068da42c9fe01798129ee83af2">store_message</a> (this, msg, substring)</td></tr>
<tr class="memdesc:a68b486068da42c9fe01798129ee83af2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Store message.  <a href="namespacemessagemodule.html#a68b486068da42c9fe01798129ee83af2">More...</a><br /></td></tr>
<tr class="separator:a68b486068da42c9fe01798129ee83af2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9d6932a90f6202609b221df93a6d60c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemessagemodule.html#ae9d6932a90f6202609b221df93a6d60c">print_message</a> (this, title, name, iunit, level)</td></tr>
<tr class="memdesc:ae9d6932a90f6202609b221df93a6d60c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print messages.  <a href="namespacemessagemodule.html#ae9d6932a90f6202609b221df93a6d60c">More...</a><br /></td></tr>
<tr class="separator:ae9d6932a90f6202609b221df93a6d60c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a909589a6639a17d88ccded29168c33a8"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemessagemodule.html#a909589a6639a17d88ccded29168c33a8">deallocate_message</a> (this)</td></tr>
<tr class="memdesc:a909589a6639a17d88ccded29168c33a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Deallocate message  <a href="namespacemessagemodule.html#a909589a6639a17d88ccded29168c33a8">More...</a><br /></td></tr>
<tr class="separator:a909589a6639a17d88ccded29168c33a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This module contains generic message methods that are used to create warning and error messages and notes. This module also has methods for counting messages. The module does not have any dependencies on models, exchanges, or solutions in a simulation. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="aac34972f49b5bf1188e25ae6c71c78c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac34972f49b5bf1188e25ae6c71c78c3">&#9670;&nbsp;</a></span>count_message()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer(i4b) function messagemodule::count_message </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structmessagemodule_1_1messagetype.html">messagetype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Function to return the number of messages that have been stored.</p>
<dl class="section return"><dt>Returns</dt><dd>ncount number of messages stored </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>MessageType object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_message_8f90_source.html#l00073">73</a> of file <a class="el" href="_message_8f90_source.html">Message.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      <span class="keywordtype">class</span>(MessageType) :: this<span class="comment">     !&lt; MessageType object</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      <span class="comment">! -- return variable</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: nmessage</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      <span class="comment">! -- set nmessage</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">allocated</span>(this%message)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        nmessage = this%nmessage</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        nmessage = 0</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      <span class="comment">! -- return</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a909589a6639a17d88ccded29168c33a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a909589a6639a17d88ccded29168c33a8">&#9670;&nbsp;</a></span>deallocate_message()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine messagemodule::deallocate_message </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structmessagemodule_1_1messagetype.html">messagetype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Subroutine that deallocate the array of strings if it was allocated </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>MessageType object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_message_8f90_source.html#l00255">255</a> of file <a class="el" href="_message_8f90_source.html">Message.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keywordtype">class</span>(MessageType) :: this<span class="comment">    !&lt; MessageType object</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="comment">! -- deallocate the message</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">allocated</span>(this%message)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      <span class="keyword">deallocate</span>(this%message)</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="af57e8a19af378d96a293148972615b75"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af57e8a19af378d96a293148972615b75">&#9670;&nbsp;</a></span>init_message()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine messagemodule::init_message </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structmessagemodule_1_1messagetype.html">messagetype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Subroutine that initializes the message object. Allocation of message array occurs on-the-fly. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>MessageType object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_message_8f90_source.html#l00052">52</a> of file <a class="el" href="_message_8f90_source.html">Message.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      <span class="keywordtype">class</span>(MessageType) :: this<span class="comment">  !&lt; MessageType object</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      <span class="comment">! -- initialize message variables</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      this%nmessage = 0</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      this%max_message = 1000</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      this%max_exceeded = 0</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      this%inc_message = 100</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      <span class="comment">! -- return</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae9d6932a90f6202609b221df93a6d60c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9d6932a90f6202609b221df93a6d60c">&#9670;&nbsp;</a></span>print_message()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine messagemodule::print_message </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structmessagemodule_1_1messagetype.html">messagetype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>title</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in), optional&#160;</td>
          <td class="paramname"><em>iunit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in), optional&#160;</td>
          <td class="paramname"><em>level</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Subroutine to print stored messages. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>MessageType object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">title</td><td>message title </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">name</td><td>message name </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iunit</td><td>optional file unit to save messages to </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">level</td><td>optional level of messages to print </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_message_8f90_source.html#l00175">175</a> of file <a class="el" href="_message_8f90_source.html">Message.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      <span class="keywordtype">class</span>(MessageType) :: this<span class="comment">                   !&lt; MessageType object</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: title<span class="comment">        !&lt; message title</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: name<span class="comment">         !&lt; message name</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;      <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: iunit<span class="comment">  !&lt; optional file unit to save messages to</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: level<span class="comment">  !&lt; optional level of messages to print</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      <span class="comment">! -- local</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      <span class="keywordtype">character(len=LINELENGTH)</span> :: errmsg</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      <span class="keywordtype">character(len=LINELENGTH)</span> :: cerr</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: iu</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: ilevel</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: i</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: isize</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: iwidth</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      <span class="comment">! -- formats</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">parameter</span> :: stdfmt = <span class="stringliteral">&quot;(/,A,/)&quot;</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      <span class="comment">! -- process optional variables</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(iunit)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        iu = iunit</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        iu = 0</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(level)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        ilevel = level</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        ilevel = vsummary</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      <span class="comment">! -- write the title and all message entries</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">allocated</span>(this%message)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        isize = this%nmessage</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        <span class="keywordflow">if</span> (isize &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;          <span class="comment">! -- calculate the maximum width of the prepended string</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;          <span class="comment">!    for the counter</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;          <span class="keyword">write</span>(cerr, <span class="stringliteral">&#39;(i0)&#39;</span>) isize</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;          iwidth = len_trim(cerr) + 1</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;          <span class="comment">! -- write title for message</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;          <span class="keywordflow">if</span> (iu &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            <span class="keyword">call </span>sim_message(title, iunit=iu, fmt=stdfmt, level=ilevel)</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;          <span class="keyword">call </span>sim_message(title, fmt=stdfmt, level=ilevel)</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;          <span class="comment">! -- write each message</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;          <span class="keywordflow">do</span> i = 1, isize</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;            <span class="keyword">call </span>write_message(this%message(i), icount=i, iwidth=iwidth, &amp;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                               level=ilevel)</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            <span class="keywordflow">if</span> (iu &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;              <span class="keyword">call </span>write_message(this%message(i), icount=i, iwidth=iwidth, &amp;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                                 iunit=iu, level=ilevel)</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="keywordflow">          end do</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;          <span class="comment">! -- write the number of additional messages</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;          <span class="keywordflow">if</span> (this%max_exceeded &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;            <span class="keyword">write</span>(errmsg, <span class="stringliteral">&#39;(i0,3(1x,a))&#39;</span>)                                        &amp;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;              this%max_exceeded, <span class="stringliteral">&#39;additional&#39;</span>, trim(name),                       &amp;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;              <span class="stringliteral">&#39;detected but not printed.&#39;</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            <span class="keyword">call </span>sim_message(trim(errmsg), fmt=<span class="stringliteral">&#39;(/,1x,a)&#39;</span>, level=ilevel)</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            <span class="keywordflow">if</span> (iu &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;              <span class="keyword">call </span>sim_message(trim(errmsg), iunit=iu, fmt=<span class="stringliteral">&#39;(/,1x,a)&#39;</span>,           &amp;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                               level=ilevel)</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      <span class="comment">! -- return</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemessagemodule_ae9d6932a90f6202609b221df93a6d60c_cgraph.png" border="0" usemap="#namespacemessagemodule_ae9d6932a90f6202609b221df93a6d60c_cgraph" alt=""/></div>
<map name="namespacemessagemodule_ae9d6932a90f6202609b221df93a6d60c_cgraph" id="namespacemessagemodule_ae9d6932a90f6202609b221df93a6d60c_cgraph">
<area shape="rect" title="Print messages." alt="" coords="5,5,173,47"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title="Write simulation message." alt="" coords="437,5,605,47"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a79d1b03a42785a805abc5ed2a7499b36" title="Write messages." alt="" coords="221,35,389,76"/>
</map>
</div>

</div>
</div>
<a id="adb042877db7244d1b0c2cf1c352dcf7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb042877db7244d1b0c2cf1c352dcf7d">&#9670;&nbsp;</a></span>set_max_message()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine messagemodule::set_max_message </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structmessagemodule_1_1messagetype.html">messagetype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>imax</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Subroutine to set the maximum number of messages that will be stored in a simulation. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>MessageType object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">imax</td><td>maximum number of messages that will be stored </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_message_8f90_source.html#l00096">96</a> of file <a class="el" href="_message_8f90_source.html">Message.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      <span class="keywordtype">class</span>(MessageType) :: this<span class="comment">           !&lt; MessageType object</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: imax<span class="comment">     !&lt; maximum number of messages that will be stored</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      <span class="comment">! -- set max_message</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      this%max_message = imax</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      <span class="comment">! -- return</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a68b486068da42c9fe01798129ee83af2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68b486068da42c9fe01798129ee83af2">&#9670;&nbsp;</a></span>store_message()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine messagemodule::store_message </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structmessagemodule_1_1messagetype.html">messagetype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>substring</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Subroutine to store a message for printing at the end of the simulation. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>MessageType object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">msg</td><td>message </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">substring</td><td>optional string that can be used to prevent storing duplicate messages </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_message_8f90_source.html#l00114">114</a> of file <a class="el" href="_message_8f90_source.html">Message.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      <span class="comment">! -- dummy variables</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      <span class="keywordtype">class</span>(MessageType) :: this<span class="comment">                           !&lt; MessageType object</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: msg<span class="comment">                  !&lt; message</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: substring<span class="comment">  !&lt; optional string that can be used </span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">                                                           !! to prevent storing duplicate messages </span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      <span class="comment">! -- local variables</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      <span class="keywordtype">logical(LGP)</span> :: inc_array</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      <span class="keywordtype">logical(LGP)</span> :: increment_message</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: i</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      <span class="keywordtype">integer(I4B)</span> :: idx</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      <span class="comment">! -- determine if messages should be expanded</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      inc_array = .true.</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">allocated</span>(this%message)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        i = this%nmessage</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        <span class="keywordflow">if</span> (i &lt; <span class="keyword">size</span>(this%message)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;          inc_array = .false.</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;      <span class="comment">! -- resize message</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      <span class="keywordflow">if</span> (inc_array) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacearrayhandlersmodule_1_1expandarray.html">expandarray</a>(this%message, increment=this%inc_message)</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        this%inc_message = int(this%inc_message * 1.1)</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      <span class="comment">! -- Determine if the substring exists in the passed message.</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      <span class="comment">!    If substring is in passed message, do not add the duplicate </span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;      <span class="comment">!    passed message.</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      increment_message = .true.</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(substring)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        <span class="keywordflow">do</span> i = 1, this%nmessage</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;          idx = index(this%message(i), substring)</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;          <span class="keywordflow">if</span> (idx &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;            increment_message = .false.</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;            <span class="keywordflow">exit</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;      <span class="comment">! -- store this message and calculate nmessage</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      <span class="keywordflow">if</span> (increment_message) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        i = this%nmessage + 1</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <span class="keywordflow">if</span> (i &lt;= this%max_message) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;          this%nmessage = i</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;          this%message(i) = msg</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;          this%max_exceeded = this%max_exceeded + 1</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      <span class="comment">! -- return</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="ainterfacearrayhandlersmodule_1_1expandarray_html"><div class="ttname"><a href="interfacearrayhandlersmodule_1_1expandarray.html">arrayhandlersmodule::expandarray</a></div><div class="ttdef"><b>Definition:</b> <a href="_array_handlers_8f90_source.html#l00016">ArrayHandlers.f90:16</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacemessagemodule.html">messagemodule</a></li>
    <li class="footer">Generated on Thu Jun 30 2022 20:27:26 for MODFLOW 6 by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
